<!DOCTYPE html>
<!-- Updated: 2025-01-17 - Fixed Adelphi campus cards to show separate office/conference/huddle counts -->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UMGC Facilities Master Plan - Multi Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css' rel='stylesheet' />
    <style>
        /* UMGC Official Brand Colors */
        :root {
            --umgc-gold: #F2A900;         /* UMGC Official Gold */
            --umgc-red: #D50032;          /* UMGC Official Red */
            --umgc-black: #000000;        /* UMGC Official Black */
            --umgc-navy: #003366;         /* UMGC Navy Blue (web) */
            --umgc-text-dark: #333333;    /* Dark Gray Text */
            --umgc-text-light: #666666;   /* Light Gray Text */
            --umgc-background: #FFFFFF;   /* White Background */
            --umgc-gray-light: #F5F5F5;   /* Light Gray */
            --umgc-gray-medium: #E0E0E0;  /* Medium Gray */
            --umgc-navy-dark: #002244;    /* Darker Navy */
            --umgc-blue-light: #dbeafe;   /* Light Blue */
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            zoom: 0.85;
            transform: scale(0.85);
            transform-origin: 0 0;
            width: 117.65%; /* 100% / 0.85 to compensate for scale */
            height: 117.65%;
            overflow-x: hidden;
        }

        body {
            font-family: 'Open Sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background-color: var(--umgc-background);
            color: var(--umgc-text-dark);
            line-height: 1.6;
        }

        .header {
            background: white;
            color: var(--umgc-black);
            padding: 20px 40px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 4px solid var(--umgc-gold);
            display: grid;
            grid-template-columns: auto 1fr;
            align-items: center;
            gap: 40px;
        }

        .header-logo {
            height: 80px;
            width: auto;
            justify-self: start;
        }

        .header-content {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            justify-content: center;
        }

        .header h1 {
            font-size: 2.2rem;
            font-weight: 700;
            margin: 0;
            color: var(--umgc-black);
            letter-spacing: -0.02em;
            text-align: center;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 10px;
        }

        /* Tab Navigation */
        .tab-navigation {
            background: var(--umgc-gray-light);
            border-radius: 0;
            box-shadow: none;
            overflow: hidden;
            margin-top: 0;
            display: flex;
            border-bottom: 3px solid var(--umgc-gold);
            position: sticky;
            top: 124px;
            z-index: 999;
        }

        .tab-button {
            flex: 1;
            padding: 16px 24px;
            background: var(--umgc-background);
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: var(--umgc-navy);
            transition: all 0.2s ease;
            position: relative;
            border-right: 1px solid var(--umgc-gray-medium);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .tab-button:last-child {
            border-right: none;
        }

        .tab-button:hover {
            background: var(--umgc-gray-light);
            color: var(--umgc-red);
        }

        .tab-button.active {
            background: var(--umgc-navy);
            color: white;
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--umgc-gold);
        }

        .tab-icon {
            margin-right: 8px;
            font-size: 1.2rem;
        }

        /* Dashboard Container */
        .dashboard-wrapper {
            background: white;
            border-radius: 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            overflow: visible;
            border: 1px solid var(--umgc-gray-medium);
            border-top: none;
        }

        .tab-content {
            display: none !important;
            animation: fadeIn 0.3s ease-in;
        }

        .tab-content.active {
            display: block !important;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dashboard-iframe {
            width: 100%;
            height: 95vh;
            min-height: 900px;
            border: none;
            display: block;
        }

        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
            font-size: 1.2rem;
            color: var(--umgc-text-light);
        }

        .footer {
            background: var(--umgc-navy);
            color: white;
            text-align: center;
            padding: 30px 20px;
            margin-top: 40px;
            border-top: 4px solid var(--umgc-gold);
        }

        .footer p {
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .footer a {
            color: var(--umgc-gold);
            text-decoration: none;
            font-weight: 600;
        }

        .footer a:hover {
            text-decoration: underline;
            color: white;
        }

        /* Commute Analysis Styles */
        .commute-analysis-container {
            padding: 30px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .commute-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .commute-title {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--umgc-navy);
            margin-bottom: 15px;
        }

        .commute-info-box {
            background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%);
            border: 2px solid #3b82f6;
            border-radius: 12px;
            padding: 15px;
            margin: 15px auto;
            max-width: 600px;
        }

        .commute-info-text {
            font-size: 1.1rem;
            font-weight: 600;
            color: #1e40af;
            margin: 0;
        }

        .commute-subtitle {
            font-size: 1rem;
            color: var(--umgc-text-light);
            margin-top: 10px;
        }

        .filter-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            background: var(--umgc-gray-light);
            padding: 10px;
            border-radius: 12px;
        }

        .filter-tab {
            flex: 1;
            padding: 15px 20px;
            background: white;
            border: 2px solid var(--umgc-gray-medium);
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            color: var(--umgc-navy);
            transition: all 0.3s ease;
        }

        .filter-tab:hover {
            background: var(--umgc-gray-light);
            border-color: var(--umgc-navy);
        }

        .filter-tab.active {
            background: var(--umgc-navy);
            color: white;
            border-color: var(--umgc-navy);
        }

        .filter-tab span {
            margin-right: 8px;
            font-size: 1.2rem;
        }

        .filter-content {
            display: none;
        }

        .filter-content.active {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }

        .filter-card {
            background: white;
            border: 1px solid var(--umgc-gray-medium);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .filter-card-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--umgc-navy);
            margin-bottom: 10px;
        }

        .filter-card-title span {
            margin-right: 8px;
        }

        .filter-card-desc {
            color: var(--umgc-text-light);
            margin-bottom: 20px;
        }

        .slider-container {
            margin: 20px 0;
        }

        .slider-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .slider-label {
            font-weight: 600;
            color: var(--umgc-navy);
        }

        .slider-value {
            color: var(--umgc-red);
            padding: 6px 15px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: var(--umgc-gray-medium);
            outline: none;
            appearance: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            appearance: none;
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--umgc-navy);
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .slider::-moz-range-thumb {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--umgc-navy);
            cursor: pointer;
            border: none;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.3);
        }

        .stats-grid {
            display: flex;
            flex-direction: row;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: nowrap;
        }

        .stat-card {
            background: white;
            border: 2px solid var(--umgc-gray-medium);
            border-radius: 12px;
            padding: 15px;
            transition: all 0.3s ease;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            flex: 1;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .stat-card-blue {
            border-color: #3b82f6;
            background: linear-gradient(135deg, #ffffff 0%, #dbeafe 100%);
        }

        .stat-card-green {
            border-color: #10b981;
            background: linear-gradient(135deg, #ffffff 0%, #d1fae5 100%);
        }

        .stat-card-purple {
            border-color: #7c3aed;
            background: linear-gradient(135deg, #ffffff 0%, #ede9fe 100%);
        }

        .stat-header {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 15px;
        }

        .stat-icon {
            font-size: 1.5rem;
        }

        .stat-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--umgc-navy);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #3b82f6;
            margin-bottom: 5px;
        }

        .stat-card-green .stat-value {
            color: #10b981;
        }

        .stat-card-purple .stat-value {
            color: #7c3aed;
        }

        .stat-desc {
            font-size: 0.9rem;
            color: var(--umgc-text-light);
        }

        .stat-warning {
            font-size: 0.85rem;
            color: #f59e0b;
            margin-top: 5px;
            font-weight: 500;
        }

        .map-card {
            background: white;
            border: 1px solid var(--umgc-gray-medium);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .map-header {
            margin-bottom: 15px;
        }

        .map-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--umgc-navy);
            margin-bottom: 5px;
        }

        .map-title span {
            margin-right: 8px;
        }

        .map-subtitle {
            color: var(--umgc-text-light);
            font-size: 0.95rem;
            margin-bottom: 10px;
        }

        .map-legend {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
            font-size: 0.85rem;
            color: var(--umgc-text-light);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .legend-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .legend-green {
            background: #10b981;
        }

        .legend-gray {
            background: #94a3b8;
        }

        .legend-note {
            font-style: italic;
        }

        .map-container {
            width: 100%;
            height: 400px;
            border-radius: 8px;
            border: 1px solid var(--umgc-gray-medium);
            overflow: hidden;
            background: var(--umgc-gray-light);
            margin-bottom: 15px;
            position: relative;
        }

        .map-fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 9999;
            height: 100vh !important;
            border-radius: 0 !important;
            margin: 0 !important;
        }

        .fullscreen-button {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 10;
            background: white;
            border: 2px solid var(--umgc-navy);
            border-radius: 6px;
            padding: 8px 15px;
            cursor: pointer;
            font-weight: 600;
            color: var(--umgc-navy);
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
        }

        .fullscreen-button:hover {
            background: var(--umgc-navy);
            color: white;
        }

        .custom-marker {
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .custom-marker:hover {
            transform: scale(1.2);
        }

        .mapboxgl-popup-content {
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .mapboxgl-popup-content h3 {
            margin: 0 0 10px 0;
            color: var(--umgc-navy);
            font-size: 1.1rem;
            font-weight: 700;
        }

        .mapboxgl-popup-content p {
            margin: 5px 0;
            font-size: 0.9rem;
            color: var(--umgc-text-dark);
        }

        .mapboxgl-popup-content strong {
            color: var(--umgc-navy);
            font-weight: 600;
        }

        .map-placeholder {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
            color: var(--umgc-text-light);
        }

        .map-placeholder p {
            margin: 5px 0;
        }

        .map-note {
            font-size: 0.85rem;
            font-style: italic;
        }

        .map-stats {
            display: flex;
            flex-direction: row;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: nowrap;
        }

        .map-stat {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 4px rgba(0, 0, 0, 0.1);
            flex: 1;
        }

        .map-stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--umgc-navy);
        }

        .map-stat-green {
            color: #10b981;
        }

        .map-stat-label {
            font-size: 0.85rem;
            color: var(--umgc-text-light);
            margin-top: 5px;
        }

        .chart-card {
            background: white;
            border: 1px solid var(--umgc-gray-medium);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .chart-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--umgc-navy);
            margin-bottom: 5px;
        }

        .chart-subtitle {
            color: var(--umgc-text-light);
            margin-bottom: 20px;
        }

        .travel-chart {
            width: 100%;
            height: 300px;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .metric-card {
            background: white;
            border: 1px solid var(--umgc-gray-medium);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }

        .metric-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .metric-icon {
            font-size: 2rem;
        }

        .metric-title {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--umgc-navy);
        }

        .metric-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--umgc-navy);
            margin-bottom: 5px;
        }

        .metric-desc {
            font-size: 0.85rem;
            color: var(--umgc-text-light);
        }

        /* Building Tab Navigation */
        .building-tab-navigation {
            display: flex;
            background: white;
            border-bottom: 2px solid var(--umgc-gray-light);
            margin-bottom: 0;
            padding: 0;
            overflow-x: auto;
            position: sticky;
            top: 179px;
            z-index: 998;
        }

        .building-tab-button {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 15px 20px;
            background: none;
            border: none;
            color: var(--umgc-text-light);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }

        .building-tab-button:hover {
            background: var(--umgc-gray-light);
            color: var(--umgc-navy);
        }

        .building-tab-button.active {
            color: var(--umgc-navy);
            border-bottom-color: var(--umgc-navy);
            background: var(--umgc-gray-light);
            font-weight: 600;
        }

        .building-tab-icon {
            font-size: 1.1rem;
        }

        /* Building Content */
        .building-content-wrapper {
            width: 100%;
            position: relative;
        }

        .building-content {
            display: none !important;
            visibility: hidden !important;
            pointer-events: none !important;
            position: absolute !important;
            top: -9999px !important;
            left: -9999px !important;
        }

        .building-content.active {
            display: block !important;
            visibility: visible !important;
            pointer-events: auto !important;
            position: relative !important;
            top: auto !important;
            left: auto !important;
        }

        /* Ensure building content is hidden when Dashboard 1 is not active */
        #dashboard1:not(.active) .building-content {
            display: none !important;
        }


        /* Building Comparison Styles */
        .building-comparison {
            background: white;
            padding: 20px;
            border-radius: 8px;
        }

        .building-summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .building-summary-card {
            background: white;
            border: 2px solid var(--umgc-gray-light);
            border-radius: 8px;
            padding: 16px;
            transition: all 0.3s ease;
        }

        .building-summary-card:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transform: translateY(-2px);
        }

        .building-summary-card.admin {
            border-left: 4px solid var(--umgc-navy);
        }

        .building-summary-card.icc {
            border-left: 4px solid var(--umgc-gold);
        }

        .building-summary-card.hotel {
            border-left: 4px solid var(--umgc-red);
        }

        .building-summary-card.combined {
            border-left: 4px solid var(--umgc-blue-light);
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        .building-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
            padding-bottom: 12px;
            border-bottom: 1px solid var(--umgc-gray-light);
        }

        .building-header h3 {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--umgc-navy);
        }

        .building-status {
            background: var(--umgc-green);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .building-metrics {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .metric {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .metric-label {
            font-size: 0.75rem;
            color: var(--umgc-text-light);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--umgc-navy);
        }

        .upload-section {
            text-align: center;
            margin: 20px 0;
        }

        .upload-button {
            background: var(--umgc-navy);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-button:hover {
            background: var(--umgc-navy-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 51, 102, 0.3);
        }

        .uploaded-filename {
            display: inline-block;
            margin-left: 15px;
            padding: 8px 15px;
            background: var(--umgc-gold);
            color: var(--umgc-black);
            border-radius: 6px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .alert-box {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }

        .alert-box p {
            margin: 0;
            color: #92400e;
            font-size: 0.95rem;
        }

        /* Space Planning Dashboard Styles */
        .space-planning-container {
            padding: 30px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .space-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding: 8px 0;
        }

        .space-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--umgc-navy);
            margin: 0;
        }

        .space-subtitle {
            color: var(--umgc-text-light);
            font-size: 1.1rem;
            margin-top: 5px;
        }

        .space-icon {
            font-size: 4rem;
        }

        .space-metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .space-metric-card {
            background: white;
            border: 1px solid var(--umgc-gray-medium);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        }

        .metric-label {
            font-size: 0.9rem;
            color: var(--umgc-text-light);
            margin-bottom: 8px;
        }

        .metric-value-large {
            font-size: 2rem;
            font-weight: 700;
            color: var(--umgc-navy);
            margin-bottom: 5px;
        }

        .metric-info {
            font-size: 0.85rem;
            color: var(--umgc-text-light);
        }

        .metric-badge {
            display: inline-block;
            margin-top: 8px;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .metric-badge.over-capacity {
            background: #fee2e2;
            color: #991b1b;
        }

        .space-card {
            background: white;
            border: 1px solid var(--umgc-gray-medium);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
        }

        .space-card-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--umgc-navy);
            margin: 0 0 8px 0;
        }

        .space-card-desc {
            color: var(--umgc-text-light);
            margin-bottom: 20px;
        }

        .collapsible-header:hover {
            opacity: 0.9;
            box-shadow: 0 4px 12px rgba(0, 51, 102, 0.3);
        }

        .collapsible-content {
            transition: max-height 0.4s ease, opacity 0.3s ease;
        }

        .category-header:hover {
            opacity: 0.85;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        .building-params-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
        }

        .param-control {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .param-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .param-label {
            font-weight: 600;
            color: var(--umgc-navy);
        }

        .param-value {
            font-weight: 600;
            color: var(--umgc-red);
            font-size: 1.1rem;
        }

        .space-types-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 280px));
            gap: 15px;
            justify-content: start;
        }
        
        .space-types-grid.workstation-spaces,
        .space-types-grid.office-spaces,
        .space-types-grid.collab-spaces,
        .space-types-grid.other-spaces {
            grid-template-columns: repeat(auto-fit, minmax(280px, 280px));
            justify-content: start;
        }

        .space-type-card {
            border: 1px solid var(--umgc-gray-medium);
            border-radius: 8px;
            padding: 15px;
            background: white;
            min-height: 140px;
            width: 100%;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            box-sizing: border-box;
            gap: 8px;
        }

        .space-type-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .space-type-name {
            font-weight: 600;
            color: var(--umgc-navy);
            font-size: 1.1rem;
        }

        .space-type-color {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .space-type-inputs {
            display: flex;
            gap: 6px;
            margin-bottom: 6px;
            align-items: end;
            flex-wrap: nowrap;
            justify-content: space-between;
        }

        .space-input-group {
            display: flex;
            flex-direction: column;
            gap: 3px;
            flex: 1;
        }

        .space-input-group:last-child {
            flex: 0 0 60px;
        }

        .space-input-label {
            font-size: 0.85rem;
            color: var(--umgc-text-dark);
            font-weight: 600;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .space-input {
            padding: 6px 8px;
            border: 1px solid var(--umgc-gray-medium);
            border-radius: 4px;
            font-size: 0.95rem;
            width: 100%;
            max-width: 80px;
        }

        .space-qty-display {
            padding: 4px 8px;
            font-weight: 600;
            color: var(--umgc-navy);
            background: var(--umgc-gray-light);
            border-radius: 4px;
            text-align: center;
            font-size: 0.85rem;
        }

        .space-type-card .slider {
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--umgc-gray-medium);
            outline: none;
            appearance: none;
            -webkit-appearance: none;
            margin-top: 4px;
        }

        .space-type-card .slider::-webkit-slider-thumb {
            appearance: none;
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--umgc-navy);
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .space-type-card .slider::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--umgc-navy);
            cursor: pointer;
            border: none;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
        }

        .space-type-total {
            display: flex;
            justify-content: space-between;
            padding-top: 10px;
            border-top: 1px solid var(--umgc-gray-light);
            margin-top: 10px;
        }

        .space-total-label {
            color: var(--umgc-text-dark);
            font-size: 1rem;
            font-weight: 600;
        }

        .space-total-value {
            font-weight: 700;
            color: var(--umgc-navy);
            font-size: 1rem;
        }

        .custom-space-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .custom-input-group {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        .custom-label {
            font-weight: 600;
            color: var(--umgc-navy);
            font-size: 0.9rem;
        }

        .custom-input {
            padding: 10px 12px;
            border: 1px solid var(--umgc-gray-medium);
            border-radius: 6px;
            font-size: 0.95rem;
        }

        .add-space-button {
            background: var(--umgc-navy);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-space-button:hover {
            background: var(--umgc-navy-dark);
            transform: translateY(-1px);
        }

        .custom-spaces-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .custom-space-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--umgc-gray-light);
            border: 1px solid var(--umgc-gray-medium);
            border-radius: 8px;
            padding: 15px;
        }

        .custom-space-info {
            flex: 1;
        }

        .custom-space-name {
            font-weight: 600;
            color: var(--umgc-navy);
            margin-bottom: 4px;
        }

        .custom-space-details {
            font-size: 0.9rem;
            color: var(--umgc-text-light);
        }

        .remove-space-button {
            background: var(--umgc-red);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }

        .remove-space-button:hover {
            background: #c42a21;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .space-chart {
            width: 100% !important;
            height: 300px !important;
            max-width: 100% !important;
            max-height: 300px !important;
        }
        
        .charts-grid .space-card {
            min-height: 400px;
            max-height: 450px;
        }

        .table-wrapper {
            overflow-x: auto;
        }

        .space-table {
            width: 100%;
            border-collapse: collapse;
        }

        .space-table th {
            background: var(--umgc-gray-light);
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: var(--umgc-navy);
            border-bottom: 2px solid var(--umgc-gray-medium);
        }

        .space-table th.text-right {
            text-align: right;
        }

        .space-table td {
            padding: 12px;
            border-bottom: 1px solid var(--umgc-gray-light);
        }

        .space-table td.text-right {
            text-align: right;
        }

        .space-table tr:hover {
            background: var(--umgc-gray-light);
        }

        .color-swatch {
            width: 64px;
            height: 20px;
            border-radius: 4px;
        }

        .alert-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .alert-modal-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
        }

        .alert-modal-content {
            position: relative;
            background: white;
            border-radius: 12px;
            padding: 30px;
            max-width: 500px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            z-index: 10001;
        }

        .alert-modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--umgc-red);
            margin: 0 0 15px 0;
        }

        .alert-modal-body p {
            margin-bottom: 15px;
            color: var(--umgc-text-dark);
        }

        .alert-modal-stats {
            background: #fee2e2;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .alert-modal-stats p {
            margin: 5px 0;
            font-weight: 600;
        }

        .alert-over {
            color: var(--umgc-red);
            font-size: 1.1rem;
        }

        .alert-suggestion {
            font-size: 0.9rem;
            color: var(--umgc-text-light);
        }

        .alert-modal-button {
            background: var(--umgc-navy);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
        }

        .alert-modal-button:hover {
            background: var(--umgc-navy-dark);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .header {
                grid-template-columns: 1fr;
                gap: 15px;
                padding: 15px;
                text-align: center;
            }

            .header-logo {
                height: 60px;
                justify-self: center;
            }

            .header h1 {
                font-size: 1.5rem;
            }

            .tab-navigation {
                flex-direction: column;
            }

            .tab-button {
                border-right: none;
                border-bottom: 1px solid #e5e7eb;
                padding: 15px 20px;
            }

            .tab-button:last-child {
                border-bottom: none;
            }
            
            /* Responsive efficiency cards */
            .building-params-grid {
                grid-template-columns: 1fr !important;
            }

            .param-control {
                min-width: 220px;
                max-width: 350px;
                margin: 0 auto;
            }
            
            .container {
                padding: 10px;
            }
        }

        /* Tablet and medium screens */
        @media (min-width: 769px) and (max-width: 1200px) {
            .building-params-grid {
                grid-template-columns: repeat(auto-fit, minmax(220px, max-content)) !important;
            }
        }

        /* Large screens and widescreen */
        @media (min-width: 1201px) {
            .building-params-grid {
                grid-template-columns: repeat(auto-fit, minmax(220px, max-content)) !important;
                max-width: 1400px;
                margin: 0 auto;
            }
        }

        /* Extra wide screens */
        @media (min-width: 1600px) {
            .building-params-grid {
                grid-template-columns: repeat(auto-fit, minmax(220px, max-content)) !important;
            }
            
            .dashboard-iframe {
                height: 85vh;
                min-height: 700px;
            }

            .commute-analysis-container {
                padding: 15px;
            }

            .commute-title {
                font-size: 1.8rem;
            }

            .filter-tabs {
                flex-direction: column;
            }

            .stats-grid {
                flex-wrap: wrap;
            }
            
            .map-stats {
                flex-wrap: wrap;
            }
        }

        @media (max-width: 480px) {
            .stats-grid {
                flex-direction: column;
            }
            
            .map-stats {
                flex-direction: column;
            }

            .map-container {
                height: 300px;
            }

            .space-planning-container {
                padding: 15px;
            }

            .space-title {
                font-size: 1.8rem;
            }

            .space-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .space-icon {
                font-size: 2.5rem;
            }

            .space-metrics-grid,
            .building-params-grid,
            .space-types-grid,
            .custom-space-inputs,
            .charts-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <img src="UMGC-logo-stacked-rgb.png" alt="UMGC Logo" class="header-logo">
        <div class="header-content">
            <h1>Facilities Master Plan</h1>
        </div>
    </div>

    <div class="container">
        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-button active" onclick="switchTab('powerbi')" id="tab3-btn">
                <span class="tab-icon">âš¡</span>
                Existing Conditions
            </button>
            <button class="tab-button" onclick="switchTab('dashboard1')" id="tab1-btn">
                <span class="tab-icon">ðŸ“Š</span>
                Space Planning
            </button>
            <button class="tab-button" onclick="switchTab('dashboard2')" id="tab2-btn">
                <span class="tab-icon">ðŸ“ˆ</span>
                Commuter Analysis
            </button>
        </div>

        <!-- Dashboard Container -->
        <div class="dashboard-wrapper">
            <!-- Dashboard 1 Content - Space Planning -->
            <div id="dashboard1" class="tab-content">
                <!-- Building Selection Tabs -->
                <div class="building-tab-navigation">
                    <button class="building-tab-button active" onclick="switchBuilding('comparison')" id="comparison-building-btn">
                        <img src="adelphicampus.png" alt="Adelphi Campus" style="width: 24px; height: 24px; object-fit: cover; border-radius: 4px; margin-right: 8px;">
                        Adelphi Campus
                    </button>
                    <button class="building-tab-button" onclick="switchBuilding('admin')" id="admin-building-btn">
                        <img src="adminbuilding.jpg" alt="Admin Building" style="width: 24px; height: 24px; object-fit: cover; border-radius: 4px; margin-right: 8px;">
                        Admin Building
                    </button>
                    <button class="building-tab-button" onclick="switchBuilding('icc')" id="icc-building-btn">
                        <img src="ICC.jpg" alt="ICC Building" style="width: 24px; height: 24px; object-fit: cover; border-radius: 4px; margin-right: 8px;">
                        ICC Building
                    </button>
                    <button class="building-tab-button" onclick="switchBuilding('hotel')" id="hotel-building-btn">
                        <img src="hotel.jpg" alt="Hotel Building" style="width: 24px; height: 24px; object-fit: cover; border-radius: 4px; margin-right: 8px;">
                        Hotel Building
                    </button>
                        </div>

                <!-- Container for all building content -->
                <div class="building-content-wrapper">
                <!-- Admin Building Content -->
                <div id="admin-building-content" class="building-content">
                    <div class="space-planning-container">
                        <!-- Sticky Comparison Header -->
                        <div class="collapsible-header" onclick="toggleComparison()" style="cursor: pointer; padding: 15px 20px; background: linear-gradient(135deg, var(--umgc-red) 0%, #b91c1c 100%); box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); position: sticky; top: 236px; z-index: 997; margin: 0;">
                            <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px; flex-wrap: wrap;">
                                <h3 style="color: white; margin: 0; font-size: 1.3rem; font-weight: 700;">Admin Building</h3>
                                <div style="display: flex; align-items: center; gap: 20px; flex: 1; justify-content: center;">
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px;">Remaining SF</div>
                                        <div id="remainingSF" style="color: white; font-size: 1.2rem; font-weight: 700;">0</div>
                                    </div>
                                </div>
                                <div style="display: flex; gap: 20px; align-items: center; flex-wrap: wrap;">
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px;">vs Existing (Efficiency)</div>
                                        <div id="deltaGSF" style="color: white; font-size: 1rem; font-weight: 700;">+0</div>
                                    </div>
                                    <div style="text-align: center; border-left: 1px solid rgba(255,255,255,0.3); padding-left: 15px;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px; font-weight: 600;">vs Existing Work Points</div>
                                        <div id="deltaWorkstations" style="color: white; font-size: 1rem; font-weight: 700; margin-bottom: 3px;">+0</div>
                                        <div style="display: flex; gap: 10px; font-size: 0.65rem; color: rgba(255,255,255,0.8);">
                                            <span>Desk: <span id="headerDeskCount" style="font-weight: 600;">0</span></span>
                                            <span>Office: <span id="headerOfficeCount" style="font-weight: 600;">0</span></span>
                                        </div>
                                    </div>
                                    <div style="text-align: center; border-left: 1px solid rgba(255,255,255,0.3); padding-left: 15px;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px; font-weight: 600;">vs Existing Collaboration</div>
                                        <div id="deltaOffices" style="color: white; font-size: 1rem; font-weight: 700; margin-bottom: 3px;">+0</div>
                                        <div style="display: flex; gap: 10px; font-size: 0.65rem; color: rgba(255,255,255,0.8);">
                                            <span>Conf: <span id="headerConfCount" style="font-weight: 600;">0</span></span>
                                            <span>Huddle: <span id="headerHuddleCount" style="font-weight: 600;">0</span></span>
                                        </div>
                                    </div>
                                    <span id="comparisonToggle" style="color: white; font-size: 1.5rem; transition: transform 0.3s; margin-left: 10px;">â–¼</span>
                                </div>
                            </div>
                    </div>

                <!-- Comparison Content -->
                <div id="comparisonContent" class="collapsible-content" style="max-height: 1000px; overflow: hidden; transition: max-height 0.4s ease;">
                    <div class="space-planning-container">
                        <div class="space-card">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
                                    <!-- Existing Conditions -->
                                    <div style="background: var(--umgc-gray-light); padding: 20px; border-radius: 8px; border-left: 4px solid var(--umgc-red);">
                                        <h4 style="color: var(--umgc-navy); font-size: 1rem; font-weight: 700; margin: 0 0 15px 0;">Existing Conditions</h4>
                                        <div style="display: flex; flex-direction: column; gap: 12px;">
                                            <div style="display: flex; justify-content: space-between; padding: 8px 12px; background: white; border-radius: 4px;">
                                                <span style="color: var(--umgc-text-dark); font-weight: 600;">Assignable SF</span>
                                                <span id="existingAssignable" style="color: var(--umgc-navy); font-weight: 700;">77,514</span>
                                            </div>
                                             <div style="padding: 8px 12px; background: white; border-radius: 4px;">
                                                 <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                     <span style="color: var(--umgc-text-dark); font-weight: 600;">Work Points</span>
                                                     <span id="existingWorkPoints" style="color: var(--umgc-navy); font-weight: 700;">292 spaces</span>
                                                 </div>
                                                 <div style="display: flex; gap: 15px; font-size: 0.75rem; color: var(--umgc-text-medium); margin-left: 8px;">
                                                     <span>Desk: <span id="existingDeskCount" style="font-weight: 600; color: var(--umgc-navy);">99</span></span>
                                                     <span>Office: <span id="existingOfficeCount" style="font-weight: 600; color: var(--umgc-navy);">193</span></span>
                                                 </div>
                                             </div>
                                             <div style="padding: 8px 12px; background: white; border-radius: 4px;">
                                                 <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                     <span style="color: var(--umgc-text-dark); font-weight: 600;">Collaboration Points</span>
                                                     <span id="existingCollabPoints" style="color: var(--umgc-navy); font-weight: 700;">56 spaces</span>
                                                 </div>
                                                 <div style="display: flex; gap: 15px; font-size: 0.75rem; color: var(--umgc-text-medium); margin-left: 8px;">
                                                     <span>Conf: <span id="existingConfCount" style="font-weight: 600; color: var(--umgc-navy);">21</span></span>
                                                     <span>Huddle: <span id="existingHuddleCount" style="font-weight: 600; color: var(--umgc-navy);">35</span></span>
                                                 </div>
                                             </div>
                                        </div>
                        </div>

                                    <!-- Planned Conditions -->
                                    <div style="background: var(--umgc-gray-light); padding: 20px; border-radius: 8px; border-left: 4px solid hsl(142, 76%, 36%);">
                                        <h4 style="color: var(--umgc-navy); font-size: 1rem; font-weight: 700; margin: 0 0 15px 0;">Planned Conditions</h4>
                                        <div style="display: flex; flex-direction: column; gap: 12px;">
                                            <div style="display: flex; justify-content: space-between; padding: 8px 12px; background: white; border-radius: 4px;">
                                                <span style="color: var(--umgc-text-dark); font-weight: 600;">Assignable SF</span>
                                                <span id="plannedAssignable" style="color: var(--umgc-navy); font-weight: 700;">77,514</span>
                                            </div>
                                            <div style="padding: 8px 12px; background: white; border-radius: 4px;">
                                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                    <span style="color: var(--umgc-text-dark); font-weight: 600;">Work Points</span>
                                                    <span id="plannedWorkPoints" style="color: var(--umgc-navy); font-weight: 700;">292 spaces</span>
                                                </div>
                                                <div style="display: flex; gap: 15px; font-size: 0.75rem; color: var(--umgc-text-medium); margin-left: 8px;">
                                                    <span>Desk: <span id="plannedDeskCount" style="font-weight: 600; color: var(--umgc-navy);">99</span></span>
                                                    <span>Office: <span id="plannedOfficeCount" style="font-weight: 600; color: var(--umgc-navy);">193</span></span>
                                                </div>
                                            </div>
                                            <div style="padding: 8px 12px; background: white; border-radius: 4px;">
                                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                    <span style="color: var(--umgc-text-dark); font-weight: 600;">Collaboration Points</span>
                                                    <span id="plannedCollabPoints" style="color: var(--umgc-navy); font-weight: 700;">56 spaces</span>
                                                </div>
                                                <div style="display: flex; gap: 15px; font-size: 0.75rem; color: var(--umgc-text-medium); margin-left: 8px;">
                                                    <span>Conf: <span id="plannedConfCount" style="font-weight: 600; color: var(--umgc-navy);">21</span></span>
                                                    <span>Huddle: <span id="plannedHuddleCount" style="font-weight: 600; color: var(--umgc-navy);">35</span></span>
                                                </div>
                                            </div>
                                        </div>
                        </div>

                                </div>
                            </div>
                        </div>
                        </div>

                <div class="space-planning-container">
                    <!-- Header -->
                    <div class="space-header">
                        <div>
                            <h2 class="space-title">Admin Building</h2>
                        </div>
                    </div>

                    <!-- Building Parameters -->
                    <div class="space-card">
                        <div class="collapsible-header" onclick="toggleAdminBuildingParams()" style="cursor: pointer; padding: 15px 20px; background: linear-gradient(135deg, var(--umgc-navy) 0%, var(--umgc-navy-dark) 100%); border-radius: 8px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px; flex-wrap: wrap;">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                <h3 style="color: white; margin: 0; font-size: 1.1rem; font-weight: 600;">Building Parameters</h3>
                                    <button id="bestPracticeEfficiencyBtn" onclick="event.stopPropagation(); applyBestPracticeEfficiency()" 
                                            style="background: #e3f2fd; color: #1976d2; border: 1px solid #bbdefb; padding: 6px 12px; border-radius: 15px; 
                                                   font-size: 0.8rem; font-weight: 600; cursor: pointer; 
                                                   transition: all 0.3s ease;"
                                            onmouseover="this.style.background='#bbdefb'; this.style.borderColor='#90caf9'"
                                            onmouseout="this.style.background='#e3f2fd'; this.style.borderColor='#bbdefb'">
                                        Best Practice Efficiency
                                    </button>
                                    <button id="resetToExistingBtn" onclick="event.stopPropagation(); resetToExistingConditions()" 
                                            style="background: #fff3e0; color: #f57c00; border: 1px solid #ffcc02; padding: 6px 12px; border-radius: 15px; 
                                                   font-size: 0.8rem; font-weight: 600; cursor: pointer; 
                                                   transition: all 0.3s ease;"
                                            onmouseover="this.style.background='#ffcc02'; this.style.borderColor='#ff8f00'"
                                            onmouseout="this.style.background='#fff3e0'; this.style.borderColor='#ffcc02'">
                                        Reset to Existing
                                    </button>
                                </div>
                                <div style="display: flex; gap: 30px; align-items: center; flex: 1; justify-content: flex-end;">
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Total GSF</div>
                                        <div id="totalBuildingGSF" style="color: white; font-size: 1.1rem; font-weight: 700;">142,300</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Assignable SF</div>
                                        <div id="totalAssignableSF" style="color: white; font-size: 1.1rem; font-weight: 700;">93,725</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Efficiency</div>
                                        <div id="overallEfficiency" style="color: white; font-size: 1.1rem; font-weight: 700;">66%</div>
                                    </div>
                                </div>
                                <span id="adminBuildingParamsToggle" style="color: white; font-size: 1.2rem; transition: transform 0.3s ease;">â–¼</span>
                            </div>
                        </div>
                        <div id="buildingParamsContent" class="collapsible-content" style="max-height: 2000px; overflow: hidden; transition: max-height 0.4s ease;">
                            <div class="building-params-grid" style="grid-template-columns: repeat(auto-fit, minmax(220px, max-content));">
                                <!-- Floor 1 -->
                            <div class="param-control" style="border: 2px solid var(--umgc-navy); border-radius: 8px; padding: 15px; background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);">
                                <h4 style="color: var(--umgc-navy); font-size: 1rem; margin-bottom: 10px; font-weight: 700;">Floor 1</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                    <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing GSF</div>
                                        <div style="font-size: 0.95rem; color: var(--umgc-navy); font-weight: 700;">37,200</div>
                                    </div>
                                    <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing Eff</div>
                                        <div style="font-size: 0.95rem; color: var(--umgc-navy); font-weight: 700;">49%</div>
                                    </div>
                                    <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing ASF</div>
                                        <div style="font-size: 0.95rem; color: var(--umgc-navy); font-weight: 700;">18,228</div>
                                    </div>
                                </div>
                                <div class="param-header">
                                    <label class="param-label">Planned Efficiency</label>
                                    <span class="param-value" id="floor1EffValue">49%</span>
                                </div>
                                <input type="range" class="slider" id="floor1EffSlider" min="50" max="85" value="49" step="1" oninput="updateFloorEfficiency(1, this.value)">
                                <div style="margin-top: 8px; padding: 8px; background: var(--umgc-blue-light); border-radius: 4px; text-align: center;">
                                    <span style="font-size: 0.8rem; color: var(--umgc-navy); font-weight: 600;">Planned Assignable SF: <span id="floor1Assignable">22,320</span></span>
                                </div>
                            </div>

                            <!-- Floor 2 -->
                            <div class="param-control" style="border: 2px solid var(--umgc-navy); border-radius: 8px; padding: 15px; background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);">
                                <h4 style="color: var(--umgc-navy); font-size: 1rem; margin-bottom: 10px; font-weight: 700;">Floor 2</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                    <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing GSF</div>
                                        <div style="font-size: 0.95rem; color: var(--umgc-navy); font-weight: 700;">37,100</div>
                                    </div>
                                    <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing Eff</div>
                                        <div style="font-size: 0.95rem; color: var(--umgc-navy); font-weight: 700;">46%</div>
                                    </div>
                                    <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing ASF</div>
                                        <div style="font-size: 0.95rem; color: var(--umgc-navy); font-weight: 700;">17,066</div>
                                    </div>
                                </div>
                                <div class="param-header">
                                    <label class="param-label">Planned Efficiency</label>
                                    <span class="param-value" id="floor2EffValue">46%</span>
                                </div>
                                <input type="range" class="slider" id="floor2EffSlider" min="50" max="85" value="46" step="1" oninput="updateFloorEfficiency(2, this.value)">
                                <div style="margin-top: 8px; padding: 8px; background: var(--umgc-blue-light); border-radius: 4px; text-align: center;">
                                    <span style="font-size: 0.8rem; color: var(--umgc-navy); font-weight: 600;">Planned Assignable SF: <span id="floor2Assignable">24,115</span></span>
                                </div>
                            </div>

                            <!-- Floor 3 -->
                            <div class="param-control" style="border: 2px solid var(--umgc-navy); border-radius: 8px; padding: 15px; background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);">
                                <h4 style="color: var(--umgc-navy); font-size: 1rem; margin-bottom: 10px; font-weight: 700;">Floor 3</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                    <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing GSF</div>
                                        <div style="font-size: 0.95rem; color: var(--umgc-navy); font-weight: 700;">37,100</div>
                                    </div>
                                    <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing Eff</div>
                                        <div style="font-size: 0.95rem; color: var(--umgc-navy); font-weight: 700;">53%</div>
                                    </div>
                                    <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing ASF</div>
                                        <div style="font-size: 0.95rem; color: var(--umgc-navy); font-weight: 700;">19,663</div>
                                    </div>
                                </div>
                                <div class="param-header">
                                    <label class="param-label">Planned Efficiency</label>
                                    <span class="param-value" id="floor3EffValue">53%</span>
                                </div>
                                <input type="range" class="slider" id="floor3EffSlider" min="50" max="85" value="53" step="1" oninput="updateFloorEfficiency(3, this.value)">
                                <div style="margin-top: 8px; padding: 8px; background: var(--umgc-blue-light); border-radius: 4px; text-align: center;">
                                    <span style="font-size: 0.8rem; color: var(--umgc-navy); font-weight: 600;">Planned Assignable SF: <span id="floor3Assignable">24,115</span></span>
                                </div>
                            </div>

                            <!-- Floor 4 -->
                            <div class="param-control" style="border: 2px solid var(--umgc-navy); border-radius: 8px; padding: 15px; background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);">
                                <h4 style="color: var(--umgc-navy); font-size: 1rem; margin-bottom: 10px; font-weight: 700;">Floor 4</h4>
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                    <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing GSF</div>
                                        <div style="font-size: 0.95rem; color: var(--umgc-navy); font-weight: 700;">30,900</div>
                                    </div>
                                    <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing Eff</div>
                                        <div style="font-size: 0.95rem; color: var(--umgc-navy); font-weight: 700;">73%</div>
                                    </div>
                                    <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                        <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing ASF</div>
                                        <div style="font-size: 0.95rem; color: var(--umgc-navy); font-weight: 700;">22,557</div>
                                    </div>
                                </div>
                                <div class="param-header">
                                    <label class="param-label">Planned Efficiency</label>
                                    <span class="param-value" id="floor4EffValue">73%</span>
                                </div>
                                <input type="range" class="slider" id="floor4EffSlider" min="50" max="85" value="73" step="1" oninput="updateFloorEfficiency(4, this.value)">
                                <div style="margin-top: 8px; padding: 8px; background: var(--umgc-blue-light); border-radius: 4px; text-align: center;">
                                    <span style="font-size: 0.8rem; color: var(--umgc-navy); font-weight: 600;">Planned Assignable SF: <span id="floor4Assignable">23,175</span></span>
                                </div>
                            </div>
                            </div>
                        </div>
                    </div>

                    <!-- Space Allocation Controls -->
                    <div class="space-card">
                        <div class="collapsible-header" style="padding: 15px 20px; background: linear-gradient(135deg, var(--umgc-navy) 0%, var(--umgc-navy-dark) 100%); border-radius: 8px; margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px; flex-wrap: wrap;">
                                <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                                    <h3 style="color: white; margin: 0; font-size: 1.1rem; font-weight: 600; cursor: pointer;" onclick="toggleSpaceAllocation()">Space Allocation</h3>
                                    <button id="resetSpaceAllocationBtn" onclick="resetSpaceAllocationToExisting()" 
                                            style="background: #fff3e0; color: #f57c00; border: 1px solid #ffcc02; padding: 6px 12px; border-radius: 15px; 
                                                   font-size: 0.8rem; font-weight: 600; cursor: pointer; 
                                                   transition: all 0.3s ease;"
                                            onmouseover="this.style.background='#ffcc02'; this.style.borderColor='#ff8f00'"
                                            onmouseout="this.style.background='#fff3e0'; this.style.borderColor='#ffcc02'">
                                        Reset to Existing
                                    </button>
                                    <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 20px;">
                                        <input type="checkbox" id="showExistingToggle" onchange="toggleExistingData()" checked style="cursor: pointer;">
                                        <span style="color: white; font-size: 0.85rem; font-weight: 600;">Show Existing</span>
                                    </label>
                                </div>
                                <div style="display: flex; gap: 25px; align-items: center; flex: 1; justify-content: flex-end;">
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Total Assigned</div>
                                        <div id="totalAssignedSF" style="color: white; font-size: 1.1rem; font-weight: 700;">0</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Work Points</div>
                                        <div id="totalOfficeSF" style="color: white; font-size: 1.1rem; font-weight: 700;">0</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Collaboration Points</div>
                                        <div id="totalCollabSF" style="color: white; font-size: 1.1rem; font-weight: 700;">0</div>
                                    </div>
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Other</div>
                                        <div id="totalOtherSF" style="color: white; font-size: 1.1rem; font-weight: 700;">0</div>
                                    </div>
                                    <span id="spaceAllocationToggle" style="color: white; font-size: 1.5rem; transition: transform 0.3s; margin-left: 10px;">â–¼</span>
                                </div>
                            </div>
                        </div>
                        <div id="spaceAllocationContent" class="collapsible-content" style="max-height: 3000px; overflow: hidden; transition: max-height 0.4s ease;">
                            
                            <!-- Horizontal Categories Layout -->
                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                                
                                <!-- Work Points Column -->
                                <div style="background: #f8f9fa; border: 2px solid hsl(217, 91%, 60%); border-radius: 8px; padding: 15px;">
                                    <div class="category-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid hsl(217, 91%, 60%);">
                                        <div>
                                            <h4 style="color: hsl(217, 91%, 40%); font-size: 1.1rem; font-weight: 700; margin: 0 0 5px 0;">Work Points</h4>
                                            <div style="display: flex; gap: 12px; font-size: 0.95rem;">
                                                <span id="workPointsCount" style="color: var(--umgc-text-dark); font-weight: 600;">0 spaces</span>
                                                <span id="workPointsSubtotal" style="color: var(--umgc-text-dark); font-weight: 600;">0 SF</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="workPointsContent">
                                        <div class="space-types-grid" id="workPointsSpacesGrid" style="grid-template-columns: 1fr;">
                                            <!-- Work Points space types will be dynamically generated -->
                                        </div>
                                    </div>
                                </div>

                                <!-- Collaboration Points Column -->
                                <div style="background: #f8f9fa; border: 2px solid hsl(47, 96%, 53%); border-radius: 8px; padding: 15px;">
                                    <div class="category-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid hsl(47, 96%, 53%);">
                                        <div>
                                            <h4 style="color: hsl(47, 96%, 40%); font-size: 1.1rem; font-weight: 700; margin: 0 0 5px 0;">Collaboration Points</h4>
                                            <div style="display: flex; gap: 12px; font-size: 0.95rem;">
                                                <span id="collaborationPointsCount" style="color: var(--umgc-text-dark); font-weight: 600;">0 spaces</span>
                                                <span id="collaborationPointsSubtotal" style="color: var(--umgc-text-dark); font-weight: 600;">0 SF</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="collaborationPointsContent">
                                        <div class="space-types-grid" id="collaborationPointsSpacesGrid" style="grid-template-columns: 1fr;">
                                            <!-- Collaboration Points space types will be dynamically generated -->
                                        </div>
                                    </div>
                                </div>

                                <!-- Other Spaces Column -->
                                <div style="background: #f8f9fa; border: 2px solid hsl(280, 65%, 60%); border-radius: 8px; padding: 15px;">
                                    <div class="category-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid hsl(280, 65%, 60%);">
                                        <div>
                                            <h4 style="color: hsl(280, 65%, 45%); font-size: 1.1rem; font-weight: 700; margin: 0 0 5px 0;">Other Spaces</h4>
                                            <span id="otherSubtotal" style="color: var(--umgc-text-dark); font-size: 0.95rem; font-weight: 600;">0 SF</span>
                                        </div>
                                    </div>
                                    <div id="otherContent">
                                        <div class="space-types-grid" id="otherSpacesGrid" style="grid-template-columns: 1fr;">
                                            <!-- Other space types will be dynamically generated -->
                                        </div>
                                        
                                        <!-- Custom Space Input -->
                                        <div style="margin-top: 20px; padding: 15px; background: white; border: 1px solid #dee2e6; border-radius: 8px;">
                                            <h5 style="color: var(--umgc-navy); font-size: 1rem; font-weight: 600; margin-bottom: 10px;">Add Custom Space</h5>
                                            <div class="custom-space-inputs">
                                                <div class="custom-input-group">
                                                    <label class="custom-label" style="color: var(--umgc-navy);">Space Name</label>
                                                    <input type="text" class="custom-input" id="customName" placeholder="e.g., Storage Room">
                                                </div>
                                                <div class="custom-input-group">
                                                    <label class="custom-label" style="color: var(--umgc-navy);">Square Feet</label>
                                                    <input type="number" class="custom-input" id="customSF" placeholder="e.g., 200">
                                                </div>
                                                <div class="custom-input-group">
                                                    <label class="custom-label" style="color: var(--umgc-navy);">Qty</label>
                                                    <input type="number" class="custom-input" id="customQty" placeholder="e.g., 2">
                                                </div>
                                                <div class="custom-input-group">
                                                    <button class="add-space-button" onclick="addCustomSpace()">
                                                        âž• Add Space
                                                    </button>
                                                </div>
                                            </div>
                                            <div id="customSpacesList" class="custom-spaces-list" style="margin-top: 15px;"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="charts-grid">
                    <div class="space-card">
                            <h3 class="space-card-title">Space Allocation by Category - Existing vs Planned</h3>
                            <p class="space-card-desc">Comparison of space distribution across categories</p>
                            <div style="position: relative; height: 300px; width: 100%;">
                                <canvas id="categoryComparisonChart" class="space-chart"></canvas>
                        </div>
                    </div>

                    <div class="space-card">
                            <h3 class="space-card-title">Space Types - Count of Spaces</h3>
                            <p class="space-card-desc">Number of each space type in existing and planned conditions</p>
                            <div style="position: relative; height: 300px; width: 100%;">
                                <canvas id="typeComparisonChart" class="space-chart"></canvas>
                        </div>
                    </div>
                    </div>

                </div>

                <!-- Over Capacity Alert Modal -->
                <div id="capacityAlert" class="alert-modal" style="display: none;">
                    <div class="alert-modal-overlay" onclick="closeCapacityAlert()"></div>
                    <div class="alert-modal-content">
                        <h3 class="alert-modal-title">
                            âš ï¸ Over Assignable Square Footage Limit
                        </h3>
                        <div class="alert-modal-body">
                            <p>You have exceeded the total assignable square footage allowed for this building configuration.</p>
                            <div class="alert-modal-stats">
                                <p>Assignable SF: <span id="alertAssignableSF">0</span> SF</p>
                                <p>Used SF: <span id="alertUsedSF">0</span> SF</p>
                                <p class="alert-over">Over by: <span id="alertOverSF">0</span> SF</p>
                            </div>
                            <p class="alert-suggestion">
                                Please adjust your space allocations, increase the number of floors, increase the GSF per floor, or improve the efficiency percentage.
                            </p>
                        </div>
                        <button class="alert-modal-button" onclick="closeCapacityAlert()">Understood</button>
                    </div>
                </div>
                    </div>
                </div>

                <!-- ICC Building Content -->
                <div id="icc-building-content" class="building-content" style="display: none;">
                    <div class="space-planning-container">
                        <!-- Sticky Comparison Header for ICC -->
                        <div class="collapsible-header" onclick="toggleICCComparison()" style="cursor: pointer; padding: 15px 20px; background: linear-gradient(135deg, var(--umgc-red) 0%, #b91c1c 100%); box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); position: sticky; top: 236px; z-index: 997; margin: 0;">
                            <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px; flex-wrap: wrap;">
                                <h3 style="color: white; margin: 0; font-size: 1.3rem; font-weight: 700;">ICC Building</h3>
                                <div style="display: flex; align-items: center; gap: 20px; flex: 1; justify-content: center;">
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px;">Remaining SF</div>
                                        <div id="iccRemainingSF" style="color: white; font-size: 1.2rem; font-weight: 700;">0</div>
                                    </div>
                                </div>
                                <div style="display: flex; gap: 20px; align-items: center; flex-wrap: wrap;">
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px;">vs Existing (Efficiency)</div>
                                        <div id="iccDeltaGSF" style="color: white; font-size: 1rem; font-weight: 700;">+0</div>
                                    </div>
                                    <div style="text-align: center; border-left: 1px solid rgba(255,255,255,0.3); padding-left: 15px;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px; font-weight: 600;">vs Existing Work Points</div>
                                        <div id="iccDeltaWorkstations" style="color: white; font-size: 1rem; font-weight: 700; margin-bottom: 3px;">+0</div>
                                        <div style="display: flex; gap: 10px; font-size: 0.65rem; color: rgba(255,255,255,0.8);">
                                            <span>Desk: <span id="iccHeaderDeskCount" style="font-weight: 600;">0</span></span>
                                            <span>Office: <span id="iccHeaderOfficeCount" style="font-weight: 600;">0</span></span>
                                        </div>
                                    </div>
                                    <div style="text-align: center; border-left: 1px solid rgba(255,255,255,0.3); padding-left: 15px;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px; font-weight: 600;">vs Existing Collaboration</div>
                                        <div id="iccDeltaOffices" style="color: white; font-size: 1rem; font-weight: 700; margin-bottom: 3px;">+0</div>
                                        <div style="display: flex; gap: 10px; font-size: 0.65rem; color: rgba(255,255,255,0.8);">
                                            <span>Conf: <span id="iccHeaderConfCount" style="font-weight: 600;">0</span></span>
                                            <span>Huddle: <span id="iccHeaderHuddleCount" style="font-weight: 600;">0</span></span>
                                        </div>
                                    </div>
                                    <span id="iccComparisonToggle" style="color: white; font-size: 1.5rem; transition: transform 0.3s; margin-left: 10px;">â–¼</span>
                                </div>
                            </div>
                    </div>
                    
                <!-- ICC Comparison Content -->
                <div id="iccComparisonContent" class="collapsible-content" style="max-height: 1000px; overflow: hidden; transition: max-height 0.4s ease;">
                    <div class="space-planning-container">
                        <div class="space-card">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
                                    <!-- Existing Conditions -->
                                    <div style="background: var(--umgc-gray-light); padding: 20px; border-radius: 8px; border-left: 4px solid var(--umgc-red);">
                                        <h4 style="color: var(--umgc-navy); font-size: 1rem; font-weight: 700; margin: 0 0 15px 0;">Existing Conditions</h4>
                                        <div style="display: flex; flex-direction: column; gap: 12px;">
                                            <div style="display: flex; justify-content: space-between; padding: 8px 12px; background: white; border-radius: 4px;">
                                                <span style="color: var(--umgc-text-dark); font-weight: 600;">Assignable SF</span>
                                                <span id="iccExistingAssignable" style="color: var(--umgc-navy); font-weight: 700;">36,021</span>
                                            </div>
                                             <div style="padding: 8px 12px; background: white; border-radius: 4px;">
                                                 <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                     <span style="color: var(--umgc-text-dark); font-weight: 600;">Work Points</span>
                                                     <span id="iccExistingWorkPoints" style="color: var(--umgc-navy); font-weight: 700;">66 spaces</span>
                                                 </div>
                                                 <div style="display: flex; gap: 15px; font-size: 0.75rem; color: var(--umgc-text-medium); margin-left: 8px;">
                                                     <span>Desk: <span id="iccExistingDeskCount" style="font-weight: 600; color: var(--umgc-navy);">17</span></span>
                                                     <span>Office: <span id="iccExistingOfficeCount" style="font-weight: 600; color: var(--umgc-navy);">49</span></span>
                                                 </div>
                                             </div>
                                             <div style="padding: 8px 12px; background: white; border-radius: 4px;">
                                                 <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                     <span style="color: var(--umgc-text-dark); font-weight: 600;">Collaboration Points</span>
                                                     <span id="iccExistingCollabPoints" style="color: var(--umgc-navy); font-weight: 700;">7 spaces</span>
                                                 </div>
                                                 <div style="display: flex; gap: 15px; font-size: 0.75rem; color: var(--umgc-text-medium); margin-left: 8px;">
                                                     <span>Conf: <span id="iccExistingConfCount" style="font-weight: 600; color: var(--umgc-navy);">7</span></span>
                                                     <span>Huddle: <span id="iccExistingHuddleCount" style="font-weight: 600; color: var(--umgc-navy);">0</span></span>
                                                 </div>
                                             </div>
                                        </div>
                        </div>

                                    <!-- Planned Conditions -->
                                    <div style="background: var(--umgc-gray-light); padding: 20px; border-radius: 8px; border-left: 4px solid hsl(142, 76%, 36%);">
                                        <h4 style="color: var(--umgc-navy); font-size: 1rem; font-weight: 700; margin: 0 0 15px 0;">Planned Conditions</h4>
                                        <div style="display: flex; flex-direction: column; gap: 12px;">
                                            <div style="display: flex; justify-content: space-between; padding: 8px 12px; background: white; border-radius: 4px;">
                                                <span style="color: var(--umgc-text-dark); font-weight: 600;">Assignable SF</span>
                                                <span id="iccPlannedAssignable" style="color: var(--umgc-navy); font-weight: 700;">15,721</span>
                                            </div>
                                            <div style="padding: 8px 12px; background: white; border-radius: 4px;">
                                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                    <span style="color: var(--umgc-text-dark); font-weight: 600;">Work Points</span>
                                                    <span id="iccPlannedWorkPoints" style="color: var(--umgc-navy); font-weight: 700;">66 spaces</span>
                                                </div>
                                                <div style="display: flex; gap: 15px; font-size: 0.75rem; color: var(--umgc-text-medium); margin-left: 8px;">
                                                    <span>Desk: <span id="iccPlannedDeskCount" style="font-weight: 600; color: var(--umgc-navy);">17</span></span>
                                                    <span>Office: <span id="iccPlannedOfficeCount" style="font-weight: 600; color: var(--umgc-navy);">49</span></span>
                                                </div>
                                            </div>
                                            <div style="padding: 8px 12px; background: white; border-radius: 4px;">
                                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                    <span style="color: var(--umgc-text-dark); font-weight: 600;">Collaboration Points</span>
                                                    <span id="iccPlannedCollabPoints" style="color: var(--umgc-navy); font-weight: 700;">7 spaces</span>
                                                </div>
                                                <div style="display: flex; gap: 15px; font-size: 0.75rem; color: var(--umgc-text-medium); margin-left: 8px;">
                                                    <span>Conf: <span id="iccPlannedConfCount" style="font-weight: 600; color: var(--umgc-navy);">7</span></span>
                                                    <span>Huddle: <span id="iccPlannedHuddleCount" style="font-weight: 600; color: var(--umgc-navy);">0</span></span>
                                                </div>
                                            </div>
                                        </div>
                        </div>

                                </div>
                            </div>
                        </div>
                        </div>
                    
                    <div class="space-planning-container">
                        <div class="space-title">
                            <h2>ICC Building</h2>
                        </div>
                        
                        <!-- ICC Building Parameters -->
                        <div class="space-card">
                            <div class="collapsible-header" onclick="toggleICCBuildingParams()" style="cursor: pointer; padding: 15px 20px; background: linear-gradient(135deg, var(--umgc-gold) 0%, #d97706 100%); border-radius: 8px; margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px; flex-wrap: wrap;">
                                    <div style="display: flex; align-items: center; gap: 15px;">
                                    <h3 style="color: white; margin: 0; font-size: 1.1rem; font-weight: 600;">ICC Building Parameters</h3>
                                        <button id="iccBestPracticeEfficiencyBtn" onclick="event.stopPropagation(); applyICCBestPracticeEfficiency()" 
                                                style="background: #e3f2fd; color: #1976d2; border: 1px solid #bbdefb; padding: 6px 12px; border-radius: 15px; 
                                                       font-size: 0.8rem; font-weight: 600; cursor: pointer; 
                                                       transition: all 0.3s ease;"
                                                onmouseover="this.style.background='#bbdefb'; this.style.borderColor='#90caf9'"
                                                onmouseout="this.style.background='#e3f2fd'; this.style.borderColor='#bbdefb'">
                                            Best Practice Efficiency
                                        </button>
                                        <button id="iccResetToExistingBtn" onclick="event.stopPropagation(); resetICCToExistingConditions()" 
                                                style="background: #fff3e0; color: #f57c00; border: 1px solid #ffcc02; padding: 6px 12px; border-radius: 15px; 
                                                       font-size: 0.8rem; font-weight: 600; cursor: pointer; 
                                                       transition: all 0.3s ease;"
                                                onmouseover="this.style.background='#ffcc02'; this.style.borderColor='#ff8f00'"
                                                onmouseout="this.style.background='#fff3e0'; this.style.borderColor='#ffcc02'">
                                            Reset to Existing
                                        </button>
                                    </div>
                                    <div style="display: flex; gap: 25px; align-items: center; flex: 1; justify-content: flex-end;">
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Total GSF</div>
                                            <div id="iccBuildingTotalGSF" style="color: white; font-size: 1.1rem; font-weight: 700;">39,200</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Assignable SF</div>
                                            <div id="iccBuildingTotalAssignable" style="color: white; font-size: 1.1rem; font-weight: 700;">37,700</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Efficiency</div>
                                            <div id="iccBuildingEfficiency" style="color: white; font-size: 1.1rem; font-weight: 700;">96%</div>
                                        </div>
                                    </div>
                                    <span id="iccBuildingParamsToggle" style="color: white; font-size: 1.2rem; transition: transform 0.3s ease;">â–¼</span>
                                </div>
                            </div>
                            <div id="iccBuildingParamsContent" style="max-height: 1000px; overflow: hidden; transition: max-height 0.3s ease;">
                                <div style="padding: 20px;">
                                    <p style="color: var(--umgc-text-light); margin-bottom: 20px; font-size: 0.9rem;">ICC Building - Conference and Meeting Center</p>
                                    
                                    <!-- ICC Building Floors -->
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, max-content)); gap: 20px;">
                                        <!-- Basement - Fixed ASF -->
                                        <div class="param-control" style="border: 2px solid var(--umgc-gold); border-radius: 8px; padding: 15px; background: linear-gradient(135deg, #fff9f0 0%, #ffffff 100%);">
                                            <h4 style="color: var(--umgc-gold); font-size: 1rem; margin-bottom: 10px; font-weight: 700;">Basement</h4>
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                                <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                                    <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing GSF</div>
                                                    <div style="font-size: 0.95rem; color: var(--umgc-gold); font-weight: 700;">20,300</div>
                                            </div>
                                                <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                                    <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing Eff</div>
                                                    <div style="font-size: 0.95rem; color: var(--umgc-gold); font-weight: 700;">100%</div>
                                                </div>
                                                <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                                    <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing ASF</div>
                                                    <div style="font-size: 0.95rem; color: var(--umgc-gold); font-weight: 700;">20,300</div>
                                                </div>
                                            </div>
                                            <div style="padding: 8px; background: var(--umgc-blue-light); border-radius: 4px; text-align: center;">
                                                <span style="font-size: 0.8rem; color: var(--umgc-navy); font-weight: 600;">Fixed Capacity - No Adjustments</span>
                                            </div>
                                        </div>
                                        
                                        <!-- 3rd Floor - Adjustable with Efficiency Slider -->
                                        <div class="param-control" style="border: 2px solid var(--umgc-gold); border-radius: 8px; padding: 15px; background: linear-gradient(135deg, #fff9f0 0%, #ffffff 100%);">
                                            <h4 style="color: var(--umgc-gold); font-size: 1rem; margin-bottom: 10px; font-weight: 700;">3rd Floor</h4>
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                                <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                                    <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing GSF</div>
                                                    <div style="font-size: 0.95rem; color: var(--umgc-gold); font-weight: 700;">19,900</div>
                                            </div>
                                                <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                                    <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing Eff</div>
                                                    <div style="font-size: 0.95rem; color: var(--umgc-gold); font-weight: 700;">79%</div>
                                                </div>
                                                <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                                    <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing ASF</div>
                                                    <div style="font-size: 0.95rem; color: var(--umgc-gold); font-weight: 700;">15,721</div>
                                                </div>
                                            </div>
                                            <div class="param-header">
                                                <label class="param-label">Planned Efficiency</label>
                                                <span class="param-value" id="iccFloor3EffValue">79%</span>
                                            </div>
                                            <input type="range" class="slider" id="iccFloor3EffSlider" min="50" max="85" value="79" step="1" oninput="updateICCFloorEfficiency(3, this.value)">
                                            <div style="margin-top: 8px; padding: 8px; background: var(--umgc-blue-light); border-radius: 4px; text-align: center;">
                                                <span style="font-size: 0.8rem; color: var(--umgc-navy); font-weight: 600;">Planned Assignable SF: <span id="iccFloor3Assignable">15,721</span></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ICC Space Allocation -->
                        <div class="space-card">
                            <div class="collapsible-header" style="padding: 15px 20px; background: linear-gradient(135deg, var(--umgc-gold) 0%, #d97706 100%); border-radius: 8px; margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px; flex-wrap: wrap;">
                                    <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                                        <h3 style="color: white; margin: 0; font-size: 1.1rem; font-weight: 600; cursor: pointer;" onclick="toggleICCSpaceAllocation()">ICC Space Allocation</h3>
                                        <button id="resetICCSpaceAllocationBtn" onclick="resetICCSpaceAllocationToExisting()" 
                                                style="background: #fff3e0; color: #f57c00; border: 1px solid #ffcc02; padding: 6px 12px; border-radius: 15px; 
                                                       font-size: 0.8rem; font-weight: 600; cursor: pointer; 
                                                       transition: all 0.3s ease;"
                                                onmouseover="this.style.background='#ffcc02'; this.style.borderColor='#ff8f00'"
                                                onmouseout="this.style.background='#fff3e0'; this.style.borderColor='#ffcc02'">
                                            Reset to Existing
                                        </button>
                                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 20px;">
                                            <input type="checkbox" id="iccShowExistingToggle" onchange="toggleICCExistingData()" checked style="cursor: pointer;">
                                            <span style="color: white; font-size: 0.85rem; font-weight: 600;">Show Existing</span>
                                        </label>
                                    </div>
                                    <div style="display: flex; gap: 25px; align-items: center; flex: 1; justify-content: flex-end;">
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Total Assigned</div>
                                            <div id="iccTotalAssignedSF" style="color: white; font-size: 1.1rem; font-weight: 700;">0</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Work Points</div>
                                            <div id="iccTotalOfficeSF" style="color: white; font-size: 1.1rem; font-weight: 700;">0</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Collaboration Points</div>
                                            <div id="iccTotalCollabSF" style="color: white; font-size: 1.1rem; font-weight: 700;">0</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Other</div>
                                            <div id="iccTotalOtherSF" style="color: white; font-size: 1.1rem; font-weight: 700;">0</div>
                                        </div>
                                    </div>
                                    <span id="iccSpaceAllocationToggle" style="color: white; font-size: 1.2rem; transition: transform 0.3s ease;">â–¼</span>
                                </div>
                            </div>
                            <div id="iccSpaceAllocationContent" style="max-height: 3000px; overflow: hidden; transition: max-height 0.4s ease;">
                                <!-- Horizontal Categories Layout -->
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 20px; padding: 20px;">
                                    <!-- Work Points Column -->
                                    <div style="background: #f8f9fa; border: 2px solid hsl(217, 91%, 60%); border-radius: 8px; padding: 15px;">
                                        <div class="category-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid hsl(217, 91%, 60%);">
                                            <div>
                                                <h4 style="color: hsl(217, 91%, 40%); font-size: 1rem; font-weight: 700; margin: 0 0 5px 0;">Work Points</h4>
                                                <div style="display: flex; gap: 12px; font-size: 0.85rem;">
                                                    <span id="iccWorkPointsCount" style="color: hsl(217, 91%, 40%); font-weight: 600;">0 spaces</span>
                                                    <span id="iccWorkPointsSubtotal" style="color: hsl(217, 91%, 40%); font-weight: 600;">0 SF</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="iccWorkPointsContent">
                                            <div class="space-types-grid" id="iccWorkPointsSpacesGrid" style="grid-template-columns: 1fr;">
                                                <!-- Work Points space types will be dynamically generated -->
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Collaboration Points Column -->
                                    <div style="background: #f8f9fa; border: 2px solid hsl(47, 96%, 53%); border-radius: 8px; padding: 15px;">
                                        <div class="category-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid hsl(47, 96%, 53%);">
                                            <div>
                                                <h4 style="color: hsl(45, 80%, 35%); font-size: 1rem; font-weight: 700; margin: 0 0 5px 0;">Collaboration Points</h4>
                                                <div style="display: flex; gap: 12px; font-size: 0.85rem;">
                                                    <span id="iccCollaborationPointsCount" style="color: hsl(45, 80%, 35%); font-weight: 600;">0 spaces</span>
                                                    <span id="iccCollaborationPointsSubtotal" style="color: hsl(45, 80%, 35%); font-weight: 600;">0 SF</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="iccCollaborationPointsContent">
                                            <div class="space-types-grid" id="iccCollaborationPointsSpacesGrid" style="grid-template-columns: 1fr;">
                                                <!-- Collaboration Points space types will be dynamically generated -->
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Other Spaces Column -->
                                    <div style="background: #f8f9fa; border: 2px solid hsl(280, 65%, 60%); border-radius: 8px; padding: 15px;">
                                        <div class="category-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid hsl(280, 65%, 60%);">
                                            <div>
                                                <h4 style="color: hsl(280, 65%, 40%); font-size: 1rem; font-weight: 700; margin: 0 0 5px 0;">Other Spaces</h4>
                                                <span id="iccOtherSubtotal" style="color: hsl(280, 65%, 40%); font-size: 0.85rem; font-weight: 600;">0 SF</span>
                                            </div>
                                        </div>
                                        <div id="iccOtherContent">
                                            <div class="space-types-grid" id="iccOtherSpacesGrid" style="grid-template-columns: 1fr;">
                                                <!-- Other space types will be dynamically generated -->
                                            </div>
                                            <!-- Custom Space Input -->
                                            <div style="margin-top: 20px; padding: 15px; background: white; border: 1px solid #dee2e6; border-radius: 8px;">
                                                <h5 style="color: var(--umgc-navy); font-size: 0.9rem; font-weight: 600; margin-bottom: 10px;">Add Custom Space</h5>
                                                <div class="custom-space-inputs">
                                                    <div class="custom-input-group">
                                                        <label class="custom-label" style="color: var(--umgc-navy);">Space Name</label>
                                                        <input type="text" class="custom-input" id="iccCustomName" placeholder="e.g., Storage Room">
                                                    </div>
                                                    <div class="custom-input-group">
                                                        <label class="custom-label" style="color: var(--umgc-navy);">Square Feet</label>
                                                        <input type="number" class="custom-input" id="iccCustomSF" placeholder="e.g., 200">
                                                    </div>
                                                    <div class="custom-input-group">
                                                        <label class="custom-label" style="color: var(--umgc-navy);">Qty</label>
                                                        <input type="number" class="custom-input" id="iccCustomQty" placeholder="e.g., 2">
                                                    </div>
                                                    <div class="custom-input-group">
                                                        <button class="add-space-button" onclick="addICCCustomSpace()">
                                                            âž• Add Space
                                                        </button>
                                                    </div>
                                                </div>
                                                <div id="iccCustomSpacesList" class="custom-spaces-list" style="margin-top: 15px;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                </div>
                    </div>
                </div>

                <!-- Hotel Building Content -->
                <div id="hotel-building-content" class="building-content" style="display: none;">
                    <div class="space-planning-container">
                        <!-- Sticky Comparison Header for Hotel -->
                        <div class="collapsible-header" onclick="toggleHotelComparison()" style="cursor: pointer; padding: 15px 20px; background: linear-gradient(135deg, var(--umgc-red) 0%, #b91c1c 100%); box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); position: sticky; top: 236px; z-index: 997; margin: 0;">
                            <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px; flex-wrap: wrap;">
                                <h3 style="color: white; margin: 0; font-size: 1.3rem; font-weight: 700;">Hotel Building</h3>
                                <div style="display: flex; align-items: center; gap: 20px; flex: 1; justify-content: center;">
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px;">Remaining SF</div>
                                        <div id="hotelRemainingSF" style="color: white; font-size: 1.2rem; font-weight: 700;">0</div>
                                    </div>
                                </div>
                                <div style="display: flex; gap: 20px; align-items: center; flex-wrap: wrap;">
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px;">vs Existing (Efficiency)</div>
                                        <div id="hotelDeltaGSF" style="color: white; font-size: 1rem; font-weight: 700;">+0</div>
                                    </div>
                                    <div style="text-align: center; border-left: 1px solid rgba(255,255,255,0.3); padding-left: 15px;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px; font-weight: 600;">vs Existing Work Points</div>
                                        <div id="hotelDeltaWorkstations" style="color: white; font-size: 1rem; font-weight: 700; margin-bottom: 3px;">+0</div>
                                        <div style="display: flex; gap: 10px; font-size: 0.65rem; color: rgba(255,255,255,0.8);">
                                            <span>Desk: <span id="hotelHeaderDeskCount" style="font-weight: 600;">0</span></span>
                                            <span>Office: <span id="hotelHeaderOfficeCount" style="font-weight: 600;">0</span></span>
                                        </div>
                                    </div>
                                    <div style="text-align: center; border-left: 1px solid rgba(255,255,255,0.3); padding-left: 15px;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px; font-weight: 600;">vs Existing Collaboration</div>
                                        <div id="hotelDeltaOffices" style="color: white; font-size: 1rem; font-weight: 700; margin-bottom: 3px;">+0</div>
                                        <div style="display: flex; gap: 10px; font-size: 0.65rem; color: rgba(255,255,255,0.8);">
                                            <span>Conf: <span id="hotelHeaderConfCount" style="font-weight: 600;">0</span></span>
                                            <span>Huddle: <span id="hotelHeaderHuddleCount" style="font-weight: 600;">0</span></span>
                                        </div>
                                    </div>
                                    <span id="hotelComparisonToggle" style="color: white; font-size: 1.5rem; transition: transform 0.3s; margin-left: 10px;">â–¼</span>
                                </div>
                            </div>
                    </div>
                    
                <!-- Hotel Comparison Content -->
                <div id="hotelComparisonContent" class="collapsible-content" style="max-height: 1000px; overflow: hidden; transition: max-height 0.4s ease;">
                    <div class="space-planning-container">
                        <div class="space-card">
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px;">
                                    <!-- Existing Conditions -->
                                    <div style="background: var(--umgc-gray-light); padding: 20px; border-radius: 8px; border-left: 4px solid var(--umgc-red);">
                                        <h4 style="color: var(--umgc-navy); font-size: 1rem; font-weight: 700; margin: 0 0 15px 0;">Existing Conditions</h4>
                                        <div style="display: flex; flex-direction: column; gap: 12px;">
                                            <div style="display: flex; justify-content: space-between; padding: 8px 12px; background: white; border-radius: 4px;">
                                                <span style="color: var(--umgc-text-dark); font-weight: 600;">Assignable SF</span>
                                                <span id="hotelExistingAssignable" style="color: var(--umgc-navy); font-weight: 700;">5,310</span>
                                            </div>
                                             <div style="padding: 8px 12px; background: white; border-radius: 4px;">
                                                 <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                     <span style="color: var(--umgc-text-dark); font-weight: 600;">Work Points</span>
                                                     <span id="hotelExistingWorkPoints" style="color: var(--umgc-navy); font-weight: 700;">0 spaces</span>
                                                 </div>
                                                 <div style="display: flex; gap: 15px; font-size: 0.75rem; color: var(--umgc-text-medium); margin-left: 8px;">
                                                     <span>Desk: <span id="hotelExistingDeskCount" style="font-weight: 600; color: var(--umgc-navy);">0</span></span>
                                                     <span>Office: <span id="hotelExistingOfficeCount" style="font-weight: 600; color: var(--umgc-navy);">0</span></span>
                                                 </div>
                                             </div>
                                             <div style="padding: 8px 12px; background: white; border-radius: 4px;">
                                                 <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                     <span style="color: var(--umgc-text-dark); font-weight: 600;">Collaboration Points</span>
                                                     <span id="hotelExistingCollabPoints" style="color: var(--umgc-navy); font-weight: 700;">6 spaces</span>
                                                 </div>
                                                 <div style="display: flex; gap: 15px; font-size: 0.75rem; color: var(--umgc-text-medium); margin-left: 8px;">
                                                     <span>Conf: <span id="hotelExistingConfCount" style="font-weight: 600; color: var(--umgc-navy);">6</span></span>
                                                     <span>Huddle: <span id="hotelExistingHuddleCount" style="font-weight: 600; color: var(--umgc-navy);">0</span></span>
                                                 </div>
                                             </div>
                                        </div>
                        </div>

                                    <!-- Planned Conditions -->
                                    <div style="background: var(--umgc-gray-light); padding: 20px; border-radius: 8px; border-left: 4px solid hsl(142, 76%, 36%);">
                                        <h4 style="color: var(--umgc-navy); font-size: 1rem; font-weight: 700; margin: 0 0 15px 0;">Planned Conditions</h4>
                                        <div style="display: flex; flex-direction: column; gap: 12px;">
                                            <div style="display: flex; justify-content: space-between; padding: 8px 12px; background: white; border-radius: 4px;">
                                                <span style="color: var(--umgc-text-dark); font-weight: 600;">Assignable SF</span>
                                                <span id="hotelPlannedAssignable" style="color: var(--umgc-navy); font-weight: 700;">5,325</span>
                                            </div>
                                            <div style="padding: 8px 12px; background: white; border-radius: 4px;">
                                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                    <span style="color: var(--umgc-text-dark); font-weight: 600;">Work Points</span>
                                                    <span id="hotelPlannedWorkPoints" style="color: var(--umgc-navy); font-weight: 700;">0 spaces</span>
                                                </div>
                                                <div style="display: flex; gap: 15px; font-size: 0.75rem; color: var(--umgc-text-medium); margin-left: 8px;">
                                                    <span>Desk: <span id="hotelPlannedDeskCount" style="font-weight: 600; color: var(--umgc-navy);">0</span></span>
                                                    <span>Office: <span id="hotelPlannedOfficeCount" style="font-weight: 600; color: var(--umgc-navy);">0</span></span>
                                                </div>
                                            </div>
                                            <div style="padding: 8px 12px; background: white; border-radius: 4px;">
                                                <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                                                    <span style="color: var(--umgc-text-dark); font-weight: 600;">Collaboration Points</span>
                                                    <span id="hotelPlannedCollabPoints" style="color: var(--umgc-navy); font-weight: 700;">6 spaces</span>
                                                </div>
                                                <div style="display: flex; gap: 15px; font-size: 0.75rem; color: var(--umgc-text-medium); margin-left: 8px;">
                                                    <span>Conf: <span id="hotelPlannedConfCount" style="font-weight: 600; color: var(--umgc-navy);">6</span></span>
                                                    <span>Huddle: <span id="hotelPlannedHuddleCount" style="font-weight: 600; color: var(--umgc-navy);">0</span></span>
                                                </div>
                                            </div>
                                        </div>
                        </div>

                                </div>
                            </div>
                        </div>
                        </div>
                    
                    <div class="space-planning-container">
                        <div class="space-title">
                            <h2>Hotel Building</h2>
                        </div>

                        <!-- Hotel Building Parameters -->
                        <div class="space-card">
                            <div class="collapsible-header" onclick="toggleHotelBuildingParams()" style="cursor: pointer; padding: 15px 20px; background: linear-gradient(135deg, var(--umgc-red) 0%, #dc2626 100%); border-radius: 8px; margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px; flex-wrap: wrap;">
                                    <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                                    <h3 style="color: white; margin: 0; font-size: 1.1rem; font-weight: 600;">Hotel Building Parameters</h3>
                                        <button id="hotelBestPracticeEfficiencyBtn" onclick="event.stopPropagation(); applyHotelBestPracticeEfficiency()" 
                                                style="background: #e3f2fd; color: #1976d2; border: 1px solid #bbdefb; padding: 6px 12px; border-radius: 15px; 
                                                       font-size: 0.8rem; font-weight: 600; cursor: pointer; 
                                                       transition: all 0.3s ease;"
                                                onmouseover="this.style.background='#bbdefb'; this.style.borderColor='#90caf9'"
                                                onmouseout="this.style.background='#e3f2fd'; this.style.borderColor='#bbdefb'">
                                            Best Practice Efficiency
                                        </button>
                                        <button id="hotelResetToExistingBtn" onclick="event.stopPropagation(); resetHotelToExistingConditions()" 
                                                style="background: #fff3e0; color: #f57c00; border: 1px solid #ffcc02; padding: 6px 12px; border-radius: 15px; 
                                                       font-size: 0.8rem; font-weight: 600; cursor: pointer; 
                                                       transition: all 0.3s ease;"
                                                onmouseover="this.style.background='#ffcc02'; this.style.borderColor='#ff8f00'"
                                                onmouseout="this.style.background='#fff3e0'; this.style.borderColor='#ffcc02'">
                                            Reset to Existing
                                        </button>
                                    </div>
                                    <div style="display: flex; gap: 25px; align-items: center; flex: 1; justify-content: flex-end;">
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Total GSF</div>
                                            <div id="hotelBuildingTotalGSF" style="color: white; font-size: 1.1rem; font-weight: 700;">7,500</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Assignable SF</div>
                                            <div id="hotelBuildingTotalAssignable" style="color: white; font-size: 1.1rem; font-weight: 700;">5,310</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Efficiency</div>
                                            <div id="hotelBuildingEfficiency" style="color: white; font-size: 1.1rem; font-weight: 700;">71%</div>
                                        </div>
                                    </div>
                                    <span id="hotelBuildingParamsToggle" style="color: white; font-size: 1.2rem; transition: transform 0.3s ease;">â–¼</span>
                                </div>
                            </div>
                            <div id="hotelBuildingParamsContent" style="max-height: 1000px; overflow: hidden; transition: max-height 0.3s ease;">
                                <div style="padding: 20px;">
                                    <p style="color: var(--umgc-text-light); margin-bottom: 20px; font-size: 0.9rem;">Hotel Building - Guest Accommodations and Services</p>
                                    
                                    <!-- Hotel Building Floors - Efficiency Control -->
                                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(220px, max-content)); gap: 20px;">
                                        <div class="param-control" style="border: 2px solid var(--umgc-red); border-radius: 8px; padding: 15px; background: linear-gradient(135deg, #fff5f5 0%, #ffffff 100%);">
                                            <h4 style="color: var(--umgc-red); font-size: 1rem; margin-bottom: 10px; font-weight: 700;">1st Floor</h4>
                                            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 12px;">
                                                <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                                    <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing GSF</div>
                                                    <div style="font-size: 0.95rem; color: var(--umgc-red); font-weight: 700;">7,500</div>
                                            </div>
                                                <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                                    <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing Eff</div>
                                                    <div style="font-size: 0.95rem; color: var(--umgc-red); font-weight: 700;">71%</div>
                                            </div>
                                                <div style="padding: 8px; background: var(--umgc-gray-light); border-radius: 4px; text-align: center;">
                                                    <div style="font-size: 0.7rem; color: var(--umgc-text-light); margin-bottom: 2px;">Existing ASF</div>
                                                    <div style="font-size: 0.95rem; color: var(--umgc-red); font-weight: 700;">5,325</div>
                                        </div>
                                    </div>
                                            <div class="param-header">
                                                <label class="param-label">Planned Efficiency</label>
                                                <span class="param-value" id="hotelFloor1EffValue">71%</span>
                                            </div>
                                            <input type="range" class="slider" id="hotelFloor1EffSlider" min="50" max="100" value="71" step="1" oninput="updateHotelFloorEfficiency(1, this.value)">
                                            <div style="margin-top: 8px; padding: 8px; background: var(--umgc-blue-light); border-radius: 4px; text-align: center;">
                                                <span style="font-size: 0.8rem; color: var(--umgc-navy); font-weight: 600;">Planned Assignable SF: <span id="hotelFloor1Assignable">5,310</span></span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Hotel Space Allocation -->
                        <div class="space-card">
                            <div class="collapsible-header" style="padding: 15px 20px; background: linear-gradient(135deg, var(--umgc-red) 0%, #dc2626 100%); border-radius: 8px; margin-bottom: 15px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px; flex-wrap: wrap;">
                                    <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                                        <h3 style="color: white; margin: 0; font-size: 1.1rem; font-weight: 600; cursor: pointer;" onclick="toggleHotelSpaceAllocation()">Hotel Space Allocation</h3>
                                        <button id="resetHotelSpaceAllocationBtn" onclick="resetHotelSpaceAllocationToExisting()" 
                                                style="background: #fff3e0; color: #f57c00; border: 1px solid #ffcc02; padding: 6px 12px; border-radius: 15px; 
                                                       font-size: 0.8rem; font-weight: 600; cursor: pointer; 
                                                       transition: all 0.3s ease;"
                                                onmouseover="this.style.background='#ffcc02'; this.style.borderColor='#ff8f00'"
                                                onmouseout="this.style.background='#fff3e0'; this.style.borderColor='#ffcc02'">
                                            Reset to Existing
                                        </button>
                                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer; background: rgba(255,255,255,0.1); padding: 6px 12px; border-radius: 20px;">
                                            <input type="checkbox" id="hotelShowExistingToggle" onchange="toggleHotelExistingData()" checked style="cursor: pointer;">
                                            <span style="color: white; font-size: 0.85rem; font-weight: 600;">Show Existing</span>
                                        </label>
                                    </div>
                                    <div style="display: flex; gap: 25px; align-items: center; flex: 1; justify-content: flex-end;">
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Total Assigned</div>
                                            <div id="hotelTotalAssignedSF" style="color: white; font-size: 1.1rem; font-weight: 700;">0</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Work Points</div>
                                            <div id="hotelTotalOfficeSF" style="color: white; font-size: 1.1rem; font-weight: 700;">0</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Collaboration Points</div>
                                            <div id="hotelTotalCollabSF" style="color: white; font-size: 1.1rem; font-weight: 700;">0</div>
                                        </div>
                                        <div style="text-align: center;">
                                            <div style="color: white; font-size: 0.75rem; margin-bottom: 2px;">Other</div>
                                            <div id="hotelTotalOtherSF" style="color: white; font-size: 1.1rem; font-weight: 700;">0</div>
                                        </div>
                                    </div>
                                    <span id="hotelSpaceAllocationToggle" style="color: white; font-size: 1.2rem; transition: transform 0.3s ease;">â–¼</span>
                                </div>
                            </div>
                            <div id="hotelSpaceAllocationContent" style="max-height: 3000px; overflow: hidden; transition: max-height 0.4s ease;">
                                <!-- Horizontal Categories Layout -->
                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 20px; padding: 20px;">
                                    <!-- Work Points Column -->
                                    <div style="background: #f8f9fa; border: 2px solid hsl(217, 91%, 60%); border-radius: 8px; padding: 15px;">
                                        <div class="category-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid hsl(217, 91%, 60%);">
                                            <div>
                                                <h4 style="color: hsl(217, 91%, 40%); font-size: 1rem; font-weight: 700; margin: 0 0 5px 0;">Work Points</h4>
                                                <div style="display: flex; gap: 12px; font-size: 0.85rem;">
                                                    <span id="hotelWorkPointsCount" style="color: hsl(217, 91%, 40%); font-weight: 600;">0 spaces</span>
                                                    <span id="hotelWorkPointsSubtotal" style="color: hsl(217, 91%, 40%); font-weight: 600;">0 SF</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="hotelWorkPointsContent">
                                            <div class="space-types-grid" id="hotelWorkPointsSpacesGrid" style="grid-template-columns: 1fr;">
                                                <!-- Work Points space types will be dynamically generated -->
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Collaboration Points Column -->
                                    <div style="background: #f8f9fa; border: 2px solid hsl(47, 96%, 53%); border-radius: 8px; padding: 15px;">
                                        <div class="category-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid hsl(47, 96%, 53%);">
                                            <div>
                                                <h4 style="color: hsl(45, 80%, 35%); font-size: 1rem; font-weight: 700; margin: 0 0 5px 0;">Collaboration Points</h4>
                                                <div style="display: flex; gap: 12px; font-size: 0.85rem;">
                                                    <span id="hotelCollaborationPointsCount" style="color: hsl(45, 80%, 35%); font-weight: 600;">0 spaces</span>
                                                    <span id="hotelCollaborationPointsSubtotal" style="color: hsl(45, 80%, 35%); font-weight: 600;">0 SF</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="hotelCollaborationPointsContent">
                                            <div class="space-types-grid" id="hotelCollaborationPointsSpacesGrid" style="grid-template-columns: 1fr;">
                                                <!-- Collaboration Points space types will be dynamically generated -->
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Other Spaces Column -->
                                    <div style="background: #f8f9fa; border: 2px solid hsl(280, 65%, 60%); border-radius: 8px; padding: 15px;">
                                        <div class="category-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid hsl(280, 65%, 60%);">
                                            <div>
                                                <h4 style="color: hsl(280, 65%, 40%); font-size: 1rem; font-weight: 700; margin: 0 0 5px 0;">Other Spaces</h4>
                                                <span id="hotelOtherSubtotal" style="color: hsl(280, 65%, 40%); font-size: 0.85rem; font-weight: 600;">0 SF</span>
                                            </div>
                                        </div>
                                        <div id="hotelOtherContent">
                                            <div class="space-types-grid" id="hotelOtherSpacesGrid" style="grid-template-columns: 1fr;">
                                                <!-- Other space types will be dynamically generated -->
                                            </div>
                                            <!-- Custom Space Input -->
                                            <div style="margin-top: 20px; padding: 15px; background: white; border: 1px solid #dee2e6; border-radius: 8px;">
                                                <h5 style="color: var(--umgc-navy); font-size: 0.9rem; font-weight: 600; margin-bottom: 10px;">Add Custom Space</h5>
                                                <div class="custom-space-inputs">
                                                    <div class="custom-input-group">
                                                        <label class="custom-label" style="color: var(--umgc-navy);">Space Name</label>
                                                        <input type="text" class="custom-input" id="hotelCustomName" placeholder="e.g., Storage Room">
                                                    </div>
                                                    <div class="custom-input-group">
                                                        <label class="custom-label" style="color: var(--umgc-navy);">Square Feet</label>
                                                        <input type="number" class="custom-input" id="hotelCustomSF" placeholder="e.g., 200">
                                                    </div>
                                                    <div class="custom-input-group">
                                                        <label class="custom-label" style="color: var(--umgc-navy);">Qty</label>
                                                        <input type="number" class="custom-input" id="hotelCustomQty" placeholder="e.g., 2">
                                                    </div>
                                                    <div class="custom-input-group">
                                                        <button class="add-space-button" onclick="addHotelCustomSpace()">
                                                            âž• Add Space
                                                        </button>
                                                    </div>
                                                </div>
                                                <div id="hotelCustomSpacesList" class="custom-spaces-list" style="margin-top: 15px;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                </div>
                    </div>
                </div>

                <!-- Adelphi Campus Content -->
                <div id="comparison-building-content" class="building-content active">
                    <div class="space-planning-container">
                        <!-- Campus Summary Header -->
                        <div class="collapsible-header" style="padding: 15px 20px; background: linear-gradient(135deg, var(--umgc-navy) 0%, #003366 100%); box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1); position: sticky; top: 236px; z-index: 997; margin: 0;">
                            <div style="display: flex; justify-content: space-between; align-items: center; gap: 20px; flex-wrap: wrap;">
                                <h3 style="color: white; margin: 0; font-size: 1.3rem; font-weight: 700;">Adelphi Campus</h3>
                                <div style="display: flex; align-items: center; gap: 20px; flex: 1; justify-content: center;">
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px;">Remaining SF</div>
                                        <div id="campusRemainingSF" style="color: white; font-size: 1.2rem; font-weight: 700;">0</div>
                                    </div>
                                </div>
                                <div style="display: flex; gap: 20px; align-items: center; flex-wrap: wrap;">
                                    <div style="text-align: center;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px;">vs Existing (Efficiency)</div>
                                        <div id="campusDeltaGSF" style="color: white; font-size: 1rem; font-weight: 700;">+0</div>
                                    </div>
                                    <div style="text-align: center; border-left: 1px solid rgba(255,255,255,0.3); padding-left: 15px;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px; font-weight: 600;">vs Existing Workpoints</div>
                                        <div id="campusDeltaWorkstations" style="color: white; font-size: 1rem; font-weight: 700; margin-bottom: 3px;">+0</div>
                                        <div style="display: flex; gap: 10px; font-size: 0.65rem; color: rgba(255,255,255,0.8);">
                                            <span>Workpoints: <span id="campusHeaderDeskCount" style="font-weight: 600;">0</span></span>
                                        </div>
                                    </div>
                                    <div style="text-align: center; border-left: 1px solid rgba(255,255,255,0.3); padding-left: 15px;">
                                        <div style="color: white; font-size: 0.7rem; margin-bottom: 2px; font-weight: 600;">vs Existing Collaboration</div>
                                        <div id="campusDeltaOffices" style="color: white; font-size: 1rem; font-weight: 700; margin-bottom: 3px;">+0</div>
                                        <div style="display: flex; gap: 10px; font-size: 0.65rem; color: rgba(255,255,255,0.8);">
                                            <span>Offices: <span id="campusHeaderOfficeCount" style="font-weight: 600;">0</span></span>
                                            <span>Conference: <span id="campusHeaderConfCount" style="font-weight: 600;">0</span></span>
                                            <span>Huddle: <span id="campusHeaderHuddleCount" style="font-weight: 600;">0</span></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="building-comparison">
                            <div class="building-summary-grid">
                                <div class="building-summary-card admin">
                                    <div class="building-header">
                                        <h3><img src="adminbuilding.jpg" alt="Admin Building" style="width: 32px; height: 32px; object-fit: cover; border-radius: 4px; vertical-align: middle; margin-right: 8px;"> Admin Building</h3>
                                        <div class="building-status">Active</div>
                                    </div>
                                    <div class="building-metrics">
                                        <div class="metric">
                                            <span class="metric-label">GSF in Scope</span>
                                            <span class="metric-value" id="adminTotalGSF">142,300</span>
                                        </div>
                                    </div>
                                    
                                    <!-- Admin ASF Comparison -->
                                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--umgc-gray-medium);">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">EXISTING</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 4px;"><strong>Assignable SF:</strong> <span id="adminExistingASF">77,514</span></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">PLANNED</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 4px;"><strong>Assignable SF:</strong> <span id="adminPlannedASF">77,514</span></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Admin Comparison -->
                                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--umgc-gray-medium);">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">EXISTING</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 8px;"><strong>Workpoints: <span id="adminSummaryExistingWorkpoints">292</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Desks: <span id="adminSummaryExistingWorkstation">99</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Offices: <span id="adminSummaryExistingOffice">193</span></div>
                                                    <div style="margin-bottom: 8px;"><strong>Collaboration: <span id="adminSummaryExistingCollab">56</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Conference: <span id="adminSummaryExistingConference">21</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Huddle: <span id="adminSummaryExistingHuddle">35</span></div>
                                                    <div><strong>Seats:</strong> <span id="adminSummaryExistingSeats">738</span></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">PLANNED</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 8px;"><strong>Workpoints: <span id="adminSummaryWorkpoints">292</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Desks: <span id="adminSummaryWorkstation">99</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Offices: <span id="adminSummaryOffice">193</span></div>
                                                    <div style="margin-bottom: 8px;"><strong>Collaboration: <span id="adminSummaryCollab">56</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Conference: <span id="adminSummaryConference">21</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Huddle: <span id="adminSummaryHuddle">35</span></div>
                                                    <div><strong>Seats:</strong> <span id="adminSummarySeats">738</span></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="building-summary-card icc">
                                    <div class="building-header">
                                        <h3><img src="ICC.jpg" alt="ICC Building" style="width: 32px; height: 32px; object-fit: cover; border-radius: 4px; vertical-align: middle; margin-right: 8px;"> ICC Building</h3>
                                        <div class="building-status">Active</div>
                                    </div>
                                    <div class="building-metrics">
                                        <div class="metric">
                                            <span class="metric-label">GSF in Scope</span>
                                            <span class="metric-value" id="iccTotalGSF">37,700</span>
                                        </div>
                                    </div>
                                    
                                    <!-- ICC ASF Comparison -->
                                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--umgc-gray-medium);">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">EXISTING</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 4px;"><strong>Assignable SF:</strong> <span id="iccExistingASF">36,021</span></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">PLANNED</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 4px;"><strong>Assignable SF:</strong> <span id="iccPlannedASF">36,021</span></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- ICC Comparison -->
                                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--umgc-gray-medium);">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">EXISTING</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 8px;"><strong>Workpoints: <span id="iccSummaryExistingWorkpoints">66</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Desks: <span id="iccSummaryExistingWorkstation">17</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Offices: <span id="iccSummaryExistingOffice">49</span></div>
                                                    <div style="margin-bottom: 8px;"><strong>Collaboration: <span id="iccSummaryExistingCollab">7</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Conference: <span id="iccSummaryExistingConference">7</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Huddle: <span id="iccSummaryExistingHuddle">0</span></div>
                                                    <div><strong>Seats:</strong> <span id="iccSummaryExistingSeats">126</span></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">PLANNED</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 8px;"><strong>Workpoints: <span id="iccSummaryWorkpoints">66</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Desks: <span id="iccSummaryWorkstation">17</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Offices: <span id="iccSummaryOffice">49</span></div>
                                                    <div style="margin-bottom: 8px;"><strong>Collaboration: <span id="iccSummaryCollab">7</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Conference: <span id="iccSummaryConference">7</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Huddle: <span id="iccSummaryHuddle">0</span></div>
                                                    <div><strong>Seats:</strong> <span id="iccSummarySeats">126</span></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="building-summary-card hotel">
                                    <div class="building-header">
                                        <h3><img src="hotel.jpg" alt="Hotel Building" style="width: 32px; height: 32px; object-fit: cover; border-radius: 4px; vertical-align: middle; margin-right: 8px;"> Hotel Building</h3>
                                        <div class="building-status">Active</div>
                                    </div>
                                    <div class="building-metrics">
                                        <div class="metric">
                                            <span class="metric-label">GSF in Scope</span>
                                            <span class="metric-value" id="hotelTotalGSF">7,500</span>
                                        </div>
                                    </div>
                                    
                                    <!-- Hotel ASF Comparison -->
                                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--umgc-gray-medium);">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">EXISTING</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 4px;"><strong>Assignable SF:</strong> <span id="hotelExistingASF">5,310</span></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">PLANNED</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 4px;"><strong>Assignable SF:</strong> <span id="hotelPlannedASF">5,310</span></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Hotel Comparison -->
                                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--umgc-gray-medium);">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">EXISTING</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 8px;"><strong>Workpoints: <span id="hotelSummaryExistingWorkpoints">0</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Desks: <span id="hotelSummaryExistingWorkstation">0</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Offices: <span id="hotelSummaryExistingOffice">0</span></div>
                                                    <div style="margin-bottom: 8px;"><strong>Collaboration: <span id="hotelSummaryExistingCollab">6</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Conference: <span id="hotelSummaryExistingConference">6</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Huddle: <span id="hotelSummaryExistingHuddle">0</span></div>
                                                    <div><strong>Seats:</strong> <span id="hotelSummaryExistingSeats">108</span></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">PLANNED</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 8px;"><strong>Workpoints: <span id="hotelSummaryWorkpoints">0</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Desks: <span id="hotelSummaryWorkstation">0</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Offices: <span id="hotelSummaryOffice">0</span></div>
                                                    <div style="margin-bottom: 8px;"><strong>Collaboration: <span id="hotelSummaryCollab">6</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Conference: <span id="hotelSummaryConference">6</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Huddle: <span id="hotelSummaryHuddle">0</span></div>
                                                    <div><strong>Seats:</strong> <span id="hotelSummarySeats">108</span></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="building-summary-card combined">
                                    <div class="building-header">
                                        <h3><img src="adelphicampus.png" alt="Adelphi Campus" style="width: 32px; height: 32px; object-fit: cover; border-radius: 4px; vertical-align: middle; margin-right: 8px;"> Adelphi Campus</h3>
                                        <div class="building-status">Total</div>
                                    </div>
                                    <div class="building-metrics">
                                        <div class="metric">
                                            <span class="metric-label">GSF in Scope</span>
                                            <span class="metric-value" id="campusTotalGSF">187,500</span>
                                        </div>
                                    </div>
                                    
                                    <!-- Campus Comparison -->
                                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--umgc-gray-medium);">
                                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">EXISTING</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 4px;"><strong>Assignable SF:</strong> <span id="campusExistingAssignable">118,845</span></div>
                                                    <div style="border-top: 1px solid var(--umgc-gray-medium); margin-top: 20px; padding-top: 20px;">
                                                        <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">EXISTING</div>
                                                    </div>
                                                    <div style="margin-bottom: 8px;"><strong>Workpoints: <span id="campusExistingWorkpoints">358</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Desks: <span id="campusExistingDesks">116</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Offices: <span id="campusExistingOffices">242</span></div>
                                                    <div style="margin-bottom: 8px;"><strong>Collaboration: <span id="campusExistingCollaboration">69</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Conference: <span id="campusExistingConference">34</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Huddle: <span id="campusExistingHuddle">35</span></div>
                                                    <div><strong>Seats:</strong> <span id="campusExistingSeats">822</span></div>
                                                </div>
                                            </div>
                                            <div>
                                                <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">PLANNED</div>
                                                <div style="font-size: 0.85rem; color: var(--umgc-text-dark);">
                                                    <div style="margin-bottom: 4px;"><strong>Assignable SF:</strong> <span id="campusPlannedAssignable">118,845</span></div>
                                                    <div style="border-top: 1px solid var(--umgc-gray-medium); margin-top: 20px; padding-top: 20px;">
                                                        <div style="font-size: 0.75rem; font-weight: 700; color: var(--umgc-text-light); margin-bottom: 8px;">PLANNED</div>
                                                    </div>
                                                    <div style="margin-bottom: 8px;"><strong>Workpoints: <span id="campusPlannedWorkpoints">358</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Desks: <span id="campusPlannedDesks">116</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Offices: <span id="campusPlannedOffices">242</span></div>
                                                    <div style="margin-bottom: 8px;"><strong>Collaboration: <span id="campusPlannedCollaboration">69</span></strong></div>
                                                    <div style="margin-left: 15px; margin-bottom: 2px;">Conference: <span id="campusPlannedConference">34</span></div>
                                                    <div style="margin-left: 15px; margin-bottom: 8px;">Huddle: <span id="campusPlannedHuddle">35</span></div>
                                                    <div><strong>Seats:</strong> <span id="campusPlannedSeats">822</span></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Comparison Charts Section -->
                        <div class="space-card" style="margin-top: 30px;">
                            <h3 class="space-card-title">Adelphi Campus - Existing vs. Planned Comparison</h3>
                            <p class="space-card-desc">Detailed comparison across all three buildings</p>
                            
                            
                            <!-- Seats and Offices Comparison -->
                            <div style="margin-bottom: 40px;">
                                <h4 style="color: var(--umgc-navy); font-size: 1.1rem; font-weight: 600; margin-bottom: 15px;">Workstations & Offices</h4>
                                <div style="position: relative; height: 350px; width: 100%;">
                                    <canvas id="seatsOfficesComparisonChart"></canvas>
                                </div>
                            </div>
                            
                            <!-- Collaboration Seats -->
                            <div style="margin-bottom: 40px;">
                                <h4 style="color: var(--umgc-navy); font-size: 1.1rem; font-weight: 600; margin-bottom: 15px;">Collaboration Seats</h4>
                                <div style="position: relative; height: 300px; width: 100%;">
                                    <canvas id="collabSeatsComparisonChart"></canvas>
                                </div>
                            </div>
                            
                            <!-- Collaboration Rooms by Category -->
                            <div style="margin-bottom: 40px;">
                                <h4 style="color: var(--umgc-navy); font-size: 1.1rem; font-weight: 600; margin-bottom: 15px;">Collaboration Rooms by Category</h4>
                                <div style="position: relative; height: 400px; width: 100%;">
                                    <canvas id="collabRoomsComparisonChart"></canvas>
                                </div>
                            </div>
                            
                            
                        </div>
                    </div>
                </div>
                </div>
                <!-- End building content wrapper -->
            </div>
            <!-- END Dashboard 1 -->

            <!-- Commuter Analysis Content -->
            <div id="dashboard2" class="tab-content">
                <div class="commute-analysis-container">
                    <!-- Header Section -->
                    <div class="commute-header">
                        <h2 class="commute-title">Employee Commute Analysis</h2>
                        <div class="commute-info-box">
                            <p class="commute-info-text">Analyzing 749 people assigned to the Adelphi Campus</p>
                </div>
                        <p class="commute-subtitle">Insights on Travel Times by Car, Public Transport, and Direct Distance</p>
                    </div>

                    <!-- Interactive Filters -->
                    <div class="filter-tabs">
                        <button class="filter-tab active" id="timeTab" onclick="switchFilterTab('time')">
                            <span>â°</span> Filter by Time
                        </button>
                        <button class="filter-tab" id="distanceTab" onclick="switchFilterTab('distance')">
                            <span>ðŸ“</span> Filter by Distance
                        </button>
                    </div>

                    <!-- Time Filter Content -->
                    <div id="timeFilter" class="filter-content active">
                        <div class="filter-card">
                            <h3 class="filter-card-title"><span>â°</span> Travel Time Analysis</h3>
                            <p class="filter-card-desc">Adjust the slider to see how many people are within different travel time thresholds</p>
                            
                            <div class="slider-container">
                                <div class="slider-header">
                                    <label class="slider-label">Maximum Travel Time</label>
                                    <span class="slider-value" id="timeValue">60 minutes</span>
                                </div>
                                <input type="range" class="slider" id="timeSlider" min="0" max="120" value="60" step="5" oninput="updateTimeThreshold(this.value)">
                            </div>

                            <div class="stats-grid">
                                <div class="stat-card stat-card-blue">
                                    <div class="stat-header">
                                        <span class="stat-icon">ðŸš—</span>
                                        <h4 class="stat-title">By Car</h4>
                                    </div>
                                    <div class="stat-value" id="carTimeCount">0</div>
                                    <p class="stat-desc">people within <span id="timeThresholdText">60</span> minutes</p>
                                </div>

                                <div class="stat-card stat-card-green">
                                    <div class="stat-header">
                                        <span class="stat-icon">ðŸšŠ</span>
                                        <h4 class="stat-title">By Public Transport</h4>
                                    </div>
                                    <div class="stat-value" id="transitTimeCount">0</div>
                                    <p class="stat-desc">people within <span id="timeThresholdText2">60</span> minutes</p>
                                    <p class="stat-warning" id="noTransitWarning"></p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Distance Filter Content -->
                    <div id="distanceFilter" class="filter-content">
                        <div class="filter-card">
                            <h3 class="filter-card-title"><span>ðŸ“</span> Distance Analysis</h3>
                            <p class="filter-card-desc">Adjust the slider to see how many people are within different distance thresholds</p>
                            
                            <div class="slider-container">
                                <div class="slider-header">
                                    <label class="slider-label">Maximum Distance</label>
                                    <span class="slider-value" id="distanceValue">25 miles</span>
                                </div>
                                <input type="range" class="slider" id="distanceSlider" min="5" max="100" value="25" step="5" oninput="updateDistanceThreshold(this.value)">
                            </div>

                            <div class="stats-grid">
                                <div class="stat-card stat-card-blue">
                                    <div class="stat-header">
                                        <span class="stat-icon">ðŸš—</span>
                                        <h4 class="stat-title">By Car Route</h4>
                                    </div>
                                    <div class="stat-value" id="carDistanceCount">0</div>
                                    <p class="stat-desc">people within <span id="distanceThresholdText">25</span> miles</p>
                                </div>

                                <div class="stat-card stat-card-purple">
                                    <div class="stat-header">
                                        <span class="stat-icon">ðŸ§­</span>
                                        <h4 class="stat-title">As Crow Flies</h4>
                                    </div>
                                    <div class="stat-value" id="crowFliesCount">0</div>
                                    <p class="stat-desc">people within <span id="distanceThresholdText2">25</span> miles</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Map Placeholder -->
                    <div class="map-card">
                        <div class="map-header">
                            <div>
                                <h3 class="map-title"><span>ðŸ—ºï¸</span> Employee Locations</h3>
                                <p class="map-subtitle">Geographic distribution of employees based on their zipcode locations</p>
                                <div class="map-legend">
                                    <div class="legend-item">
                                        <div class="legend-color legend-green"></div>
                                        <span>Within threshold</span>
                                    </div>
                                    <div class="legend-item">
                                        <div class="legend-color legend-gray"></div>
                                        <span>Outside threshold</span>
                                    </div>
                                    <span class="legend-note">â€¢ Marker size = number of people</span>
                                </div>
                        </div>
                    </div>
                    <div id="mapWrapper" class="map-container">
                        <button class="fullscreen-button" onclick="toggleMapFullscreen()" id="fullscreenBtn">â¤¢ Fullscreen</button>
                        <div id="map" style="width: 100%; height: 100%;"></div>
                    </div>
                    <div class="map-stats">
                            <div class="map-stat">
                                <div class="map-stat-value" id="totalZipcodes">0</div>
                                <div class="map-stat-label">Total Zipcodes</div>
                            </div>
                            <div class="map-stat">
                                <div class="map-stat-value map-stat-green" id="zipcodesInThreshold">0</div>
                                <div class="map-stat-label">Within Threshold</div>
                            </div>
                            <div class="map-stat">
                                <div class="map-stat-value" id="totalPeople">0</div>
                                <div class="map-stat-label">Total People</div>
                            </div>
                            <div class="map-stat">
                                <div class="map-stat-value map-stat-green" id="peopleInThreshold">0</div>
                                <div class="map-stat-label">People in Threshold</div>
                            </div>
                        </div>
                    </div>

                    <!-- Chart Section -->
                    <div class="chart-card">
                        <h3 class="chart-title">Travel Time Distribution</h3>
                        <p class="chart-subtitle">Number of people within different time thresholds</p>
                        <div style="position: relative; height: 300px; width: 100%;">
                            <canvas id="travelChart" class="travel-chart"></canvas>
                        </div>
                    </div>

                    <!-- Key Metrics -->
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-header">
                                <span class="metric-icon">ðŸ“</span>
                                <h4 class="metric-title">Number of Zipcodes</h4>
                            </div>
                            <div class="metric-value" id="metricZipcodes">0</div>
                            <p class="metric-desc">Representing <span id="metricPeople">0</span> people</p>
                        </div>

                        <div class="metric-card">
                            <div class="metric-header">
                                <span class="metric-icon">ðŸš—</span>
                                <h4 class="metric-title">Avg Car Time</h4>
                            </div>
                            <div class="metric-value" id="metricCarTime">0 min</div>
                            <p class="metric-desc" id="metricCarDistance">0 miles average distance</p>
                        </div>

                        <div class="metric-card">
                            <div class="metric-header">
                                <span class="metric-icon">ðŸšŠ</span>
                                <h4 class="metric-title">Avg Transit Time</h4>
                            </div>
                            <div class="metric-value" id="metricTransitTime">N/A</div>
                            <p class="metric-desc" id="metricNoTransit">0 people have no access</p>
                        </div>

                        <div class="metric-card">
                            <div class="metric-header">
                                <span class="metric-icon">ðŸ“</span>
                                <h4 class="metric-title">Avg Direct Distance</h4>
                            </div>
                            <div class="metric-value" id="metricDirectDistance">0 miles</div>
                            <p class="metric-desc">As the crow flies</p>
                        </div>
                    </div>

                    <!-- Upload Button -->
                    <div class="upload-section">
                        <button class="upload-button" onclick="document.getElementById('csvUpload').click()">
                            ðŸ“ Upload New CSV Data
                        </button>
                        <input type="file" id="csvUpload" accept=".csv" style="display: none;" onchange="handleFileUpload(event)">
                        <span id="uploadedFileName" class="uploaded-filename"></span>
                    </div>

                    <!-- Alert -->
                    <div class="alert-box">
                        <p>ðŸ“ Note: 2025-08-06 | For 30 employees, zipcode data was not available and they are not included in this analysis.</p>
                    </div>
                </div>
            </div>

            <!-- Existing Conditions (Power BI) Content -->
            <div id="powerbi" class="tab-content active">
                <div id="loading3" class="loading">
                    Loading Power BI Dashboard...
                </div>
                
                <iframe 
                    class="dashboard-iframe"
                    id="powerbi-frame"
                    src="https://app.powerbi.com/reportEmbed?reportId=3f02874f-fe2a-4b19-9502-6fbec6ab4341&autoAuth=true&ctid=42523965-66b8-4e84-8ead-59b4ba83077b"
                    title="UMGC Power BI Dashboard"
                    allowfullscreen="true"
                    loading="lazy"
                    onload="hideLoading('loading3')">
                </iframe>
            </div>
        </div>
    </div>

    <div class="footer">
        <p><strong>University of Maryland Global Campus</strong></p>
        <p>Facilities Master Plan 2025</p>
        <p>Empowering Education â€¢ Building Futures â€¢ Serving Globally</p>
        <p>Last updated: <span id="lastUpdated"></span></p>
        <p style="margin-top: 15px; font-size: 0.9rem; opacity: 0.8;">
            <a href="https://www.umgc.edu/" target="_blank">Visit UMGC.edu</a> â€¢ 
            <a href="https://www.umgc.edu/about-umgc/locations" target="_blank">Global Locations</a> â€¢ 
            <a href="https://www.umgc.edu/contact-us" target="_blank">Contact Us</a>
        </p>
    </div>

    <script>
        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });

            // Deactivate all tab buttons
            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });

            // Show selected tab content
            document.getElementById(tabName).classList.add('active');

            // Activate selected tab button
            const buttonMap = {
                'dashboard1': 'tab1-btn',
                'dashboard2': 'tab2-btn',
                'powerbi': 'tab3-btn'
            };
            document.getElementById(buttonMap[tabName]).classList.add('active');

            // Store active tab in localStorage
            localStorage.setItem('umgc_active_tab', tabName);
            
            // If switching to Space Planning tab, ensure all data is updated
            if (tabName === 'dashboard1') {
                console.log('Switching to Space Planning tab, updating all data...');
                // Ensure space planning is initialized
                if (typeof initSpacePlanning === 'function') {
                    initSpacePlanning();
                }
                // Ensure campus building is properly initialized
                if (typeof switchBuilding === 'function') {
                    setTimeout(() => {
                        switchBuilding('comparison');
                    }, 50);
                }
                // Update all building comparisons to ensure campus card shows correct values
                if (typeof updateBuildingComparison === 'function') {
                    setTimeout(() => {
                        updateBuildingComparison();
                    }, 100);
                }
            }
        }

        // Hide loading indicator when iframe loads
        function hideLoading(loadingId) {
            const loading = document.getElementById(loadingId);
            if (loading) {
                loading.style.display = 'none';
            }
        }

        // Set last updated timestamp
        document.getElementById('lastUpdated').textContent = new Date().toLocaleDateString();

        // Initialize on page load
        window.addEventListener('load', function() {
            // Always start with powerbi (Existing Conditions) as the landing page
            // Clear any previously stored tab preference
            localStorage.removeItem('umgc_active_tab');
            switchTab('powerbi');
        });

        // Keyboard navigation for tabs
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key >= '1' && e.key <= '3') {
                e.preventDefault();
                const tabs = ['dashboard1', 'dashboard2', 'powerbi'];
                switchTab(tabs[parseInt(e.key) - 1]);
            }
        });

        // ===== COMMUTE ANALYSIS FUNCTIONALITY =====
        
        let commuteData = [];
        let activeFilterTab = 'time';
        let timeThreshold = 60;
        let distanceThreshold = 25;
        let travelChart = null;
        let map = null;
        let markers = [];
        let isMapFullscreen = false;

        // Load data when page loads
        async function loadCommuteData() {
            try {
                const response = await fetch('https://hebbkx1anhila5yf.public.blob.vercel-storage.com/Travel%20Times_Employees_Complete_Analysis_Results-1EbbTKE16GkNZBduF6fz5dH70uwWOM.csv');
                const csvText = await response.text();
                commuteData = parseCSV(csvText);
                console.log('Loaded', commuteData.length, 'records');
                updateAllStats();
                createChart();
                initializeMap();
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        // Initialize Mapbox map
        function initializeMap() {
            if (map || commuteData.length === 0) return;

            mapboxgl.accessToken = 'pk.eyJ1IjoicGF0d2QwNSIsImEiOiJjbTZ2bGVhajIwMTlvMnFwc2owa3BxZHRoIn0.moDNfqMUolnHphdwsIF87w';

            // Filter valid data
            const validData = commuteData.filter(item => 
                item.Latitude && 
                item.Longitude && 
                item.Car_Duration_min > 0 && 
                item.Car_Duration_min <= 90
            );

            if (validData.length === 0) return;

            // Calculate bounds
            const bounds = new mapboxgl.LngLatBounds();
            validData.forEach(item => {
                bounds.extend([item.Longitude, item.Latitude]);
            });

            // Create map
            map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/light-v11',
                bounds: bounds,
                fitBoundsOptions: { padding: 50 }
            });

            // Add navigation controls
            map.addControl(new mapboxgl.NavigationControl(), 'top-left');

            // Add markers when map loads
            map.on('load', function() {
                createMarkers();
            });
        }

        // Create markers for all locations
        function createMarkers() {
            // Remove existing markers
            markers.forEach(marker => marker.remove());
            markers = [];

            const allValidData = commuteData.filter(item => item.Latitude && item.Longitude);
            const kmToMiles = (km) => km * 0.621371;

            allValidData.forEach(item => {
                // Determine if within threshold
                let isWithinThreshold = false;
                
                if (activeFilterTab === 'time') {
                    isWithinThreshold = (item.Car_Duration_min > 0 && item.Car_Duration_min <= timeThreshold) ||
                                       (item.Transit_Duration_min > 0 && item.Transit_Duration_min <= timeThreshold);
                } else {
                    isWithinThreshold = (kmToMiles(item.Car_Distance_km) <= distanceThreshold && item.Car_Distance_km > 0) ||
                                       (kmToMiles(item.Crow_Flies_Distance_km) <= distanceThreshold);
                }

                const isWithin90Min = item.Car_Duration_min > 0 && item.Car_Duration_min <= 90;

                // Create marker element
                const markerEl = document.createElement('div');
                markerEl.className = 'custom-marker';
                const size = Math.max(12, Math.min(24, 12 + item.Number_People_in_Zip * 2));
                markerEl.style.width = `${size}px`;
                markerEl.style.height = `${size}px`;
                markerEl.style.backgroundColor = isWithinThreshold ? '#22c55e' : '#94a3b8';
                markerEl.style.borderRadius = '50%';
                markerEl.style.border = '2px solid white';
                markerEl.style.boxShadow = '0 2px 4px rgba(0,0,0,0.2)';
                markerEl.style.opacity = isWithin90Min ? '1' : '0.3';

                // Create popup
                const popup = new mapboxgl.Popup({ offset: 25 }).setHTML(`
                    <div>
                        <h3>Zipcode: ${item.ZCTA5CE20}</h3>
                        <p><strong>People:</strong> ${item.Number_People_in_Zip}</p>
                        <p><strong>Car Time:</strong> ${item.Car_Duration_min > 0 ? Math.round(item.Car_Duration_min) + ' min' : 'N/A'}</p>
                        <p><strong>Car Distance:</strong> ${item.Car_Distance_km > 0 ? Math.round(kmToMiles(item.Car_Distance_km)) + ' miles' : 'N/A'}</p>
                        <p><strong>Transit Time:</strong> ${item.Transit_Duration_min > 0 ? Math.round(item.Transit_Duration_min) + ' min' : 'N/A'}</p>
                        <p><strong>Direct Distance:</strong> ${Math.round(kmToMiles(item.Crow_Flies_Distance_km))} miles</p>
                        <p><strong>Status:</strong> ${isWithinThreshold ? 'âœ… Within threshold' : 'âŒ Outside threshold'}</p>
                    </div>
                `);

                // Create and add marker
                const marker = new mapboxgl.Marker(markerEl)
                    .setLngLat([item.Longitude, item.Latitude])
                    .setPopup(popup)
                    .addTo(map);

                markers.push(marker);
            });
        }

        // Update marker colors when threshold changes
        function updateMarkerColors() {
            if (!map || markers.length === 0) return;

            const allValidData = commuteData.filter(item => item.Latitude && item.Longitude);
            const kmToMiles = (km) => km * 0.621371;

            markers.forEach((marker, index) => {
                if (allValidData[index]) {
                    const item = allValidData[index];
                    let isWithinThreshold = false;
                    
                    if (activeFilterTab === 'time') {
                        isWithinThreshold = (item.Car_Duration_min > 0 && item.Car_Duration_min <= timeThreshold) ||
                                           (item.Transit_Duration_min > 0 && item.Transit_Duration_min <= timeThreshold);
                    } else {
                        isWithinThreshold = (kmToMiles(item.Car_Distance_km) <= distanceThreshold && item.Car_Distance_km > 0) ||
                                           (kmToMiles(item.Crow_Flies_Distance_km) <= distanceThreshold);
                    }

                    const markerEl = marker.getElement();
                    markerEl.style.backgroundColor = isWithinThreshold ? '#22c55e' : '#94a3b8';
                }
            });
        }

        // Toggle map fullscreen
        function toggleMapFullscreen() {
            const mapWrapper = document.getElementById('mapWrapper');
            const btn = document.getElementById('fullscreenBtn');
            
            isMapFullscreen = !isMapFullscreen;
            
            if (isMapFullscreen) {
                mapWrapper.classList.add('map-fullscreen');
                btn.textContent = 'â¤“ Exit Fullscreen';
            } else {
                mapWrapper.classList.remove('map-fullscreen');
                btn.textContent = 'â¤¢ Fullscreen';
            }
            
            // Resize map after transition
            setTimeout(() => {
                if (map) {
                    map.resize();
                }
            }, 100);
        }

        // Parse CSV data
        function parseCSV(csvText) {
            const lines = csvText.split('\n');
            const headers = lines[0].split(',');
            
            return lines.slice(1)
                .filter(line => line.trim())
                .map(line => {
                    const values = line.split(',');
                    return {
                        ZCTA5CE20: values[0] || '',
                        Latitude: parseFloat(values[1]) || 0,
                        Longitude: parseFloat(values[2]) || 0,
                        Crow_Flies_Distance_km: parseFloat(values[3]) || 0,
                        Car_Distance_km: parseFloat(values[4]) || 0,
                        Car_Duration_min: parseFloat(values[5]) || 0,
                        Car_Error: values[6] === 'null' || !values[6] ? null : values[6],
                        Transit_Distance_km: parseFloat(values[7]) || 0,
                        Transit_Duration_min: parseFloat(values[8]) || 0,
                        Transit_Error: values[9] === 'null' || !values[9] ? null : values[9],
                        Number_People_in_Zip: parseInt(values[10]) || 0
                    };
                });
        }

        // Switch filter tabs (time/distance)
        function switchFilterTab(tab) {
            activeFilterTab = tab;
            
            // Update tab buttons
            document.getElementById('timeTab').classList.toggle('active', tab === 'time');
            document.getElementById('distanceTab').classList.toggle('active', tab === 'distance');
            
            // Update content
            document.getElementById('timeFilter').classList.toggle('active', tab === 'time');
            document.getElementById('distanceFilter').classList.toggle('active', tab === 'distance');
            
            updateAllStats();
        }

        // Update time threshold
        function updateTimeThreshold(value) {
            timeThreshold = parseInt(value);
            document.getElementById('timeValue').textContent = value + ' minutes';
            document.getElementById('timeThresholdText').textContent = value;
            document.getElementById('timeThresholdText2').textContent = value;
            updateAllStats();
        }

        // Update distance threshold
        function updateDistanceThreshold(value) {
            distanceThreshold = parseInt(value);
            document.getElementById('distanceValue').textContent = value + ' miles';
            document.getElementById('distanceThresholdText').textContent = value;
            document.getElementById('distanceThresholdText2').textContent = value;
            updateAllStats();
        }

        // Update all statistics
        function updateAllStats() {
            updateThresholdStats();
            updateDynamicMetrics();
            updateMapStats();
            updateMarkerColors();
        }

        // Update threshold-specific stats
        function updateThresholdStats() {
            const kmToMiles = (km) => km * 0.621371;
            
            if (activeFilterTab === 'time') {
                const carWithinThreshold = commuteData
                    .filter(item => item.Car_Duration_min <= timeThreshold && item.Car_Duration_min > 0)
                    .reduce((sum, item) => sum + item.Number_People_in_Zip, 0);
                
                const transitWithinThreshold = commuteData
                    .filter(item => item.Transit_Duration_min <= timeThreshold && item.Transit_Duration_min > 0)
                    .reduce((sum, item) => sum + item.Number_People_in_Zip, 0);
                
                const noTransitAccess = commuteData
                    .filter(item => item.Transit_Error === 'No route found' || item.Transit_Duration_min === 0)
                    .reduce((sum, item) => sum + item.Number_People_in_Zip, 0);
                
                document.getElementById('carTimeCount').textContent = carWithinThreshold;
                document.getElementById('transitTimeCount').textContent = transitWithinThreshold;
                
                const warningEl = document.getElementById('noTransitWarning');
                if (noTransitAccess > 0) {
                    warningEl.textContent = `${noTransitAccess} people have no transit access`;
                } else {
                    warningEl.textContent = '';
                }
            } else {
                const carWithinDistance = commuteData
                    .filter(item => kmToMiles(item.Car_Distance_km) <= distanceThreshold && item.Car_Distance_km > 0)
                    .reduce((sum, item) => sum + item.Number_People_in_Zip, 0);
                
                const crowFliesWithinDistance = commuteData
                    .filter(item => kmToMiles(item.Crow_Flies_Distance_km) <= distanceThreshold)
                    .reduce((sum, item) => sum + item.Number_People_in_Zip, 0);
                
                document.getElementById('carDistanceCount').textContent = carWithinDistance;
                document.getElementById('crowFliesCount').textContent = crowFliesWithinDistance;
            }
        }

        // Update dynamic metrics
        function updateDynamicMetrics() {
            const kmToMiles = (km) => km * 0.621371;
            
            let filteredData = [];
            
            if (activeFilterTab === 'time') {
                filteredData = commuteData.filter(item => 
                    item.Car_Duration_min <= timeThreshold && item.Car_Duration_min > 0
                );
            } else {
                filteredData = commuteData.filter(item => 
                    kmToMiles(item.Crow_Flies_Distance_km) <= distanceThreshold
                );
            }
            
            const totalZipcodes = filteredData.length;
            const totalPeople = filteredData.reduce((sum, item) => sum + item.Number_People_in_Zip, 0);
            
            // Car stats
            const carData = filteredData.filter(item => item.Car_Duration_min > 0);
            const avgCarTime = carData.length > 0 
                ? Math.round(carData.reduce((sum, item) => sum + item.Car_Duration_min, 0) / carData.length)
                : 0;
            const avgCarDistance = carData.length > 0
                ? kmToMiles(carData.reduce((sum, item) => sum + item.Car_Distance_km, 0) / carData.length)
                : 0;
            
            // Transit stats
            const transitData = filteredData.filter(item => item.Transit_Duration_min > 0);
            const avgTransitTime = transitData.length > 0
                ? Math.round(transitData.reduce((sum, item) => sum + item.Transit_Duration_min, 0) / transitData.length)
                : 0;
            const noTransitAccess = filteredData
                .filter(item => item.Transit_Error === 'No route found' || item.Transit_Duration_min === 0)
                .reduce((sum, item) => sum + item.Number_People_in_Zip, 0);
            
            // Direct distance
            const avgDirectDistance = filteredData.length > 0
                ? kmToMiles(filteredData.reduce((sum, item) => sum + item.Crow_Flies_Distance_km, 0) / filteredData.length)
                : 0;
            
            // Update UI
            document.getElementById('metricZipcodes').textContent = totalZipcodes;
            document.getElementById('metricPeople').textContent = totalPeople;
            document.getElementById('metricCarTime').textContent = avgCarTime + ' min';
            document.getElementById('metricCarDistance').textContent = Math.round(avgCarDistance * 10) / 10 + ' miles average distance';
            document.getElementById('metricTransitTime').textContent = avgTransitTime > 0 ? avgTransitTime + ' min' : 'N/A';
            document.getElementById('metricNoTransit').textContent = noTransitAccess + ' people have no access';
            document.getElementById('metricDirectDistance').textContent = Math.round(avgDirectDistance * 10) / 10 + ' miles';
        }

        // Update map statistics
        function updateMapStats() {
            const kmToMiles = (km) => km * 0.621371;
            
            let filteredData = [];
            
            if (activeFilterTab === 'time') {
                filteredData = commuteData.filter(item =>
                    item.Car_Duration_min <= timeThreshold ||
                    (item.Transit_Duration_min > 0 && item.Transit_Duration_min <= timeThreshold)
                );
            } else {
                filteredData = commuteData.filter(item =>
                    kmToMiles(item.Car_Distance_km) <= distanceThreshold ||
                    kmToMiles(item.Crow_Flies_Distance_km) <= distanceThreshold
                );
            }
            
            const validData = commuteData.filter(item => item.Latitude && item.Longitude);
            const withinThreshold = validData.filter(item =>
                filteredData.some(filtered => filtered.ZCTA5CE20 === item.ZCTA5CE20)
            );
            
            const totalPeople = validData.reduce((sum, item) => sum + item.Number_People_in_Zip, 0);
            const peopleInThreshold = withinThreshold.reduce((sum, item) => sum + item.Number_People_in_Zip, 0);
            
            document.getElementById('totalZipcodes').textContent = validData.length;
            document.getElementById('zipcodesInThreshold').textContent = withinThreshold.length;
            document.getElementById('totalPeople').textContent = totalPeople;
            document.getElementById('peopleInThreshold').textContent = peopleInThreshold;
        }

        // Create chart
        function createChart() {
            const ctx = document.getElementById('travelChart');
            if (!ctx) return;
            
            const chartData = [5, 10, 15, 30, 45, 60].map(minutes => ({
                time: minutes + ' min',
                car: commuteData
                    .filter(item => item.Car_Duration_min <= minutes && item.Car_Duration_min > 0)
                    .reduce((sum, item) => sum + item.Number_People_in_Zip, 0),
                transit: commuteData
                    .filter(item => item.Transit_Duration_min <= minutes && item.Transit_Duration_min > 0)
                    .reduce((sum, item) => sum + item.Number_People_in_Zip, 0)
            }));
            
            if (travelChart) {
                travelChart.destroy();
            }
            
            travelChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: chartData.map(d => d.time),
                    datasets: [
                        {
                            label: 'By Car',
                            data: chartData.map(d => d.car),
                            backgroundColor: '#3b82f6',
                            borderColor: '#2563eb',
                            borderWidth: 1
                        },
                        {
                            label: 'By Transit',
                            data: chartData.map(d => d.transit),
                            backgroundColor: '#10b981',
                            borderColor: '#059669',
                            borderWidth: 1
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top'
                        },
                        title: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Number of People'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Travel Time Threshold'
                            }
                        }
                    }
                }
            });
        }

        // Handle file upload
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            if (!file.name.toLowerCase().endsWith('.csv')) {
                alert('Please upload a CSV file');
                return;
            }
            
            const reader = new FileReader();
            
            reader.onload = (e) => {
                try {
                    const csvText = e.target.result;
                    commuteData = parseCSV(csvText);
                    document.getElementById('uploadedFileName').textContent = file.name;
                    console.log('Successfully loaded', commuteData.length, 'records from uploaded file');
                    updateAllStats();
                    createChart();
                    
                    // Recreate map with new data
                    if (map) {
                        map.remove();
                        map = null;
                        markers = [];
                        initializeMap();
                    }
                } catch (error) {
                    console.error('Error parsing uploaded CSV:', error);
                    alert('Error parsing CSV file. Please check the format.');
                }
            };
            
            reader.readAsText(file);
        }

        // Initialize commute analysis when Dashboard 2 is shown
        function initCommuteAnalysis() {
            if (commuteData.length === 0) {
                loadCommuteData();
            }
        }

        // Override switchTab to initialize commute analysis when Dashboard 2 is selected
        const originalSwitchTab = switchTab;
        switchTab = function(tabName) {
            originalSwitchTab(tabName);
            if (tabName === 'dashboard2') {
                initCommuteAnalysis();
            } else if (tabName === 'dashboard1') {
                initSpacePlanning();
            }
        };

        // ===== SPACE PLANNING FUNCTIONALITY =====
        
        const SPACE_TYPES = [
            { id: "cubicalDesk", name: "Cubical/Desk", defaultSf: 60, category: "workPoints", color: "hsl(217, 91%, 60%)", seats: 0 },
            { id: "office", name: "Office", defaultSf: 140, category: "workPoints", color: "hsl(142, 76%, 36%)", seats: 0 },
            { id: "conferenceRoom", name: "Conference Room - Reservable", defaultSf: 480, category: "collaborationPoints", color: "hsl(47, 96%, 53%)", seats: 12 },
            { id: "huddleShelter", name: "Huddle/Shelter - Non Reservable", defaultSf: 180, category: "collaborationPoints", color: "hsl(47, 96%, 63%)", seats: 6 },
            { id: "otherSpaces", name: "Storage, Kitchen, and Other Support Spaces", defaultSf: 28174, category: "otherSpaces", color: "hsl(280, 65%, 45%)", seats: 0 }
        ];

        const CATEGORY_NAMES = {
            workPoints: "Work Points",
            collaborationPoints: "Collaboration Points",
            otherSpaces: "Other Spaces"
        };

        const CATEGORY_COLORS = {
            workPoints: "hsl(217, 91%, 60%)",
            collaborationPoints: "hsl(47, 96%, 53%)",
            otherSpaces: "hsl(280, 65%, 45%)"
        };

        let spaceInitialized = false;
        let floorSpaces = [37200, 37100, 37100, 30900]; // 4 floors for Admin Building (existing GSF values)
        let floorEfficiencies = [49, 46, 53, 73]; // Existing efficiency for each floor (default)
        let spaceSF = {};
        let iccSpaceSF = {};
        let hotelSpaceSF = {};
        let quantities = {
            cubicalDesk: 99, // Match existing quantities as baseline
            office: 193,
            conferenceRoom: 21,
            huddleShelter: 35,
            otherSpaces: 1 // 1 unit of 28,174 SF for storage, kitchen, and other support spaces
        };
        let showExisting = true;
        let assignByFloor = true; // Always use floor-by-floor assignment
        let floorQuantities = {
            cubicalDesk: [84, 7, 0, 8], // Match existing floor distribution as baseline
            office: [12, 65, 100, 16],
            conferenceRoom: [7, 5, 5, 4],
            huddleShelter: [20, 6, 7, 2],
            otherSpaces: [0, 0, 0, 0] // Storage, kitchen, and other support spaces are not assigned by floor
        };
        let existingFloorQuantities = {
            cubicalDesk: [84, 7, 0, 8], // Floor 1, 2, 3, 4 (from provided data)
            office: [12, 65, 100, 16],
            conferenceRoom: [7, 5, 5, 4], // Floor 1, 2, 3, 4 (from provided data)
            huddleShelter: [20, 6, 7, 2],
            otherSpaces: [0, 0, 0, 0] // Storage, kitchen, and other support spaces are not assigned by floor
        };

        // ICC Building Data (same space types as Admin)
        let iccQuantities = {
            cubicalDesk: 17, // Match existing quantities as baseline
            office: 49,
            conferenceRoom: 7,
            huddleShelter: 0
        };

        let iccFloorQuantities = {
            cubicalDesk: [9, 0, 8, 0], // Basement, Floor 2, 3rd Floor, Floor 4
            office: [19, 0, 30, 0],
            conferenceRoom: [1, 0, 6, 0],
            huddleShelter: [0, 0, 0, 0]
        };

        let iccExistingQuantities = {
            cubicalDesk: 17, // 9 + 8
            office: 49, // 19 + 30
            conferenceRoom: 7, // 1 + 6
            huddleShelter: 0
        };

        let iccExistingFloorQuantities = {
            cubicalDesk: [9, 0, 8, 0], // Basement, Floor 2, 3rd Floor, Floor 4
            office: [19, 0, 30, 0],
            conferenceRoom: [1, 0, 6, 0],
            huddleShelter: [0, 0, 0, 0]
        };

        // Hotel Building Data (same space types as Admin)
        let hotelQuantities = {
            cubicalDesk: 0, // Match existing quantities as baseline
            office: 0,
            conferenceRoom: 6,
            huddleShelter: 0
        };

        let hotelFloorQuantities = {
            cubicalDesk: [0, 0, 0, 0], // Match existing floor distribution as baseline
            office: [0, 0, 0, 0],
            conferenceRoom: [6, 0, 0, 0], // All 6 conference rooms on 1st floor
            huddleShelter: [0, 0, 0, 0]
        };

        let hotelExistingQuantities = {
            cubicalDesk: 0,
            office: 0,
            conferenceRoom: 6,
            huddleShelter: 0
        };

        let hotelExistingFloorQuantities = {
            cubicalDesk: [0, 0, 0, 0], // 1st Floor, Floor 2, Floor 3, Floor 4
            office: [0, 0, 0, 0],
            conferenceRoom: [6, 0, 0, 0], // All 6 conference rooms on 1st floor
            huddleShelter: [0, 0, 0, 0]
        };

        let iccShowExisting = true;
        let iccAssignByFloor = false;
        let hotelShowExisting = true;
        let hotelAssignByFloor = false;

        // ICC Building floor parameters (Basement fixed ASF, 3rd Floor with GSF and efficiency)
        let iccFloorSpaces = [20300, 0, 19900, 0]; // Basement (ASF), Floor 2, 3rd Floor (GSF), Floor 4
        let iccFloorEfficiencies = [100, 100, 79, 100]; // Basement 100% (ASF), 3rd Floor 79% efficiency (existing)

        // Hotel Building floor parameters (1st Floor with ASF only)
        let hotelFloorSpaces = [7500, 0, 0, 0]; // 1st Floor only (ASF value)
        let hotelFloorEfficiencies = [70.8, 100, 100, 100]; // 1st Floor 70.8% efficiency (existing), other floors not used
        let existingQuantities = {
            cubicalDesk: 99, // 84+7+0+8 from provided data
            office: 193, // 12+65+100+16 from provided data
            conferenceRoom: 21, // 7+5+5+4 from provided data
            huddleShelter: 35, // 20+6+7+2 from provided data
            otherSpaces: 1 // 1 unit of 28,174 SF for storage, kitchen, and other support spaces
        };
        let customSpaces = [];
        let iccCustomSpaces = [];
        let hotelCustomSpaces = [];
        let categoryChart = null;
        let typeChart = null;
        let alertShown = false;

        // Initialize space SF defaults
        SPACE_TYPES.forEach(type => {
            spaceSF[type.id] = type.defaultSf;
            iccSpaceSF[type.id] = type.defaultSf;
            hotelSpaceSF[type.id] = type.defaultSf;
        });
        
        // Hotel Building conference rooms have different SF (885 SF each)
        hotelSpaceSF['conferenceRoom'] = 885;
        
        // ICC Building conference rooms have different SF (330 SF each)
        iccSpaceSF['conferenceRoom'] = 330;

        function initSpacePlanning() {
            if (spaceInitialized) return;
            spaceInitialized = true;
            
            // Initialize Admin Building floor quantities (don't override existing distributions)
            SPACE_TYPES.forEach(type => {
                // Only initialize if floor quantities are all zeros (not already set)
                if (floorQuantities[type.id].every(qty => qty === 0)) {
                const buildingQty = quantities[type.id] || 0;
                if (buildingQty > 0) {
                    const qtyPerFloor = Math.floor(buildingQty / 4);
                    const remainder = buildingQty % 4;
                    
                    floorQuantities[type.id] = [
                        qtyPerFloor + (remainder > 0 ? 1 : 0),
                        qtyPerFloor + (remainder > 1 ? 1 : 0),
                        qtyPerFloor + (remainder > 2 ? 1 : 0),
                        qtyPerFloor
                    ];
                    }
                }
            });
            
            // Initialize ICC Building floor quantities (use existing distribution)
            // Don't override the existing floor distribution that matches actual building layout
            
            // Initialize Hotel Building floor quantities (use existing distribution)
            // Don't override the existing floor distribution that matches actual building layout
            
            // Render all buildings
            renderSpaceTypes();
            renderICCSpaceTypes();
            renderHotelSpaceTypes();
            
            updateSpaceCalculations();
            createSpaceCharts();
            
            // Create campus comparison charts
            createAdephiComparisonCharts();
            
            // Initialize building comparison
            updateBuildingComparison();
            
            // Update all building totals and calculations
            updateBuildingTotals();
            updateICCBuildingTotals();
            updateHotelBuildingTotals();
            
            // Force update of all building comparisons to ensure cards show correct values
            setTimeout(() => {
                updateBuildingComparison();
                updateBuildingTotals();
                updateICCBuildingTotals();
                updateHotelBuildingTotals();
            }, 100);
        }

        function updateFloor(floorNum, value) {
            // Debug: Find which slider triggered this
            const callerSlider = document.activeElement;
            const adminContent = document.getElementById('admin-building-content');
            console.log('Admin updateFloor called with floor:', floorNum, 'value:', value);
            console.log('Triggered by element ID:', callerSlider.id);
            console.log('Element is visible?', callerSlider.offsetParent !== null);
            console.log('Admin content display:', window.getComputedStyle(adminContent).display);
            console.log('Admin content has active class?', adminContent.classList.contains('active'));
            
            // Only run if Admin building is active
            if (!adminContent.classList.contains('active')) {
                console.log('Admin updateFloor called but Admin building not active, ignoring');
                return;
            }
            
            const floorValue = parseInt(value);
            floorSpaces[floorNum - 1] = floorValue;
            document.getElementById(`floor${floorNum}Value`).textContent = floorValue.toLocaleString();
            
            // Update floor assignable SF
            const assignable = Math.round(floorValue * (floorEfficiencies[floorNum - 1] / 100));
            document.getElementById(`floor${floorNum}Assignable`).textContent = assignable.toLocaleString();
            
            updateBuildingTotals();
            updateSpaceCalculations();
            updateBuildingComparison();
        }

        function updateFloorEfficiency(floorNum, value) {
            // Only run if Admin building is active
            if (!document.getElementById('admin-building-content').classList.contains('active')) {
                console.log('Admin updateFloorEfficiency called but Admin building not active, ignoring');
                return;
            }
            
            const effValue = parseInt(value);
            floorEfficiencies[floorNum - 1] = effValue;
            document.getElementById(`floor${floorNum}EffValue`).textContent = effValue + '%';
            
            // Update floor assignable SF using existing GSF values
            const existingGSF = [37200, 37100, 37100, 30900]; // Floor 1, 2, 3, 4 existing GSF
            const assignable = Math.round(existingGSF[floorNum - 1] * (effValue / 100));
            document.getElementById(`floor${floorNum}Assignable`).textContent = assignable.toLocaleString();
            
            updateBuildingTotals();
            updateSpaceCalculations();
            updateBuildingComparison();
        }


        function toggleComparison() {
            const content = document.getElementById('comparisonContent');
            const toggle = document.getElementById('comparisonToggle');
            
            if (content.style.maxHeight === '0px') {
                // Expand
                content.style.maxHeight = '1000px';
                toggle.textContent = 'â–¼';
                toggle.style.transform = 'rotate(0deg)';
            } else {
                // Collapse
                content.style.maxHeight = '0px';
                toggle.textContent = 'â–¶';
                toggle.style.transform = 'rotate(-90deg)';
            }
        }

        function toggleICCComparison() {
            const content = document.getElementById('iccComparisonContent');
            const toggle = document.getElementById('iccComparisonToggle');
            
            if (content && toggle) {
                if (content.style.maxHeight === '0px' || content.style.maxHeight === '') {
                    content.style.maxHeight = '1000px';
                    toggle.textContent = 'â–¼';
                } else {
                    content.style.maxHeight = '0px';
                    toggle.textContent = 'â–²';
                }
            }
        }

        function toggleHotelComparison() {
            const content = document.getElementById('hotelComparisonContent');
            const toggle = document.getElementById('hotelComparisonToggle');
            
            if (content && toggle) {
                if (content.style.maxHeight === '0px' || content.style.maxHeight === '') {
                    content.style.maxHeight = '1000px';
                    toggle.textContent = 'â–¼';
                } else {
                    content.style.maxHeight = '0px';
                    toggle.textContent = 'â–²';
                }
            }
        }

        function updateComparison(totalGSF, assignableSF, workPointsCount, collaborationPointsCount) {
            // Existing conditions from provided data
            const existingAssignable = 77514;
            const existingWorkPoints = 292; // 99 cubical/desk + 193 office
            const existingCollaborationPoints = 56; // 21 conference + 35 huddle/shelter
            
            // Update planned values
            document.getElementById('plannedAssignable').textContent = assignableSF.toLocaleString();
            document.getElementById('plannedWorkPoints').textContent = workPointsCount + (workPointsCount === 1 ? ' space' : ' spaces');
            document.getElementById('plannedCollabPoints').textContent = collaborationPointsCount + (collaborationPointsCount === 1 ? ' space' : ' spaces');
            
            // Calculate deltas
            const deltaAssignableVal = assignableSF - existingAssignable;
            const deltaWorkPointsVal = workPointsCount - existingWorkPoints;
            const deltaCollaborationPointsVal = collaborationPointsCount - existingCollaborationPoints;
            
            // Format delta values with +/- sign
            const formatDelta = (val) => (val >= 0 ? '+' : '') + val.toLocaleString();
            
            // Update delta values in sticky header (with null checks)
            const deltaGSFEl = document.getElementById('deltaGSF');
            const deltaWorkstationsEl = document.getElementById('deltaWorkstations');
            const deltaOfficesEl = document.getElementById('deltaOffices');
            const deltaSpacesEl = document.getElementById('deltaSpaces');
            
            // Update sticky header values
            if (deltaGSFEl) deltaGSFEl.textContent = formatDelta(deltaAssignableVal);
            if (deltaWorkstationsEl) deltaWorkstationsEl.textContent = formatDelta(deltaWorkPointsVal);
            if (deltaOfficesEl) deltaOfficesEl.textContent = formatDelta(deltaCollaborationPointsVal);
            if (deltaSpacesEl) deltaSpacesEl.textContent = formatDelta(deltaCollaborationPointsVal);
        }

        function updateBuildingTotals() {
            // Calculate total building GSF
            const totalGSF = floorSpaces.reduce((sum, floor) => sum + floor, 0);
            document.getElementById('totalBuildingGSF').textContent = totalGSF.toLocaleString();
            
            // Calculate total assignable SF
            // Use existing GSF for assignable SF calculation
            const existingGSF = [37200, 37100, 37100, 30900]; // Floor 1, 2, 3, 4 existing GSF
            let totalAssignable = 0;
            for (let i = 0; i < 4; i++) {
                totalAssignable += Math.round(existingGSF[i] * (floorEfficiencies[i] / 100));
            }
            document.getElementById('totalAssignableSF').textContent = totalAssignable.toLocaleString();
            
            // Calculate overall efficiency
            const overallEff = totalGSF > 0 ? ((totalAssignable / totalGSF) * 100).toFixed(1) : 0;
            document.getElementById('overallEfficiency').textContent = overallEff + '%';
        }

        function updateEfficiency(value) {
            efficiency = parseInt(value);
            document.getElementById('efficiencyValue').textContent = value + '%';
            updateSpaceCalculations();
        }

        function updateSpaceQuantity(id, value) {
            // Only run if Admin building is active
            if (!document.getElementById('admin-building-content').classList.contains('active')) {
                console.log('Admin updateSpaceQuantity called but Admin building not active, ignoring');
                return;
            }
            
            const newQty = parseInt(value);
            quantities[id] = newQty;
            document.getElementById(`qty-${id}`).textContent = value;
            
            // If we're in floor mode, update floor distribution only if all floors are zero
            if (assignByFloor) {
                // Only redistribute if all floor quantities are zero (preserve existing distributions)
                if (floorQuantities[id].every(qty => qty === 0)) {
                if (newQty > 0) {
                    const qtyPerFloor = Math.floor(newQty / 4);
                    const remainder = newQty % 4;
                    
                    floorQuantities[id] = [
                        qtyPerFloor + (remainder > 0 ? 1 : 0),
                        qtyPerFloor + (remainder > 1 ? 1 : 0),
                        qtyPerFloor + (remainder > 2 ? 1 : 0),
                        qtyPerFloor
                    ];
                } else {
                    floorQuantities[id] = [0, 0, 0, 0];
                    }
                } else {
                    // If there are existing floor quantities, just update the total to match
                    const currentTotal = floorQuantities[id].reduce((a, b) => a + b, 0);
                    if (currentTotal !== newQty) {
                        // Adjust the first floor to match the new total
                        const difference = newQty - currentTotal;
                        floorQuantities[id][0] = Math.max(0, floorQuantities[id][0] + difference);
                    }
                }
                // Re-render to update floor inputs
                renderSpaceTypes();
            }
            
            updateSpaceCalculations();
            updateBuildingComparison();
        }

        function updateFloorQuantity(type, floorIndex, value) {
            // Only run if Admin building is active
            if (!document.getElementById('admin-building-content').classList.contains('active')) {
                console.log('Admin updateFloorQuantity called but Admin building not active, ignoring');
                return;
            }
            
            floorQuantities[type][floorIndex] = parseInt(value) || 0;
            // Update the total quantity display
            const total = floorQuantities[type].reduce((a, b) => a + b, 0);
            document.getElementById(`qty-${type}`).textContent = total;
            
            // Also update the building-wide quantity for consistency
            quantities[type] = total;
            
            updateSpaceCalculations();
            updateBuildingComparison();
        }

        function updateSpaceSF(id, value) {
            const numValue = parseInt(value);
            if (!isNaN(numValue) && numValue > 0) {
                spaceSF[id] = numValue;
                updateSpaceCalculations();
                updateBuildingComparison();
            }
        }

        function updateICCSpaceSF(id, value) {
            const numValue = parseInt(value);
            if (!isNaN(numValue) && numValue > 0) {
                iccSpaceSF[id] = numValue;
                updateICCSpaceCalculations();
                updateICCBuildingTotals();
                updateICCCategoryTotals();
                updateBuildingComparison();
            }
        }

        function updateHotelSpaceSF(id, value) {
            const numValue = parseInt(value);
            if (!isNaN(numValue) && numValue > 0) {
                hotelSpaceSF[id] = numValue;
                updateHotelSpaceCalculations();
                updateHotelBuildingTotals();
                updateHotelCategoryTotals();
                updateBuildingComparison();
            }
        }

        // ICC Category Toggle Functions
        function toggleICCCategory(category) {
            const content = document.getElementById(`icc${category.charAt(0).toUpperCase() + category.slice(1)}Content`);
            const toggle = document.getElementById(`icc${category.charAt(0).toUpperCase() + category.slice(1)}Toggle`);
            
            if (content && toggle) {
                const isCollapsed = content.style.maxHeight === '0px';
                content.style.maxHeight = isCollapsed ? '1000px' : '0px';
                toggle.textContent = isCollapsed ? 'â–¼' : 'â–¶';
            }
        }

        // Hotel Category Toggle Functions
        function toggleHotelCategory(category) {
            const content = document.getElementById(`hotel${category.charAt(0).toUpperCase() + category.slice(1)}Content`);
            const toggle = document.getElementById(`hotel${category.charAt(0).toUpperCase() + category.slice(1)}Toggle`);
            
            if (content && toggle) {
                const isCollapsed = content.style.maxHeight === '0px';
                content.style.maxHeight = isCollapsed ? '1000px' : '0px';
                toggle.textContent = isCollapsed ? 'â–¼' : 'â–¶';
            }
        }

        // ICC Category Totals Functions
        function updateICCCategoryTotals() {
            // Work Points
            const workPointsSpaces = SPACE_TYPES.filter(t => t.category === 'workPoints');
            let workPointsQty = 0;
            let workPointsSF = 0;
            workPointsSpaces.forEach(space => {
                const qty = iccFloorQuantities[space.id] ? iccFloorQuantities[space.id].reduce((a, b) => a + b, 0) : 0;
                const sf = qty * (iccSpaceSF[space.id] || space.defaultSf);
                workPointsQty += qty;
                workPointsSF += sf;
            });
            const workPointsCountEl = document.getElementById('iccWorkPointsCount');
            const workPointsSubtotalEl = document.getElementById('iccWorkPointsSubtotal');
            if (workPointsCountEl) workPointsCountEl.textContent = `${workPointsQty} ${workPointsQty === 1 ? 'space' : 'spaces'}`;
            if (workPointsSubtotalEl) workPointsSubtotalEl.textContent = `${workPointsSF.toLocaleString()} SF`;
            
            // Collaboration Points
            const collabPointsSpaces = SPACE_TYPES.filter(t => t.category === 'collaborationPoints');
            let collabPointsQty = 0;
            let collabPointsSF = 0;
            collabPointsSpaces.forEach(space => {
                const qty = iccFloorQuantities[space.id] ? iccFloorQuantities[space.id].reduce((a, b) => a + b, 0) : 0;
                const sf = qty * (iccSpaceSF[space.id] || space.defaultSf);
                collabPointsQty += qty;
                collabPointsSF += sf;
            });
            const collabPointsCountEl = document.getElementById('iccCollaborationPointsCount');
            const collabPointsSubtotalEl = document.getElementById('iccCollaborationPointsSubtotal');
            if (collabPointsCountEl) collabPointsCountEl.textContent = `${collabPointsQty} ${collabPointsQty === 1 ? 'space' : 'spaces'}`;
            if (collabPointsSubtotalEl) collabPointsSubtotalEl.textContent = `${collabPointsSF.toLocaleString()} SF`;
            
            // Other Spaces - include ICC Other Spaces (Art, Data Center, Other support) + custom spaces
            let otherSF = 25831; // ICC Other Spaces (Art, Data Center, Other support)
            iccCustomSpaces.forEach(space => {
                otherSF += space.sf * space.quantity;
            });
            const otherSubtotalEl = document.getElementById('iccOtherSubtotal');
            if (otherSubtotalEl) otherSubtotalEl.textContent = `${otherSF.toLocaleString()} SF`;
            
            // Update header/sticky header subcategory counts
            const deskCount = iccFloorQuantities['cubicalDesk'] ? iccFloorQuantities['cubicalDesk'].reduce((a, b) => a + b, 0) : 0;
            const officeCount = iccFloorQuantities['office'] ? iccFloorQuantities['office'].reduce((a, b) => a + b, 0) : 0;
            const confCount = iccFloorQuantities['conferenceRoom'] ? iccFloorQuantities['conferenceRoom'].reduce((a, b) => a + b, 0) : 0;
            const huddleCount = iccFloorQuantities['huddleShelter'] ? iccFloorQuantities['huddleShelter'].reduce((a, b) => a + b, 0) : 0;
            
            const headerDeskEl = document.getElementById('iccHeaderDeskCount');
            const headerOfficeEl = document.getElementById('iccHeaderOfficeCount');
            const headerConfEl = document.getElementById('iccHeaderConfCount');
            const headerHuddleEl = document.getElementById('iccHeaderHuddleCount');
            
            if (headerDeskEl) headerDeskEl.textContent = deskCount;
            if (headerOfficeEl) headerOfficeEl.textContent = officeCount;
            if (headerConfEl) headerConfEl.textContent = confCount;
            if (headerHuddleEl) headerHuddleEl.textContent = huddleCount;
            
            // Update planned condition subcategory counts
            const plannedDeskEl = document.getElementById('iccPlannedDeskCount');
            const plannedOfficeEl = document.getElementById('iccPlannedOfficeCount');
            const plannedConfEl = document.getElementById('iccPlannedConfCount');
            const plannedHuddleEl = document.getElementById('iccPlannedHuddleCount');
            
            if (plannedDeskEl) plannedDeskEl.textContent = deskCount;
            if (plannedOfficeEl) plannedOfficeEl.textContent = officeCount;
            if (plannedConfEl) plannedConfEl.textContent = confCount;
            if (plannedHuddleEl) plannedHuddleEl.textContent = huddleCount;
            
            // Update planned totals
            const plannedWorkPointsEl = document.getElementById('iccPlannedWorkPoints');
            const plannedCollabPointsEl = document.getElementById('iccPlannedCollabPoints');
            
            if (plannedWorkPointsEl) plannedWorkPointsEl.textContent = `${workPointsQty} ${workPointsQty === 1 ? 'space' : 'spaces'}`;
            if (plannedCollabPointsEl) plannedCollabPointsEl.textContent = `${collabPointsQty} ${collabPointsQty === 1 ? 'space' : 'spaces'}`;
        }

        // Hotel Category Totals Functions
        function updateHotelCategoryTotals() {
            // Work Points
            const workPointsSpaces = SPACE_TYPES.filter(t => t.category === 'workPoints');
            let workPointsQty = 0;
            let workPointsSF = 0;
            workPointsSpaces.forEach(space => {
                const qty = hotelFloorQuantities[space.id] ? hotelFloorQuantities[space.id].reduce((a, b) => a + b, 0) : 0;
                const sf = qty * (hotelSpaceSF[space.id] || space.defaultSf);
                workPointsQty += qty;
                workPointsSF += sf;
            });
            const workPointsCountEl = document.getElementById('hotelWorkPointsCount');
            const workPointsSubtotalEl = document.getElementById('hotelWorkPointsSubtotal');
            if (workPointsCountEl) workPointsCountEl.textContent = `${workPointsQty} ${workPointsQty === 1 ? 'space' : 'spaces'}`;
            if (workPointsSubtotalEl) workPointsSubtotalEl.textContent = `${workPointsSF.toLocaleString()} SF`;
            
            // Collaboration Points
            const collabPointsSpaces = SPACE_TYPES.filter(t => t.category === 'collaborationPoints');
            let collabPointsQty = 0;
            let collabPointsSF = 0;
            collabPointsSpaces.forEach(space => {
                const qty = hotelFloorQuantities[space.id] ? hotelFloorQuantities[space.id].reduce((a, b) => a + b, 0) : 0;
                const sf = qty * (hotelSpaceSF[space.id] || space.defaultSf);
                collabPointsQty += qty;
                collabPointsSF += sf;
            });
            const collabPointsCountEl = document.getElementById('hotelCollaborationPointsCount');
            const collabPointsSubtotalEl = document.getElementById('hotelCollaborationPointsSubtotal');
            if (collabPointsCountEl) collabPointsCountEl.textContent = `${collabPointsQty} ${collabPointsQty === 1 ? 'space' : 'spaces'}`;
            if (collabPointsSubtotalEl) collabPointsSubtotalEl.textContent = `${collabPointsSF.toLocaleString()} SF`;
            
            // Other Spaces
            const otherSubtotalEl = document.getElementById('hotelOtherSubtotal');
            if (otherSubtotalEl) otherSubtotalEl.textContent = `0 SF`;
            
            // Update header/sticky header subcategory counts
            const deskCount = hotelFloorQuantities['cubicalDesk'] ? hotelFloorQuantities['cubicalDesk'].reduce((a, b) => a + b, 0) : 0;
            const officeCount = hotelFloorQuantities['office'] ? hotelFloorQuantities['office'].reduce((a, b) => a + b, 0) : 0;
            const confCount = hotelFloorQuantities['conferenceRoom'] ? hotelFloorQuantities['conferenceRoom'].reduce((a, b) => a + b, 0) : 0;
            const huddleCount = hotelFloorQuantities['huddleShelter'] ? hotelFloorQuantities['huddleShelter'].reduce((a, b) => a + b, 0) : 0;
            
            const headerDeskEl = document.getElementById('hotelHeaderDeskCount');
            const headerOfficeEl = document.getElementById('hotelHeaderOfficeCount');
            const headerConfEl = document.getElementById('hotelHeaderConfCount');
            const headerHuddleEl = document.getElementById('hotelHeaderHuddleCount');
            
            if (headerDeskEl) headerDeskEl.textContent = deskCount;
            if (headerOfficeEl) headerOfficeEl.textContent = officeCount;
            if (headerConfEl) headerConfEl.textContent = confCount;
            if (headerHuddleEl) headerHuddleEl.textContent = huddleCount;
            
            // Update planned condition subcategory counts
            const plannedDeskEl = document.getElementById('hotelPlannedDeskCount');
            const plannedOfficeEl = document.getElementById('hotelPlannedOfficeCount');
            const plannedConfEl = document.getElementById('hotelPlannedConfCount');
            const plannedHuddleEl = document.getElementById('hotelPlannedHuddleCount');
            
            if (plannedDeskEl) plannedDeskEl.textContent = deskCount;
            if (plannedOfficeEl) plannedOfficeEl.textContent = officeCount;
            if (plannedConfEl) plannedConfEl.textContent = confCount;
            if (plannedHuddleEl) plannedHuddleEl.textContent = huddleCount;
            
            // Update planned totals
            const plannedWorkPointsEl = document.getElementById('hotelPlannedWorkPoints');
            const plannedCollabPointsEl = document.getElementById('hotelPlannedCollabPoints');
            
            if (plannedWorkPointsEl) plannedWorkPointsEl.textContent = `${workPointsQty} ${workPointsQty === 1 ? 'space' : 'spaces'}`;
            if (plannedCollabPointsEl) plannedCollabPointsEl.textContent = `${collabPointsQty} ${collabPointsQty === 1 ? 'space' : 'spaces'}`;
        }

        function updateSpaceCalculations() {
            // Calculate totals
            const totalGSF = floorSpaces.reduce((sum, floor) => sum + floor, 0);
            
            // Calculate total assignable SF from all floors using existing GSF values
            const existingGSF = [37200, 37100, 37100, 30900]; // Floor 1, 2, 3, 4 existing GSF
            let assignableSF = 0;
            for (let i = 0; i < 4; i++) {
                assignableSF += Math.round(existingGSF[i] * (floorEfficiencies[i] / 100));
            }
            
            const overallEfficiency = totalGSF > 0 ? ((assignableSF / totalGSF) * 100).toFixed(1) : 85;
            
            let usedSF = 0;
            SPACE_TYPES.forEach(type => {
                const sf = spaceSF[type.id] || type.defaultSf;
                let qty = 0;
                
                if (assignByFloor) {
                    // Use floor quantities
                    qty = floorQuantities[type.id] ? floorQuantities[type.id].reduce((a, b) => a + b, 0) : 0;
                } else {
                    // Use building-wide quantities
                    qty = quantities[type.id] || 0;
                }
                
                usedSF += sf * qty;
                
                // Update individual space totals
                const totalEl = document.getElementById(`total-${type.id}`);
                if (totalEl) {
                    totalEl.textContent = (sf * qty).toLocaleString() + ' SF';
                }
            });
            
            customSpaces.forEach(space => {
                usedSF += space.sf * space.quantity;
            });
            
            // Calculate category totals for header
            let workPointsSF = 0;
            let collaborationPointsSF = 0;
            let otherSF = 0;
            let workPointsCount = 0;
            let collaborationPointsCount = 0;
            let otherCount = 0;
            
            SPACE_TYPES.forEach(type => {
                const sf = spaceSF[type.id] || type.defaultSf;
                let qty = 0;
                
                if (assignByFloor) {
                    // Use floor quantities
                    qty = floorQuantities[type.id] ? floorQuantities[type.id].reduce((a, b) => a + b, 0) : 0;
                } else {
                    // Use building-wide quantities
                    qty = quantities[type.id] || 0;
                }
                
                const total = sf * qty;
                
                if (type.category === 'workPoints') {
                    workPointsSF += total;
                    workPointsCount += qty;
                } else if (type.category === 'collaborationPoints') {
                    collaborationPointsSF += total;
                    collaborationPointsCount += qty;
                } else {
                    otherSF += total;
                    otherCount += qty;
                }
            });
            
            // Add custom spaces to "Other"
            customSpaces.forEach(space => {
                otherSF += space.sf * space.quantity;
                otherCount += space.quantity;
            });
            
            // Update space allocation header totals (with null checks for Admin building)
            const totalAssignedSFEl = document.getElementById('totalAssignedSF');
            const totalOfficeSFEl = document.getElementById('totalOfficeSF');
            const totalCollabSFEl = document.getElementById('totalCollabSF');
            const totalOtherSFEl = document.getElementById('totalOtherSF');
            
            if (totalAssignedSFEl) totalAssignedSFEl.textContent = usedSF.toLocaleString();
            if (totalOfficeSFEl) totalOfficeSFEl.textContent = workPointsSF.toLocaleString();
            if (totalCollabSFEl) totalCollabSFEl.textContent = collaborationPointsSF.toLocaleString();
            if (totalOtherSFEl) totalOtherSFEl.textContent = otherSF.toLocaleString();
            
            // Update category subtotals (with null checks)
            const workPointsCountEl = document.getElementById('workPointsCount');
            const workPointsSubtotalEl = document.getElementById('workPointsSubtotal');
            const collaborationPointsCountEl = document.getElementById('collaborationPointsCount');
            const collaborationPointsSubtotalEl = document.getElementById('collaborationPointsSubtotal');
            const otherSubtotalEl = document.getElementById('otherSubtotal');
            
            if (workPointsCountEl) workPointsCountEl.textContent = workPointsCount + (workPointsCount === 1 ? ' space' : ' spaces');
            if (workPointsSubtotalEl) workPointsSubtotalEl.textContent = workPointsSF.toLocaleString() + ' SF';
            if (collaborationPointsCountEl) collaborationPointsCountEl.textContent = collaborationPointsCount + (collaborationPointsCount === 1 ? ' space' : ' spaces');
            if (collaborationPointsSubtotalEl) collaborationPointsSubtotalEl.textContent = collaborationPointsSF.toLocaleString() + ' SF';
            if (otherSubtotalEl) otherSubtotalEl.textContent = otherSF.toLocaleString() + ' SF';
            
            // Update subcategory counts in header
            const deskCount = floorQuantities['cubicalDesk'] ? floorQuantities['cubicalDesk'].reduce((a, b) => a + b, 0) : 0;
            const officeCount = floorQuantities['office'] ? floorQuantities['office'].reduce((a, b) => a + b, 0) : 0;
            const confCount = floorQuantities['conferenceRoom'] ? floorQuantities['conferenceRoom'].reduce((a, b) => a + b, 0) : 0;
            const huddleCount = floorQuantities['huddleShelter'] ? floorQuantities['huddleShelter'].reduce((a, b) => a + b, 0) : 0;
            
            const headerDeskEl = document.getElementById('headerDeskCount');
            const headerOfficeEl = document.getElementById('headerOfficeCount');
            const headerConfEl = document.getElementById('headerConfCount');
            const headerHuddleEl = document.getElementById('headerHuddleCount');
            
            if (headerDeskEl) headerDeskEl.textContent = deskCount;
            if (headerOfficeEl) headerOfficeEl.textContent = officeCount;
            if (headerConfEl) headerConfEl.textContent = confCount;
            if (headerHuddleEl) headerHuddleEl.textContent = huddleCount;
            
            // Update planned condition subcategory counts
            const plannedDeskEl = document.getElementById('plannedDeskCount');
            const plannedOfficeEl = document.getElementById('plannedOfficeCount');
            const plannedConfEl = document.getElementById('plannedConfCount');
            const plannedHuddleEl = document.getElementById('plannedHuddleCount');
            
            if (plannedDeskEl) plannedDeskEl.textContent = deskCount;
            if (plannedOfficeEl) plannedOfficeEl.textContent = officeCount;
            if (plannedConfEl) plannedConfEl.textContent = confCount;
            if (plannedHuddleEl) plannedHuddleEl.textContent = huddleCount;
            
            // Update comparison
            updateComparison(totalGSF, assignableSF, workPointsCount, collaborationPointsCount);
            
            const remainingSF = assignableSF - usedSF;
            const utilizationPercent = (usedSF / assignableSF) * 100;
            
            // Update Remaining SF in header
            const remainingSFEl = document.getElementById('remainingSF');
            if (remainingSFEl) {
                remainingSFEl.textContent = remainingSF.toLocaleString();
            }
            
            // Check for over capacity and show alert
            if (remainingSF < 0) {
                // Show alert
                if (!alertShown) {
                    showCapacityAlert(assignableSF, usedSF, remainingSF);
                    alertShown = true;
                }
            } else {
                alertShown = false;
            }
            
            // Update charts and tables
            updateSpaceCharts();
            updateCategorySummary();
            updateDetailedTable();
            if (typeof updateAdephiComparisonCharts === 'function') updateAdephiComparisonCharts();
        }

        function toggleSpaceAllocation() {
            const content = document.getElementById('spaceAllocationContent');
            const toggle = document.getElementById('spaceAllocationToggle');
            
            if (content.style.maxHeight === '0px') {
                // Expand
                content.style.maxHeight = '3000px';
                toggle.textContent = 'â–¼';
                toggle.style.transform = 'rotate(0deg)';
                
                // Initialize space planning when first opened
                initializeSpacePlanning();
                
                // Update charts after a short delay to ensure DOM is ready
                setTimeout(() => {
                    updateSpaceCharts();
                }, 100);
            } else {
                // Collapse
                content.style.maxHeight = '0px';
                toggle.textContent = 'â–¶';
                toggle.style.transform = 'rotate(-90deg)';
            }
        }

        function toggleCategory(category) {
            const content = document.getElementById(`${category}Content`);
            const toggle = document.getElementById(`${category}Toggle`);
            
            if (content.style.maxHeight === '0px') {
                // Expand
                if (category === 'workstation') content.style.maxHeight = '500px';
                else if (category === 'office') content.style.maxHeight = '1000px';
                else if (category === 'collab') content.style.maxHeight = '1000px';
                else if (category === 'other') content.style.maxHeight = '1500px';
                toggle.textContent = 'â–¼';
                toggle.style.transform = 'rotate(0deg)';
            } else {
                // Collapse
                content.style.maxHeight = '0px';
                toggle.textContent = 'â–¶';
                toggle.style.transform = 'rotate(-90deg)';
            }
        }

        function toggleExistingData() {
            showExisting = document.getElementById('showExistingToggle').checked;
            renderSpaceTypes();
        }

        function switchBuilding(buildingType) {
            console.log('=== SWITCHING TO BUILDING:', buildingType, '===');
            
            // Hide all building contents AGGRESSIVELY
            const allContents = document.querySelectorAll('.building-content');
            console.log('Found building contents:', allContents.length);
            allContents.forEach(content => {
                content.classList.remove('active');
                content.style.cssText = 'display: none !important; visibility: hidden !important; pointer-events: none !important; position: absolute !important; top: -99999px !important; left: -99999px !important; z-index: -9999 !important;';
                console.log('Hiding:', content.id);
            });
            
            // Remove active class from all building tab buttons
            const allButtons = document.querySelectorAll('.building-tab-button');
            allButtons.forEach(button => {
                button.classList.remove('active');
            });
            
            // Show selected building content AGGRESSIVELY
            const selectedContent = document.getElementById(`${buildingType}-building-content`);
            if (selectedContent) {
                selectedContent.classList.add('active');
                selectedContent.style.cssText = 'display: block !important; visibility: visible !important; pointer-events: auto !important; position: relative !important; top: auto !important; left: auto !important; z-index: 1 !important; opacity: 1 !important;';
                console.log('Showing:', selectedContent.id);
                
                // Update the building title based on the selected building
                const titleElement = selectedContent.querySelector('.space-title h2');
                if (titleElement) {
                    const buildingNames = {
                        'admin': 'Admin Building',
                        'icc': 'ICC Building', 
                        'hotel': 'Hotel Building',
                        'comparison': 'Adelphi Campus'
                    };
                    titleElement.textContent = buildingNames[buildingType] || 'Unknown Building';
                    console.log('Updated title to:', titleElement.textContent);
                }
                
                // Debug: Check what floor values are showing
                const floor1Value = selectedContent.querySelector('[id*="Floor1Value"]');
                if (floor1Value) {
                    console.log('Floor 1 value showing:', floor1Value.textContent);
                }
                
                // Ensure space types are rendered when switching to building
                if (buildingType === 'icc') {
                    renderICCSpaceTypes();
                } else if (buildingType === 'hotel') {
                    renderHotelSpaceTypes();
                }
            } else {
                console.log('ERROR: Could not find content for:', buildingType);
            }
            
            // Add active class to selected button
            const selectedButton = document.getElementById(`${buildingType}-building-btn`);
            if (selectedButton) {
                selectedButton.classList.add('active');
            }

            // Update building comparison when switching
            updateBuildingComparison();
            
            // Update building-specific calculations when switching
            if (buildingType === 'admin') {
                updateSpaceCalculations();
            } else if (buildingType === 'icc') {
                updateICCBuildingTotals();
            } else if (buildingType === 'hotel') {
                updateHotelBuildingTotals();
            }
            
            console.log('=== BUILDING SWITCH COMPLETE ===');
        }

        // Generic function to render space types for any building (DEPRECATED - use individual building functions)
        function renderSpaceTypesForBuilding(buildingType) {
            // This function is no longer used - ICC and Hotel use their own rendering functions
            return '';
        }

        // Helper function to generate HTML for a single space type card
        function generateSpaceTypeCard(type, customQuantities, customFloorQuantities, customAssignByFloor, customShowExisting, updateQuantityFunc, updateFloorQuantityFunc, customSpaceSF, updateSpaceSFFunc, buildingPrefix = '', floorLabels = ['Floor 1', 'Floor 2', 'Floor 3', 'Floor 4'], activeFloors = [true, true, true, true], customExistingQuantities = null, customExistingFloorQuantities = null) {
            const existingQty = (customExistingQuantities && customExistingQuantities[type.id]) ? customExistingQuantities[type.id] : (existingQuantities[type.id] || 0);
            const existingSF = type.defaultSf;
            const existingTotal = existingQty * existingSF;
            const currentQty = customQuantities[type.id] || 0;
            
            if (customAssignByFloor && type.category !== 'otherSpaces') {
                // Floor-by-floor assignment
                // Build floor inputs HTML
                let floorInputsHTML = '';
                activeFloors.forEach((isActive, idx) => {
                    if (isActive) {
                        floorInputsHTML += `
                            <div class="space-input-group">
                                <label class="space-input-label">${floorLabels[idx]}</label>
                                <input type="number" class="space-input" value="${customFloorQuantities[type.id][idx] || 0}" 
                                       onchange="${updateFloorQuantityFunc}('${type.id}', ${idx}, this.value)" min="0" style="max-width: 60px; width: 60px;">
                            </div>`;
                    }
                });
                
                // Build existing floor display HTML
                let existingFloorsHTML = '';
                activeFloors.forEach((isActive, idx) => {
                    if (isActive) {
                        const shortLabel = floorLabels[idx].replace('Floor ', 'F').replace('Basement', 'B').replace('3rd Floor', '3F').replace('1st Floor', '1F');
                        const existingFloorQty = (customExistingFloorQuantities && customExistingFloorQuantities[type.id]) ? (customExistingFloorQuantities[type.id][idx] || 0) : (existingFloorQuantities[type.id][idx] || 0);
                        existingFloorsHTML += `
                            <div>
                                <div style="color: var(--umgc-text-light); font-weight: 600;">${shortLabel}</div>
                                <div style="color: var(--umgc-navy); font-weight: 700;">${existingFloorQty}</div>
                            </div>`;
                    }
                });
                
                return `
                <div class="space-type-card">
                    <div class="space-type-header">
                        <div class="space-type-name">${type.name}</div>
                        <div class="space-type-color" style="background-color: ${type.color}"></div>
                    </div>
                    ${customShowExisting ? `
                    <div style="margin-bottom: 8px;">
                        <div style="font-size: 0.7rem; font-weight: 600; color: var(--umgc-text-light); margin-bottom: 3px;">EXISTING</div>
                        <div style="display: grid; grid-template-columns: repeat(${activeFloors.filter(f => f).length}, 1fr); gap: 4px; font-size: 0.65rem;">
                            ${existingFloorsHTML}
                        </div>
                        <div style="margin-top: 4px; text-align: center; font-size: 0.65rem; color: var(--umgc-text-light);">
                            Total: ${existingQty} units
                        </div>
                    </div>
                    ` : ''}
                    <div style="margin-bottom: 6px;">
                        ${customShowExisting ? '<div style="font-size: 0.7rem; font-weight: 600; color: var(--umgc-text-light); margin-bottom: 3px;">PLANNED BY FLOOR</div>' : ''}
                        <div class="space-input-group" style="margin-bottom: 8px;">
                            <label class="space-input-label">SF per Unit</label>
                            <input type="number" class="space-input" value="${customSpaceSF[type.id] || type.defaultSf}" 
                                   onchange="${updateSpaceSFFunc}('${type.id}', this.value)" min="1" style="max-width: 100px; width: 100px;">
                        </div>
                        <div class="space-type-inputs">
                            ${floorInputsHTML}
                        </div>
                        <div style="text-align: center; font-size: 0.75rem; color: var(--umgc-navy); font-weight: 600; margin-top: 4px;">
                            Total: <span id="qty-${type.id}">${customFloorQuantities[type.id].reduce((a, b) => a + b, 0)}</span> units
                        </div>
                        <div class="space-type-total">
                            <span class="space-total-label">Total SF:</span>
                            <span class="space-total-value" id="${buildingPrefix}total-${type.id}">0 SF</span>
                        </div>
                    </div>
                </div>
                `;
            } else {
                // Building-wide assignment
                return `
                <div class="space-type-card">
                    <div class="space-type-header">
                        <div class="space-type-name">${type.name}</div>
                        <div class="space-type-color" style="background-color: ${type.color}"></div>
                    </div>
                    ${customShowExisting ? `
                    <div style="margin-bottom: 8px;">
                        <div style="font-size: 0.7rem; font-weight: 600; color: var(--umgc-text-light); margin-bottom: 3px;">EXISTING</div>
                        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 4px; font-size: 0.7rem;">
                            <div>
                                <div style="color: var(--umgc-text-light); font-weight: 600;">Qty</div>
                                <div style="color: var(--umgc-navy); font-weight: 700;">${existingQty}</div>
                            </div>
                            <div>
                                <div style="color: var(--umgc-text-light); font-weight: 600;">SF</div>
                                <div style="color: var(--umgc-navy); font-weight: 700;">${existingSF}</div>
                            </div>
                            <div>
                                <div style="color: var(--umgc-text-light); font-weight: 600;">Total</div>
                                <div style="color: var(--umgc-navy); font-weight: 700;">${existingTotal.toLocaleString()}</div>
                            </div>
                        </div>
                    </div>
                    ` : ''}
                    <div style="margin-bottom: 6px;">
                        ${customShowExisting ? '<div style="font-size: 0.7rem; font-weight: 600; color: var(--umgc-text-light); margin-bottom: 3px;">PLANNED</div>' : ''}
                        <div class="space-type-inputs">
                            <div class="space-input-group">
                                <label class="space-input-label">SF per Unit</label>
                                <input type="number" class="space-input" value="${customSpaceSF[type.id] || type.defaultSf}" 
                                       onchange="${updateSpaceSFFunc}('${type.id}', this.value)" min="1">
                            </div>
                            <div class="space-input-group" style="flex: 1.5;">
                                <label class="space-input-label">Qty</label>
                                <input type="range" class="slider" min="0" max="100" value="${currentQty}" 
                                       step="1" oninput="${updateQuantityFunc}('${type.id}', this.value)">
                            </div>
                        </div>
                        <div class="space-type-total">
                            <span class="space-total-label">Total SF:</span>
                            <span class="space-total-value" id="${buildingPrefix}total-${type.id}">0 SF</span>
                        </div>
                    </div>
                </div>
                `;
            }
        }

        // ICC Building Functions (render same space types as Admin)
        function renderICCSpaceTypes() {
            const iccFloorLabels = ['Basement', 'Floor 2', '3rd Floor', 'Floor 4'];
            const iccActiveFloors = [true, false, true, false]; // Only Basement and 3rd Floor
            const iccAlwaysAssignByFloor = true; // ICC always assigns by floor
            
            // Render Work Points
            const workPointsGrid = document.getElementById('iccWorkPointsSpacesGrid');
            if (workPointsGrid) {
                const workPointsSpaces = SPACE_TYPES.filter(t => t.category === 'workPoints');
                let html = '';
                workPointsSpaces.forEach(space => {
                    html += generateSpaceTypeCard(space, iccQuantities, iccFloorQuantities, iccAlwaysAssignByFloor, iccShowExisting, 'updateICCSpaceQuantity', 'updateICCFloorQuantity', iccSpaceSF, 'updateICCSpaceSF', 'icc-', iccFloorLabels, iccActiveFloors, iccExistingQuantities, iccExistingFloorQuantities);
                });
                workPointsGrid.innerHTML = html;
            }
            
            // Render Collaboration Points
            const collabPointsGrid = document.getElementById('iccCollaborationPointsSpacesGrid');
            if (collabPointsGrid) {
                const collabPointsSpaces = SPACE_TYPES.filter(t => t.category === 'collaborationPoints');
                let html = '';
                collabPointsSpaces.forEach(space => {
                    html += generateSpaceTypeCard(space, iccQuantities, iccFloorQuantities, iccAlwaysAssignByFloor, iccShowExisting, 'updateICCSpaceQuantity', 'updateICCFloorQuantity', iccSpaceSF, 'updateICCSpaceSF', 'icc-', iccFloorLabels, iccActiveFloors, iccExistingQuantities, iccExistingFloorQuantities);
                });
                collabPointsGrid.innerHTML = html;
            }
            
            // Render Other Spaces - include ICC Other Spaces (Art, Data Center, Other support)
            const otherGrid = document.getElementById('iccOtherSpacesGrid');
            if (otherGrid) {
                let html = '';
                
                // Add ICC Other Spaces (Art, Data Center, Other support) - 25,831 SF
                html += `
                    <div class="space-type-card" style="position: relative;">
                        <div class="space-type-header">
                            <div class="space-type-name">Art, Data Center, Other support</div>
                            <div class="space-type-color" style="background-color: hsl(280, 65%, 70%);"></div>
                        </div>
                        <div class="space-type-total">
                            <span class="space-total-label">Total SF:</span>
                            <span class="space-total-value">25,831 SF</span>
                        </div>
                    </div>
                `;
                
                otherGrid.innerHTML = html;
            }
            
            updateICCBuildingTotals();
            updateICCCategoryTotals();
            updateICCSpaceCalculations();
        }

        function updateICCSpaceCalculations() {
            // Update individual space type totals
            SPACE_TYPES.forEach(type => {
                const sf = iccSpaceSF[type.id] || type.defaultSf;
                // ICC always uses floor quantities
                const qty = iccFloorQuantities[type.id] ? iccFloorQuantities[type.id].reduce((a, b) => a + b, 0) : 0;
                
                // Update individual space totals
                const totalEl = document.getElementById(`icc-total-${type.id}`);
                if (totalEl) {
                    totalEl.textContent = (sf * qty).toLocaleString() + ' SF';
                }
            });
        }

        function updateICCSpaceQuantity(id, value) {
            const newQty = parseInt(value);
            iccQuantities[id] = newQty;
            
            // ICC always assigns by floor, so redistribute to floors
            if (newQty > 0) {
                // Distribute between Basement and 3rd Floor only (active floors)
                const qtyPerFloor = Math.floor(newQty / 2);
                const remainder = newQty % 2;
                
                iccFloorQuantities[id] = [
                    qtyPerFloor + (remainder > 0 ? 1 : 0), // Basement
                    0, // Floor 2 (inactive)
                    qtyPerFloor, // 3rd Floor
                    0  // Floor 4 (inactive)
                ];
            } else {
                iccFloorQuantities[id] = [0, 0, 0, 0];
            }
            
            renderICCSpaceTypes();
            updateICCSpaceCalculations();
            updateICCBuildingTotals();
            updateICCCategoryTotals();
            updateBuildingComparison();
        }

        function updateICCFloorQuantity(type, floorIndex, value) {
            iccFloorQuantities[type][floorIndex] = parseInt(value) || 0;
            // Only sum active floors (Basement and 3rd Floor)
            const total = iccFloorQuantities[type][0] + iccFloorQuantities[type][2];
            iccQuantities[type] = total;
            updateICCSpaceCalculations();
            updateICCBuildingTotals();
            updateICCCategoryTotals();
            updateBuildingComparison();
        }

        function updateICCFloor(floorNum, value) {
            console.log('ICC updateICCFloor called with floor:', floorNum, 'value:', value);
            const floorValue = parseInt(value);
            iccFloorSpaces[floorNum - 1] = floorValue;
            document.getElementById(`iccFloor${floorNum}Value`).textContent = floorValue.toLocaleString();
            
            // Update assignable SF based on efficiency
            const efficiency = iccFloorEfficiencies[floorNum - 1] / 100;
            const assignable = Math.round(floorValue * efficiency);
            document.getElementById(`iccFloor${floorNum}Assignable`).textContent = assignable.toLocaleString();
            
            updateICCBuildingTotals();
            updateBuildingComparison();
        }

        function updateICCFloorEfficiency(floorNum, value) {
            const efficiencyValue = parseInt(value);
            iccFloorEfficiencies[floorNum - 1] = efficiencyValue;
            document.getElementById(`iccFloor${floorNum}EffValue`).textContent = efficiencyValue + '%';
            
            // Update assignable SF using existing GSF values
            const existingGSF = [0, 0, 19900, 0]; // Only 3rd floor has GSF
            const assignable = Math.round(existingGSF[floorNum - 1] * (efficiencyValue / 100));
            document.getElementById(`iccFloor${floorNum}Assignable`).textContent = assignable.toLocaleString();
            
            updateICCBuildingTotals();
            updateBuildingComparison();
        }


        function toggleICCSpaceAllocation() {
            const content = document.getElementById('iccSpaceAllocationContent');
            const toggle = document.getElementById('iccSpaceAllocationToggle');
            
            if (content.style.maxHeight && content.style.maxHeight !== '0px') {
                content.style.maxHeight = '0px';
                toggle.textContent = 'â–¶';
                toggle.style.transform = 'rotate(-90deg)';
            } else {
                content.style.maxHeight = '3000px';
                toggle.textContent = 'â–¼';
                toggle.style.transform = 'rotate(0deg)';
            }
        }

        function toggleICCExistingData() {
            iccShowExisting = document.getElementById('iccShowExistingToggle').checked;
            renderICCSpaceTypes();
        }

        function toggleICCFloorAssignment() {
            const wasFloorMode = iccAssignByFloor;
            iccAssignByFloor = document.getElementById('iccAssignByFloorToggle').checked;
            
            if (iccAssignByFloor && !wasFloorMode) {
                // Switching TO floor mode: preserve existing distributions if they exist
                SPACE_TYPES.forEach(type => {
                    // Only distribute equally if floor quantities are all zeros
                    if (iccFloorQuantities[type.id].every(qty => qty === 0)) {
                    const buildingQty = iccQuantities[type.id] || 0;
                    if (buildingQty > 0) {
                        const qtyPerFloor = Math.floor(buildingQty / 2);
                        const remainder = buildingQty % 2;
                        
                        iccFloorQuantities[type.id] = [
                            qtyPerFloor + (remainder > 0 ? 1 : 0),
                            qtyPerFloor,
                            0,
                            0
                        ];
                    } else {
                        iccFloorQuantities[type.id] = [0, 0, 0, 0];
                        }
                    }
                });
            } else if (!iccAssignByFloor && wasFloorMode) {
                // Switching FROM floor mode: sum floor quantities back to building total
                SPACE_TYPES.forEach(type => {
                    const floorTotal = iccFloorQuantities[type.id] ? 
                        iccFloorQuantities[type.id].slice(0, 2).reduce((a, b) => a + b, 0) : 0;
                    iccQuantities[type.id] = floorTotal;
                });
            }
            
            renderICCSpaceTypes();
            updateICCBuildingTotals();
        }

        function toggleICCExistingData() {
            iccShowExisting = document.getElementById('iccShowExistingToggle').checked;
            renderICCSpaceTypes();
        }

        function toggleICCFloorAssignment() {
            const wasFloorMode = iccAssignByFloor;
            iccAssignByFloor = document.getElementById('iccAssignByFloorToggle').checked;
            
            if (iccAssignByFloor && !wasFloorMode) {
                // Switching TO floor mode: preserve existing distributions if they exist
                SPACE_TYPES.forEach(type => {
                    // Only distribute equally if floor quantities are all zeros
                    if (iccFloorQuantities[type.id].every(qty => qty === 0)) {
                    const buildingQty = iccQuantities[type.id] || 0;
                    if (buildingQty > 0) {
                        const qtyPerFloor = Math.floor(buildingQty / 2);
                        const remainder = buildingQty % 2;
                        
                        iccFloorQuantities[type.id] = [
                            qtyPerFloor + (remainder > 0 ? 1 : 0),
                            qtyPerFloor,
                            0,
                            0
                        ];
                    } else {
                        iccFloorQuantities[type.id] = [0, 0, 0, 0];
                        }
                    }
                });
            } else if (!iccAssignByFloor && wasFloorMode) {
                // Switching FROM floor mode: sum floor quantities back to building total
                SPACE_TYPES.forEach(type => {
                    const floorTotal = iccFloorQuantities[type.id] ? 
                        iccFloorQuantities[type.id].slice(0, 2).reduce((a, b) => a + b, 0) : 0;
                    iccQuantities[type.id] = floorTotal;
                });
            }
            
            renderICCSpaceTypes();
            updateICCBuildingTotals();
        }

        function updateICCBuildingTotals() {
            // Calculate totals: Basement (fixed ASF) + 3rd Floor (GSF * efficiency)
            const totalAssignable = iccFloorSpaces.reduce((sum, sf, index) => {
                return sum + Math.round(sf * (iccFloorEfficiencies[index] / 100));
            }, 0);
            
            // Calculate space allocation totals
            let usedSF = 0;
            let workPointsSF = 0;
            let collaborationPointsSF = 0;
            let otherSF = 0;
            let workPointsCount = 0;
            let collaborationPointsCount = 0;
            let otherCount = 0;
            
            SPACE_TYPES.forEach(type => {
                // Use floor quantities since ICC always assigns by floor
                const qty = iccFloorQuantities[type.id] ? iccFloorQuantities[type.id].reduce((a, b) => a + b, 0) : 0;
                const sfPerUnit = iccSpaceSF[type.id] || type.defaultSf;
                const totalSF = qty * sfPerUnit;
                usedSF += totalSF;
                
                if (type.category === 'workPoints') {
                    workPointsSF += totalSF;
                    workPointsCount += qty;
                }
                if (type.category === 'collaborationPoints') {
                    collaborationPointsSF += totalSF;
                    collaborationPointsCount += qty;
                }
                if (type.category === 'other') {
                    otherSF += totalSF;
                    otherCount += qty;
                }
            });
            
            // Add ICC custom spaces
            iccCustomSpaces.forEach(space => {
                const totalSF = space.sf * space.quantity;
                usedSF += totalSF;
                otherSF += totalSF;
                otherCount += space.quantity;
            });
            
            // Add ICC Other Spaces (Art, Data Center, Other support) - 25,831 SF
            const iccOtherSpacesSF = 25831;
            usedSF += iccOtherSpacesSF;
            otherSF += iccOtherSpacesSF;
            
            
            // Update space allocation header
            const iccTotalAssignedSFEl = document.getElementById('iccTotalAssignedSF');
            const iccTotalOfficeSFEl = document.getElementById('iccTotalOfficeSF');
            const iccTotalCollabSFEl = document.getElementById('iccTotalCollabSF');
            const iccTotalOtherSFEl = document.getElementById('iccTotalOtherSF');
            
            if (iccTotalAssignedSFEl) iccTotalAssignedSFEl.textContent = usedSF.toLocaleString();
            if (iccTotalOfficeSFEl) iccTotalOfficeSFEl.textContent = workPointsSF.toLocaleString();
            if (iccTotalCollabSFEl) iccTotalCollabSFEl.textContent = collaborationPointsSF.toLocaleString();
            if (iccTotalOtherSFEl) iccTotalOtherSFEl.textContent = otherSF.toLocaleString();
            
            // Update building parameters header
            const iccBuildingTotalGSFEl = document.getElementById('iccBuildingTotalGSF');
            const iccBuildingTotalAssignableEl = document.getElementById('iccBuildingTotalAssignable');
            const iccBuildingEfficiencyEl = document.getElementById('iccBuildingEfficiency');
            
            // Calculate ICC Total GSF
            const iccTotalGSF = iccFloorSpaces.reduce((sum, sf) => sum + sf, 0);
            const iccEfficiency = iccTotalGSF > 0 ? Math.round((totalAssignable / iccTotalGSF) * 100) : 0;
            
            if (iccBuildingTotalGSFEl) iccBuildingTotalGSFEl.textContent = iccTotalGSF.toLocaleString();
            if (iccBuildingTotalAssignableEl) iccBuildingTotalAssignableEl.textContent = totalAssignable.toLocaleString();
            if (iccBuildingEfficiencyEl) iccBuildingEfficiencyEl.textContent = iccEfficiency + '%';
            
            // Update remaining SF in sticky header
            const remainingSF = totalAssignable - usedSF;
            const iccRemainingSFEl = document.getElementById('iccRemainingSF');
            if (iccRemainingSFEl) iccRemainingSFEl.textContent = remainingSF.toLocaleString();
            
            // Update ICC comparison header (sticky header deltas)
            updateICCComparison(0, totalAssignable, workPointsCount, collaborationPointsCount);
        }

        function updateICCComparison(totalGSF, assignableSF, workPointsCount, collaborationPointsCount) {
            // Existing conditions for ICC (17 desks @ 60 SF + 49 offices @ 140 SF + 7 conf rooms @ 330 SF = 9,170 SF)
            const existingAssignable = 36021; // 20,300 (Basement) + 15,721 (3rd Floor @ 79%)
            const existingWorkPoints = 66; // 17 desks + 49 offices
            const existingCollaborationPoints = 7; // 7 conference rooms
            
            // Calculate deltas
            const deltaAssignableVal = assignableSF - existingAssignable;
            const deltaWorkPointsVal = workPointsCount - existingWorkPoints;
            const deltaCollaborationPointsVal = collaborationPointsCount - existingCollaborationPoints;
            
            // Format delta values with +/- sign
            const formatDelta = (val) => (val >= 0 ? '+' : '') + val.toLocaleString();
            
            // Update delta values in sticky header
            const deltaGSFEl = document.getElementById('iccDeltaGSF');
            const deltaWorkstationsEl = document.getElementById('iccDeltaWorkstations');
            const deltaOfficesEl = document.getElementById('iccDeltaOffices');
            
            if (deltaGSFEl) deltaGSFEl.textContent = formatDelta(deltaAssignableVal);
            if (deltaWorkstationsEl) deltaWorkstationsEl.textContent = formatDelta(deltaWorkPointsVal);
            if (deltaOfficesEl) deltaOfficesEl.textContent = formatDelta(deltaCollaborationPointsVal);
            
            // Update ICC comparison cards (Planned Conditions)
            const iccPlannedAssignableEl = document.getElementById('iccPlannedAssignable');
            const iccPlannedWorkstationEl = document.getElementById('iccPlannedWorkstation');
            const iccPlannedOfficeEl = document.getElementById('iccPlannedOffice');
            const iccPlannedCollabEl = document.getElementById('iccPlannedCollab');
            const iccPlannedSeatsEl = document.getElementById('iccPlannedSeats');
            
            if (iccPlannedAssignableEl) iccPlannedAssignableEl.textContent = assignableSF.toLocaleString();
            if (iccPlannedWorkstationEl) iccPlannedWorkstationEl.textContent = workPointsCount + ' spaces';
            if (iccPlannedOfficeEl) iccPlannedOfficeEl.textContent = workPointsCount + ' spaces';
            if (iccPlannedCollabEl) iccPlannedCollabEl.textContent = collaborationPointsCount + ' spaces';
            if (iccPlannedSeatsEl) iccPlannedSeatsEl.textContent = collaborationPointsCount + ' seats';
        }

        // Hotel Building Functions (render same space types as Admin)
        function renderHotelSpaceTypes() {
            const hotelFloorLabels = ['1st Floor', 'Floor 2', 'Floor 3', 'Floor 4'];
            const hotelActiveFloors = [true, false, false, false]; // Only 1st Floor
            const hotelAlwaysAssignByFloor = true; // Hotel always assigns by floor
            
            // Render Work Points
            const workPointsGrid = document.getElementById('hotelWorkPointsSpacesGrid');
            if (workPointsGrid) {
                const workPointsSpaces = SPACE_TYPES.filter(t => t.category === 'workPoints');
                let html = '';
                workPointsSpaces.forEach(space => {
                    html += generateSpaceTypeCard(space, hotelQuantities, hotelFloorQuantities, hotelAlwaysAssignByFloor, hotelShowExisting, 'updateHotelSpaceQuantity', 'updateHotelFloorQuantity', hotelSpaceSF, 'updateHotelSpaceSF', 'hotel-', hotelFloorLabels, hotelActiveFloors, hotelExistingQuantities, hotelExistingFloorQuantities);
                });
                workPointsGrid.innerHTML = html;
            }
            
            // Render Collaboration Points
            const collabPointsGrid = document.getElementById('hotelCollaborationPointsSpacesGrid');
            if (collabPointsGrid) {
                const collabPointsSpaces = SPACE_TYPES.filter(t => t.category === 'collaborationPoints');
                let html = '';
                collabPointsSpaces.forEach(space => {
                    html += generateSpaceTypeCard(space, hotelQuantities, hotelFloorQuantities, hotelAlwaysAssignByFloor, hotelShowExisting, 'updateHotelSpaceQuantity', 'updateHotelFloorQuantity', hotelSpaceSF, 'updateHotelSpaceSF', 'hotel-', hotelFloorLabels, hotelActiveFloors, hotelExistingQuantities, hotelExistingFloorQuantities);
                });
                collabPointsGrid.innerHTML = html;
            }
            
            // Render Other Spaces (empty for now)
            const otherGrid = document.getElementById('hotelOtherSpacesGrid');
            if (otherGrid) {
                otherGrid.innerHTML = '';
            }
            
            updateHotelBuildingTotals();
            updateHotelCategoryTotals();
            updateHotelSpaceCalculations();
        }

        function updateHotelSpaceCalculations() {
            // Update individual space type totals
            SPACE_TYPES.forEach(type => {
                const sf = hotelSpaceSF[type.id] || type.defaultSf;
                let qty = 0;
                
                if (hotelAssignByFloor) {
                    // Use floor quantities
                    qty = hotelFloorQuantities[type.id] ? hotelFloorQuantities[type.id].reduce((a, b) => a + b, 0) : 0;
                } else {
                    // Use building-wide quantities
                    qty = hotelQuantities[type.id] || 0;
                }
                
                // Update individual space totals
                const totalEl = document.getElementById(`hotel-total-${type.id}`);
                if (totalEl) {
                    totalEl.textContent = (sf * qty).toLocaleString() + ' SF';
                }
            });
        }

        function updateHotelSpaceQuantity(id, value) {
            const newQty = parseInt(value);
            hotelQuantities[id] = newQty;
            
            if (hotelAssignByFloor) {
                // Only redistribute if all floor quantities are zero (preserve existing distributions)
                if (hotelFloorQuantities[id].every(qty => qty === 0)) {
                if (newQty > 0) {
                    const qtyPerFloor = Math.floor(newQty / 4); // Hotel has 4 floors
                    const remainder = newQty % 4;
                    
                    hotelFloorQuantities[id] = [
                        qtyPerFloor + (remainder > 0 ? 1 : 0),
                        qtyPerFloor + (remainder > 1 ? 1 : 0),
                        qtyPerFloor + (remainder > 2 ? 1 : 0),
                        qtyPerFloor
                    ];
                } else {
                    hotelFloorQuantities[id] = [0, 0, 0, 0];
                    }
                } else {
                    // If there are existing floor quantities, just update the total to match
                    const currentTotal = hotelFloorQuantities[id].reduce((a, b) => a + b, 0);
                    if (currentTotal !== newQty) {
                        // Adjust the first floor to match the new total
                        const difference = newQty - currentTotal;
                        hotelFloorQuantities[id][0] = Math.max(0, hotelFloorQuantities[id][0] + difference);
                    }
                }
                renderHotelSpaceTypes();
            }
            updateHotelSpaceCalculations();
            updateHotelBuildingTotals();
            updateHotelCategoryTotals();
            updateBuildingComparison();
        }

        function updateHotelFloorQuantity(type, floorIndex, value) {
            hotelFloorQuantities[type][floorIndex] = parseInt(value) || 0;
            const total = hotelFloorQuantities[type].reduce((a, b) => a + b, 0); // All 4 floors
            hotelQuantities[type] = total;
            updateHotelSpaceCalculations();
            updateHotelBuildingTotals();
            updateHotelCategoryTotals();
            updateBuildingComparison();
        }

        function updateHotelFloor(floorNum, value) {
            const floorValue = parseInt(value);
            hotelFloorSpaces[floorNum - 1] = floorValue;
            document.getElementById(`hotelFloor${floorNum}Value`).textContent = floorValue.toLocaleString();
            
            // Update assignable SF based on efficiency
            const efficiency = hotelFloorEfficiencies[floorNum - 1] / 100;
            const assignable = Math.round(floorValue * efficiency);
            document.getElementById(`hotelFloor${floorNum}Assignable`).textContent = assignable.toLocaleString();
            
            updateHotelBuildingTotals();
            updateBuildingComparison();
        }

        function updateHotelFloorEfficiency(floorNum, value) {
            const efficiencyValue = parseInt(value);
            
            // Special case for Hotel Floor 1: display 71% but use 70.8% for calculations
            if (floorNum === 1 && efficiencyValue === 71) {
                hotelFloorEfficiencies[floorNum - 1] = 70.8;
                document.getElementById(`hotelFloor${floorNum}EffValue`).textContent = '71%';
            } else {
                hotelFloorEfficiencies[floorNum - 1] = efficiencyValue;
                document.getElementById(`hotelFloor${floorNum}EffValue`).textContent = efficiencyValue + '%';
            }
            
            // Update assignable SF using existing GSF values
            const existingGSF = [7500, 0, 0, 0]; // Only 1st floor has GSF
            const assignable = Math.round(existingGSF[floorNum - 1] * (hotelFloorEfficiencies[floorNum - 1] / 100));
            document.getElementById(`hotelFloor${floorNum}Assignable`).textContent = assignable.toLocaleString();
            
            updateHotelBuildingTotals();
            updateBuildingComparison();
        }

        function applyHotelBestPracticeEfficiency() {
            // Apply 100% efficiency (best practice - use full space)
            const bestPracticeEfficiency = 100;
            
            // Update slider and efficiency value
            const slider = document.getElementById('hotelFloor1EffSlider');
            const effValueEl = document.getElementById('hotelFloor1EffValue');
            
            if (slider) slider.value = bestPracticeEfficiency;
            if (effValueEl) effValueEl.textContent = bestPracticeEfficiency;
            
            // Update efficiency array
            hotelFloorEfficiencies[0] = bestPracticeEfficiency;
            
            // Update assignable SF display
            const existingGSF = 7500; // 1st floor GSF
            const assignable = Math.round(existingGSF * (bestPracticeEfficiency / 100));
            document.getElementById('hotelFloor1Assignable').textContent = assignable.toLocaleString();
            
            // Update building totals and calculations
            updateHotelBuildingTotals();
            updateBuildingComparison();
            
            // Show success message
            const button = document.getElementById('hotelBestPracticeEfficiencyBtn');
            if (button) {
                const originalText = button.textContent;
                button.textContent = 'Applied!';
                button.style.background = '#c8e6c9';
                button.style.color = '#2e7d32';
                button.style.borderColor = '#4caf50';
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '#e3f2fd';
                    button.style.color = '#1976d2';
                    button.style.borderColor = '#bbdefb';
                }, 2000);
            }
        }

        function resetHotelToExistingConditions() {
            // Reset to existing efficiency (70.8% - displays as 71%)
            const existingEfficiency = 70.8;
            const displayEfficiency = 71;
            
            // Update slider and efficiency value
            const slider = document.getElementById('hotelFloor1EffSlider');
            const effValueEl = document.getElementById('hotelFloor1EffValue');
            
            if (slider) slider.value = displayEfficiency;
            if (effValueEl) effValueEl.textContent = displayEfficiency + '%';
            
            // Update efficiency array
            hotelFloorEfficiencies[0] = existingEfficiency;
            
            // Update assignable SF display
            const existingGSF = 7500; // 1st floor GSF
            const assignable = Math.round(existingGSF * (existingEfficiency / 100));
            document.getElementById('hotelFloor1Assignable').textContent = assignable.toLocaleString();
            
            // Update building totals and calculations
            updateHotelBuildingTotals();
            updateBuildingComparison();
            
            // Show success message
            const button = document.getElementById('hotelResetToExistingBtn');
            if (button) {
                const originalText = button.textContent;
                button.textContent = 'Reset!';
                button.style.background = '#c8e6c9';
                button.style.color = '#2e7d32';
                button.style.borderColor = '#4caf50';
                setTimeout(() => {
                    button.textContent = originalText;
                    button.style.background = '#fff3e0';
                    button.style.color = '#f57c00';
                    button.style.borderColor = '#ffcc02';
                }, 2000);
            }
        }

        function toggleAdminBuildingParams() {
            const content = document.getElementById('buildingParamsContent');
            const toggle = document.getElementById('adminBuildingParamsToggle');
            
            if (content.style.maxHeight && content.style.maxHeight !== '0px') {
                content.style.maxHeight = '0px';
                toggle.textContent = 'â–¶';
                toggle.style.transform = 'rotate(-90deg)';
            } else {
                content.style.maxHeight = '2000px';
                toggle.textContent = 'â–¼';
                toggle.style.transform = 'rotate(0deg)';
            }
        }

        function toggleICCBuildingParams() {
            const content = document.getElementById('iccBuildingParamsContent');
            const toggle = document.getElementById('iccBuildingParamsToggle');
            
            if (content.style.maxHeight && content.style.maxHeight !== '0px') {
                content.style.maxHeight = '0px';
                toggle.textContent = 'â–¶';
                toggle.style.transform = 'rotate(-90deg)';
            } else {
                content.style.maxHeight = '2000px';
                toggle.textContent = 'â–¼';
                toggle.style.transform = 'rotate(0deg)';
            }
        }

        function toggleHotelBuildingParams() {
            const content = document.getElementById('hotelBuildingParamsContent');
            const toggle = document.getElementById('hotelBuildingParamsToggle');
            
            if (content.style.maxHeight && content.style.maxHeight !== '0px') {
                content.style.maxHeight = '0px';
                toggle.textContent = 'â–¶';
                toggle.style.transform = 'rotate(-90deg)';
            } else {
                content.style.maxHeight = '2000px';
                toggle.textContent = 'â–¼';
                toggle.style.transform = 'rotate(0deg)';
            }
        }

        function toggleHotelSpaceAllocation() {
            const content = document.getElementById('hotelSpaceAllocationContent');
            const toggle = document.getElementById('hotelSpaceAllocationToggle');
            
            if (content.style.maxHeight && content.style.maxHeight !== '0px') {
                content.style.maxHeight = '0px';
                toggle.textContent = 'â–¶';
                toggle.style.transform = 'rotate(-90deg)';
            } else {
                content.style.maxHeight = '3000px';
                toggle.textContent = 'â–¼';
                toggle.style.transform = 'rotate(0deg)';
            }
        }

        function toggleHotelExistingData() {
            hotelShowExisting = document.getElementById('hotelShowExistingToggle').checked;
            renderHotelSpaceTypes();
        }

        function toggleHotelFloorAssignment() {
            const wasFloorMode = hotelAssignByFloor;
            hotelAssignByFloor = document.getElementById('hotelAssignByFloorToggle').checked;
            
            if (hotelAssignByFloor && !wasFloorMode) {
                // Switching TO floor mode: preserve existing distributions if they exist
                SPACE_TYPES.forEach(type => {
                    // Only distribute equally if floor quantities are all zeros
                    if (hotelFloorQuantities[type.id].every(qty => qty === 0)) {
                    const buildingQty = hotelQuantities[type.id] || 0;
                    if (buildingQty > 0) {
                        const qtyPerFloor = Math.floor(buildingQty / 2);
                        const remainder = buildingQty % 2;
                        
                        hotelFloorQuantities[type.id] = [
                            qtyPerFloor + (remainder > 0 ? 1 : 0),
                            qtyPerFloor,
                            0,
                            0
                        ];
                    } else {
                        hotelFloorQuantities[type.id] = [0, 0, 0, 0];
                        }
                    }
                });
            } else if (!hotelAssignByFloor && wasFloorMode) {
                // Switching FROM floor mode: sum floor quantities back to building total
                SPACE_TYPES.forEach(type => {
                    const floorTotal = hotelFloorQuantities[type.id] ? 
                        hotelFloorQuantities[type.id].slice(0, 2).reduce((a, b) => a + b, 0) : 0;
                    hotelQuantities[type.id] = floorTotal;
                });
            }
            
            renderHotelSpaceTypes();
            updateHotelBuildingTotals();
        }

        function updateHotelBuildingTotals() {
            // Hotel has fixed ASF with efficiency calculation
            const totalGSF = 7500; // Fixed 1st floor GSF
            const efficiency = hotelFloorEfficiencies[0] || 70.8; // Use 1st floor efficiency
            const totalAssignable = Math.round(totalGSF * (efficiency / 100)); // Calculate assignable SF
            
            // Calculate space allocation totals
            let usedSF = 0;
            let workPointsSF = 0;
            let collaborationPointsSF = 0;
            let otherSF = 0;
            let workPointsCount = 0;
            let collaborationPointsCount = 0;
            let otherCount = 0;
            
            SPACE_TYPES.forEach(type => {
                const qty = hotelQuantities[type.id] || 0; // Use building-wide quantities
                const sfPerUnit = hotelSpaceSF[type.id] || type.defaultSf;
                const totalSF = qty * sfPerUnit;
                usedSF += totalSF;
                
                if (type.category === 'workPoints') {
                    workPointsSF += totalSF;
                    workPointsCount += qty;
                }
                if (type.category === 'collaborationPoints') {
                    collaborationPointsSF += totalSF;
                    collaborationPointsCount += qty;
                }
                if (type.category === 'other') {
                    otherSF += totalSF;
                    otherCount += qty;
                }
            });
            
            // Add Hotel custom spaces
            hotelCustomSpaces.forEach(space => {
                const totalSF = space.sf * space.quantity;
                usedSF += totalSF;
                otherSF += totalSF;
                otherCount += space.quantity;
            });
            
            // Update space allocation header
            const hotelTotalAssignedSFEl = document.getElementById('hotelTotalAssignedSF');
            const hotelTotalOfficeSFEl = document.getElementById('hotelTotalOfficeSF');
            const hotelTotalCollabSFEl = document.getElementById('hotelTotalCollabSF');
            const hotelTotalOtherSFEl = document.getElementById('hotelTotalOtherSF');
            
            if (hotelTotalAssignedSFEl) hotelTotalAssignedSFEl.textContent = usedSF.toLocaleString();
            if (hotelTotalOfficeSFEl) hotelTotalOfficeSFEl.textContent = workPointsSF.toLocaleString();
            if (hotelTotalCollabSFEl) hotelTotalCollabSFEl.textContent = collaborationPointsSF.toLocaleString();
            if (hotelTotalOtherSFEl) hotelTotalOtherSFEl.textContent = otherSF.toLocaleString();
            
            // Update building parameters header
            const hotelBuildingTotalGSFEl = document.getElementById('hotelBuildingTotalGSF');
            const hotelBuildingTotalAssignableEl = document.getElementById('hotelBuildingTotalAssignable');
            const hotelBuildingEfficiencyEl = document.getElementById('hotelBuildingEfficiency');
            
            // Calculate Hotel Total GSF and efficiency
            const hotelTotalGSF = hotelFloorSpaces.reduce((sum, sf) => sum + sf, 0);
            const hotelEfficiency = hotelTotalGSF > 0 ? Math.round((totalAssignable / hotelTotalGSF) * 100) : 0;
            
            if (hotelBuildingTotalGSFEl) hotelBuildingTotalGSFEl.textContent = hotelTotalGSF.toLocaleString();
            if (hotelBuildingTotalAssignableEl) hotelBuildingTotalAssignableEl.textContent = totalAssignable.toLocaleString();
            if (hotelBuildingEfficiencyEl) hotelBuildingEfficiencyEl.textContent = hotelEfficiency + '%';
            
            // Update remaining SF in sticky header
            const remainingSF = totalAssignable - usedSF;
            const hotelRemainingSFEl = document.getElementById('hotelRemainingSF');
            if (hotelRemainingSFEl) hotelRemainingSFEl.textContent = remainingSF.toLocaleString();
            
            // Update Hotel comparison header (sticky header deltas)
            updateHotelComparison(0, totalAssignable, workPointsCount, collaborationPointsCount);
        }

        function updateHotelComparison(totalGSF, assignableSF, workPointsCount, collaborationPointsCount) {
            // Existing conditions for Hotel (7,500 GSF * 70.8% efficiency = 5,310 SF)
            const existingAssignable = 5310;
            const existingWorkPoints = 0; // No existing desks or offices
            const existingCollaborationPoints = 6; // 6 conference rooms
            
            // Calculate deltas
            const deltaAssignableVal = assignableSF - existingAssignable;
            const deltaWorkPointsVal = workPointsCount - existingWorkPoints;
            const deltaCollaborationPointsVal = collaborationPointsCount - existingCollaborationPoints;
            
            // Format delta values with +/- sign
            const formatDelta = (val) => (val >= 0 ? '+' : '') + val.toLocaleString();
            
            // Update delta values in sticky header
            const deltaGSFEl = document.getElementById('hotelDeltaGSF');
            const deltaWorkstationsEl = document.getElementById('hotelDeltaWorkstations');
            const deltaOfficesEl = document.getElementById('hotelDeltaOffices');
            
            if (deltaGSFEl) deltaGSFEl.textContent = formatDelta(deltaAssignableVal);
            if (deltaWorkstationsEl) deltaWorkstationsEl.textContent = formatDelta(deltaWorkPointsVal);
            if (deltaOfficesEl) deltaOfficesEl.textContent = formatDelta(deltaCollaborationPointsVal);
            
            // Update Hotel comparison cards (Planned Conditions)
            const hotelPlannedAssignableEl = document.getElementById('hotelPlannedAssignable');
            
            if (hotelPlannedAssignableEl) hotelPlannedAssignableEl.textContent = assignableSF.toLocaleString();
        }


        // Building Comparison Function
        function updateBuildingComparison() {
            // Calculate Admin Building totals from floor sliders
            const adminTotalGSF = floorSpaces.reduce((a, b) => a + b, 0);
            // Use existing GSF for assignable SF calculation to show proper comparison
            const adminExistingGSF = [37200, 37100, 37100, 30900]; // Floor 1, 2, 3, 4 existing GSF
            const adminAssignableSF = adminExistingGSF.reduce((sum, gsf, index) => {
                return sum + Math.round(gsf * (floorEfficiencies[index] / 100));
            }, 0);
            const adminUsedSF = SPACE_TYPES.reduce((total, type) => {
                const sfPerUnit = spaceSF[type.id] || type.defaultSf;
                return total + (quantities[type.id] || 0) * sfPerUnit;
            }, 0);
            const adminEfficiency = adminTotalGSF > 0 ? Math.round((adminAssignableSF / adminTotalGSF) * 100) : 0;
            
            // Calculate ICC Building totals from floor sliders
            const iccTotalGSF = iccFloorSpaces.reduce((a, b) => a + b, 0);
            // Use existing GSF for assignable SF calculation to show proper comparison
            const iccExistingGSF = [0, 0, 19900, 0]; // ICC Floor 3 existing GSF
            const iccAssignableSF = 20300 + iccExistingGSF.reduce((sum, gsf, index) => {
                return sum + Math.round(gsf * (iccFloorEfficiencies[index] / 100));
            }, 0); // Basement (20,300) + 3rd Floor (dynamic)
            const iccUsedSF = SPACE_TYPES.reduce((total, type) => {
                const sfPerUnit = iccSpaceSF[type.id] || type.defaultSf;
                return total + (iccQuantities[type.id] || 0) * sfPerUnit;
            }, 0) + iccCustomSpaces.reduce((total, space) => total + space.sf * space.quantity, 0) + 25831; // Add ICC Other Spaces (Art, Data Center, Other support)
            const iccEfficiency = iccTotalGSF > 0 ? Math.round((iccAssignableSF / iccTotalGSF) * 100) : 0;
            
            // Calculate Hotel Building totals from floor sliders
            const hotelTotalGSF = hotelFloorSpaces.reduce((a, b) => a + b, 0);
            const hotelAssignableSF = hotelFloorSpaces.reduce((sum, gsf, index) => {
                return sum + Math.round(gsf * (hotelFloorEfficiencies[index] / 100));
            }, 0);
            const hotelUsedSF = SPACE_TYPES.reduce((total, type) => {
                const sfPerUnit = hotelSpaceSF[type.id] || type.defaultSf;
                return total + (hotelQuantities[type.id] || 0) * sfPerUnit;
            }, 0) + hotelCustomSpaces.reduce((total, space) => total + space.sf * space.quantity, 0);
            const hotelEfficiency = hotelTotalGSF > 0 ? Math.round((hotelAssignableSF / hotelTotalGSF) * 100) : 0;
            
            // Calculate combined totals
            const combinedTotalGSF = adminTotalGSF + iccTotalGSF + hotelTotalGSF;
            const combinedAssignableSF = adminAssignableSF + iccAssignableSF + hotelAssignableSF;
            const combinedUsedSF = adminUsedSF + iccUsedSF + hotelUsedSF;
            const combinedEfficiency = combinedTotalGSF > 0 ? Math.round((combinedAssignableSF / combinedTotalGSF) * 100) : 0;
            
            // Update comparison display
            const adminTotalGSFEl = document.getElementById('adminTotalGSF');
            const adminAssignableSFEl = document.getElementById('adminAssignableSF');
            const adminUsedSFEl = document.getElementById('adminUsedSF');
            const adminEfficiencyEl = document.getElementById('adminEfficiency');
            
            if (adminTotalGSFEl) adminTotalGSFEl.textContent = adminTotalGSF.toLocaleString();
            if (adminAssignableSFEl) adminAssignableSFEl.textContent = adminAssignableSF.toLocaleString();
            if (adminUsedSFEl) adminUsedSFEl.textContent = adminUsedSF.toLocaleString();
            if (adminEfficiencyEl) adminEfficiencyEl.textContent = `${adminEfficiency}%`;
            
            const iccTotalGSFEl = document.getElementById('iccTotalGSF');
            const iccAssignableSFEl = document.getElementById('iccAssignableSF');
            const iccUsedSFEl = document.getElementById('iccUsedSF');
            const iccEfficiencyEl = document.getElementById('iccEfficiency');
            
            if (iccTotalGSFEl) iccTotalGSFEl.textContent = iccTotalGSF.toLocaleString();
            if (iccAssignableSFEl) iccAssignableSFEl.textContent = iccAssignableSF.toLocaleString();
            if (iccUsedSFEl) iccUsedSFEl.textContent = iccUsedSF.toLocaleString();
            if (iccEfficiencyEl) iccEfficiencyEl.textContent = `${iccEfficiency}%`;
            
            const hotelTotalGSFEl = document.getElementById('hotelTotalGSF');
            const hotelAssignableSFEl = document.getElementById('hotelAssignableSF');
            const hotelUsedSFEl = document.getElementById('hotelUsedSF');
            const hotelEfficiencyEl = document.getElementById('hotelEfficiency');
            
            if (hotelTotalGSFEl) hotelTotalGSFEl.textContent = hotelTotalGSF.toLocaleString();
            if (hotelAssignableSFEl) hotelAssignableSFEl.textContent = hotelAssignableSF.toLocaleString();
            if (hotelUsedSFEl) hotelUsedSFEl.textContent = hotelUsedSF.toLocaleString();
            if (hotelEfficiencyEl) hotelEfficiencyEl.textContent = `${hotelEfficiency}%`;
            
            // Update Adelphi Campus Total ASF in Scope
            const combinedTotalASF = adminAssignableSF + iccAssignableSF + hotelAssignableSF;
            const combinedTotalASFEl = document.getElementById('combinedTotalASF');
            if (combinedTotalASFEl) combinedTotalASFEl.textContent = combinedTotalASF.toLocaleString();
            
            // Update remaining SF in headers
            const adminRemainingSF = adminAssignableSF - adminUsedSF;
            const iccRemainingSF = iccAssignableSF - iccUsedSF;
            const hotelRemainingSF = hotelAssignableSF - hotelUsedSF;
            
            const remainingSFEl = document.getElementById('remainingSF');
            const iccRemainingSFEl = document.getElementById('iccRemainingSF');
            const hotelRemainingSFEl = document.getElementById('hotelRemainingSF');
            
            if (remainingSFEl) remainingSFEl.textContent = adminRemainingSF.toLocaleString();
            if (iccRemainingSFEl) iccRemainingSFEl.textContent = iccRemainingSF.toLocaleString();
            if (hotelRemainingSFEl) hotelRemainingSFEl.textContent = hotelRemainingSF.toLocaleString();
            
            // Calculate campus-wide existing data from all buildings
            const campusExistingWorkPoints = 
                existingQuantities.cubicalDesk + existingQuantities.office +
                iccExistingQuantities.cubicalDesk + iccExistingQuantities.office +
                hotelExistingQuantities.cubicalDesk + hotelExistingQuantities.office;
            
            const campusExistingCollaborationPoints = 
                existingQuantities.conferenceRoom + existingQuantities.huddleShelter +
                iccExistingQuantities.conferenceRoom + iccExistingQuantities.huddleShelter +
                hotelExistingQuantities.conferenceRoom + hotelExistingQuantities.huddleShelter;
            
            const campusExistingAssignable = 77514 + 36021 + 5310; // Sum of existing assignable SF from all buildings (118,845)
            
            // Calculate campus total GSF (sum of all buildings' GSF)
            const campusTotalGSF = 142300 + 37700 + 7500; // Admin + ICC + Hotel GSF (187,500)
            
            // Calculate campus-wide seats (workstations + offices + collaboration spaces)
            const campusExistingSeats = campusExistingWorkPoints + campusExistingCollaborationPoints;
            
            // Update campus total GSF (only if campus tab is active)
            const campusTotalGSFEl = document.getElementById('campusTotalGSF');
            if (campusTotalGSFEl && document.getElementById('comparison-building-content').classList.contains('active')) {
                campusTotalGSFEl.textContent = campusTotalGSF.toLocaleString();
            }
            
            // Update campus existing data (only if campus tab is active)
            const campusExistingAssignableEl = document.getElementById('campusExistingAssignable');
            const campusExistingDesksEl = document.getElementById('campusExistingDesks');
            const campusExistingOfficesEl = document.getElementById('campusExistingOffices');
            const campusExistingWorkpointsEl = document.getElementById('campusExistingWorkpoints');
            const campusExistingConferenceEl = document.getElementById('campusExistingConference');
            const campusExistingHuddleEl = document.getElementById('campusExistingHuddle');
            const campusExistingCollaborationEl = document.getElementById('campusExistingCollaboration');
            const campusExistingSeatsEl = document.getElementById('campusExistingSeats');
            
            if (document.getElementById('comparison-building-content').classList.contains('active')) {
                // Calculate existing individual values
                const campusExistingDesks = existingQuantities.cubicalDesk + iccExistingQuantities.cubicalDesk + hotelExistingQuantities.cubicalDesk;
                const campusExistingOffices = existingQuantities.office + iccExistingQuantities.office + hotelExistingQuantities.office;
                const campusExistingWorkpoints = campusExistingDesks + campusExistingOffices;
                
                const campusExistingConference = existingQuantities.conferenceRoom + iccExistingQuantities.conferenceRoom + hotelExistingQuantities.conferenceRoom;
                const campusExistingHuddle = existingQuantities.huddleShelter + iccExistingQuantities.huddleShelter + hotelExistingQuantities.huddleShelter;
                const campusExistingCollaboration = campusExistingConference + campusExistingHuddle;
                
                // Calculate existing seats (18 per conference room + 6 per huddle)
                const campusExistingSeats = (campusExistingConference * 18) + (campusExistingHuddle * 6);
                
                if (campusExistingAssignableEl) campusExistingAssignableEl.textContent = campusExistingAssignable.toLocaleString();
                if (campusExistingDesksEl) campusExistingDesksEl.textContent = campusExistingDesks;
                if (campusExistingOfficesEl) campusExistingOfficesEl.textContent = campusExistingOffices;
                if (campusExistingWorkpointsEl) campusExistingWorkpointsEl.textContent = campusExistingWorkpoints;
                if (campusExistingConferenceEl) campusExistingConferenceEl.textContent = campusExistingConference;
                if (campusExistingHuddleEl) campusExistingHuddleEl.textContent = campusExistingHuddle;
                if (campusExistingCollaborationEl) campusExistingCollaborationEl.textContent = campusExistingCollaboration;
                if (campusExistingSeatsEl) campusExistingSeatsEl.textContent = campusExistingSeats.toLocaleString();
            }
            
            // Update campus planned data
            const campusPlannedAssignableEl = document.getElementById('campusPlannedAssignable');
            const campusPlannedDesksEl = document.getElementById('campusPlannedDesks');
            const campusPlannedOfficesEl = document.getElementById('campusPlannedOffices');
            const campusPlannedWorkpointsEl = document.getElementById('campusPlannedWorkpoints');
            const campusPlannedConferenceEl = document.getElementById('campusPlannedConference');
            const campusPlannedHuddleEl = document.getElementById('campusPlannedHuddle');
            const campusPlannedCollaborationEl = document.getElementById('campusPlannedCollaboration');
            const campusPlannedSeatsEl = document.getElementById('campusPlannedSeats');
            
            // Calculate planned values dynamically
            const campusPlannedAssignable = adminAssignableSF + iccAssignableSF + hotelAssignableSF;
            const campusPlannedDesks = (quantities.cubicalDesk || 0) + (iccQuantities.cubicalDesk || 0) + (hotelQuantities.cubicalDesk || 0);
            const campusPlannedOffices = (quantities.office || 0) + (iccQuantities.office || 0) + (hotelQuantities.office || 0);
            const campusPlannedWorkpoints = campusPlannedDesks + campusPlannedOffices;
            
            const campusPlannedConference = (quantities.conferenceRoom || 0) + (iccQuantities.conferenceRoom || 0) + (hotelQuantities.conferenceRoom || 0);
            const campusPlannedHuddle = (quantities.huddleShelter || 0) + (iccQuantities.huddleShelter || 0) + (hotelQuantities.huddleShelter || 0);
            const campusPlannedCollaboration = campusPlannedConference + campusPlannedHuddle;
            
            // Calculate planned seats (18 per conference room + 6 per huddle)
            const campusPlannedSeats = (campusPlannedConference * 18) + (campusPlannedHuddle * 6);
            
            if (document.getElementById('comparison-building-content').classList.contains('active')) {
                if (campusPlannedAssignableEl) campusPlannedAssignableEl.textContent = campusPlannedAssignable.toLocaleString();
                if (campusPlannedDesksEl) campusPlannedDesksEl.textContent = campusPlannedDesks;
                if (campusPlannedOfficesEl) campusPlannedOfficesEl.textContent = campusPlannedOffices;
                if (campusPlannedWorkpointsEl) campusPlannedWorkpointsEl.textContent = campusPlannedWorkpoints;
                if (campusPlannedConferenceEl) campusPlannedConferenceEl.textContent = campusPlannedConference;
                if (campusPlannedHuddleEl) campusPlannedHuddleEl.textContent = campusPlannedHuddle;
                if (campusPlannedCollaborationEl) campusPlannedCollaborationEl.textContent = campusPlannedCollaboration;
                if (campusPlannedSeatsEl) campusPlannedSeatsEl.textContent = campusPlannedSeats.toLocaleString();
            }
            
            // Calculate individual building totals for summary cards
            const adminWorkPointsCount = (quantities.cubicalDesk || 0) + (quantities.office || 0);
            const adminCollaborationPointsCount = (quantities.conferenceRoom || 0) + (quantities.huddleShelter || 0);
            const iccWorkPointsCount = (iccQuantities.cubicalDesk || 0) + (iccQuantities.office || 0);
            const iccCollaborationPointsCount = (iccQuantities.conferenceRoom || 0) + (iccQuantities.huddleShelter || 0);
            
            const hotelWorkPointsCount = (hotelQuantities.cubicalDesk || 0) + (hotelQuantities.office || 0);
            const hotelCollaborationPointsCount = (hotelQuantities.conferenceRoom || 0) + (hotelQuantities.huddleShelter || 0);
            
            // Update building summary cards - Existing data
            const adminSummaryExistingWorkstationEl = document.getElementById('adminSummaryExistingWorkstation');
            const adminSummaryExistingOfficeEl = document.getElementById('adminSummaryExistingOffice');
            const adminSummaryExistingWorkpointsEl = document.getElementById('adminSummaryExistingWorkpoints');
            const adminSummaryExistingConferenceEl = document.getElementById('adminSummaryExistingConference');
            const adminSummaryExistingHuddleEl = document.getElementById('adminSummaryExistingHuddle');
            const adminSummaryExistingCollabEl = document.getElementById('adminSummaryExistingCollab');
            const adminSummaryExistingSeatsEl = document.getElementById('adminSummaryExistingSeats');
            
            if (adminSummaryExistingWorkstationEl) adminSummaryExistingWorkstationEl.textContent = existingQuantities.cubicalDesk;
            if (adminSummaryExistingOfficeEl) adminSummaryExistingOfficeEl.textContent = existingQuantities.office;
            if (adminSummaryExistingWorkpointsEl) adminSummaryExistingWorkpointsEl.textContent = existingQuantities.cubicalDesk + existingQuantities.office;
            if (adminSummaryExistingConferenceEl) adminSummaryExistingConferenceEl.textContent = existingQuantities.conferenceRoom;
            if (adminSummaryExistingHuddleEl) adminSummaryExistingHuddleEl.textContent = existingQuantities.huddleShelter;
            if (adminSummaryExistingCollabEl) adminSummaryExistingCollabEl.textContent = existingQuantities.conferenceRoom + existingQuantities.huddleShelter;
            if (adminSummaryExistingSeatsEl) adminSummaryExistingSeatsEl.textContent = (existingQuantities.conferenceRoom * 18) + (existingQuantities.huddleShelter * 6);
            
            const iccSummaryExistingWorkstationEl = document.getElementById('iccSummaryExistingWorkstation');
            const iccSummaryExistingOfficeEl = document.getElementById('iccSummaryExistingOffice');
            const iccSummaryExistingWorkpointsEl = document.getElementById('iccSummaryExistingWorkpoints');
            const iccSummaryExistingConferenceEl = document.getElementById('iccSummaryExistingConference');
            const iccSummaryExistingHuddleEl = document.getElementById('iccSummaryExistingHuddle');
            const iccSummaryExistingCollabEl = document.getElementById('iccSummaryExistingCollab');
            const iccSummaryExistingSeatsEl = document.getElementById('iccSummaryExistingSeats');
            
            if (iccSummaryExistingWorkstationEl) iccSummaryExistingWorkstationEl.textContent = iccExistingQuantities.cubicalDesk;
            if (iccSummaryExistingOfficeEl) iccSummaryExistingOfficeEl.textContent = iccExistingQuantities.office;
            if (iccSummaryExistingWorkpointsEl) iccSummaryExistingWorkpointsEl.textContent = iccExistingQuantities.cubicalDesk + iccExistingQuantities.office;
            if (iccSummaryExistingConferenceEl) iccSummaryExistingConferenceEl.textContent = iccExistingQuantities.conferenceRoom;
            if (iccSummaryExistingHuddleEl) iccSummaryExistingHuddleEl.textContent = iccExistingQuantities.huddleShelter;
            if (iccSummaryExistingCollabEl) iccSummaryExistingCollabEl.textContent = iccExistingQuantities.conferenceRoom + iccExistingQuantities.huddleShelter;
            if (iccSummaryExistingSeatsEl) iccSummaryExistingSeatsEl.textContent = (iccExistingQuantities.conferenceRoom * 18) + (iccExistingQuantities.huddleShelter * 6);
            
            const hotelSummaryExistingWorkstationEl = document.getElementById('hotelSummaryExistingWorkstation');
            const hotelSummaryExistingOfficeEl = document.getElementById('hotelSummaryExistingOffice');
            const hotelSummaryExistingWorkpointsEl = document.getElementById('hotelSummaryExistingWorkpoints');
            const hotelSummaryExistingConferenceEl = document.getElementById('hotelSummaryExistingConference');
            const hotelSummaryExistingHuddleEl = document.getElementById('hotelSummaryExistingHuddle');
            const hotelSummaryExistingCollabEl = document.getElementById('hotelSummaryExistingCollab');
            const hotelSummaryExistingSeatsEl = document.getElementById('hotelSummaryExistingSeats');
            
            if (hotelSummaryExistingWorkstationEl) hotelSummaryExistingWorkstationEl.textContent = hotelExistingQuantities.cubicalDesk;
            if (hotelSummaryExistingOfficeEl) hotelSummaryExistingOfficeEl.textContent = hotelExistingQuantities.office;
            if (hotelSummaryExistingWorkpointsEl) hotelSummaryExistingWorkpointsEl.textContent = hotelExistingQuantities.cubicalDesk + hotelExistingQuantities.office;
            if (hotelSummaryExistingConferenceEl) hotelSummaryExistingConferenceEl.textContent = hotelExistingQuantities.conferenceRoom;
            if (hotelSummaryExistingHuddleEl) hotelSummaryExistingHuddleEl.textContent = hotelExistingQuantities.huddleShelter;
            if (hotelSummaryExistingCollabEl) hotelSummaryExistingCollabEl.textContent = hotelExistingQuantities.conferenceRoom + hotelExistingQuantities.huddleShelter;
            if (hotelSummaryExistingSeatsEl) hotelSummaryExistingSeatsEl.textContent = (hotelExistingQuantities.conferenceRoom * 18) + (hotelExistingQuantities.huddleShelter * 6);
            
            // Update building ASF values
            const adminExistingASFEl = document.getElementById('adminExistingASF');
            const adminPlannedASFEl = document.getElementById('adminPlannedASF');
            
            if (adminExistingASFEl) adminExistingASFEl.textContent = (77514).toLocaleString(); // Existing ASF
            if (adminPlannedASFEl) adminPlannedASFEl.textContent = adminAssignableSF.toLocaleString(); // Planned ASF
            
            const iccExistingASFEl = document.getElementById('iccExistingASF');
            const iccPlannedASFEl = document.getElementById('iccPlannedASF');
            
            if (iccExistingASFEl) iccExistingASFEl.textContent = (20300 + 15721).toLocaleString(); // Total Existing ASF (Basement + 3rd Floor)
            if (iccPlannedASFEl) iccPlannedASFEl.textContent = (20300 + iccAssignableSF).toLocaleString(); // Total Planned ASF (Basement + 3rd Floor)
            
            const hotelExistingASFEl = document.getElementById('hotelExistingASF');
            const hotelPlannedASFEl = document.getElementById('hotelPlannedASF');
            
            if (hotelExistingASFEl) hotelExistingASFEl.textContent = (5310).toLocaleString(); // Existing ASF
            if (hotelPlannedASFEl) hotelPlannedASFEl.textContent = hotelAssignableSF.toLocaleString(); // Planned ASF
            
            // Update building summary cards - Planned data (default to existing values)
            const adminSummaryWorkstationEl = document.getElementById('adminSummaryWorkstation');
            const adminSummaryOfficeEl = document.getElementById('adminSummaryOffice');
            const adminSummaryWorkpointsEl = document.getElementById('adminSummaryWorkpoints');
            const adminSummaryConferenceEl = document.getElementById('adminSummaryConference');
            const adminSummaryHuddleEl = document.getElementById('adminSummaryHuddle');
            const adminSummaryCollabEl = document.getElementById('adminSummaryCollab');
            const adminSummarySeatsEl = document.getElementById('adminSummarySeats');
            
            // For default display, planned values match existing values
            if (adminSummaryWorkstationEl) adminSummaryWorkstationEl.textContent = existingQuantities.cubicalDesk;
            if (adminSummaryOfficeEl) adminSummaryOfficeEl.textContent = existingQuantities.office;
            if (adminSummaryWorkpointsEl) adminSummaryWorkpointsEl.textContent = existingQuantities.cubicalDesk + existingQuantities.office;
            if (adminSummaryConferenceEl) adminSummaryConferenceEl.textContent = existingQuantities.conferenceRoom;
            if (adminSummaryHuddleEl) adminSummaryHuddleEl.textContent = existingQuantities.huddleShelter;
            if (adminSummaryCollabEl) adminSummaryCollabEl.textContent = existingQuantities.conferenceRoom + existingQuantities.huddleShelter;
            if (adminSummarySeatsEl) adminSummarySeatsEl.textContent = (existingQuantities.conferenceRoom * 18) + (existingQuantities.huddleShelter * 6);
            
            const iccSummaryWorkstationEl = document.getElementById('iccSummaryWorkstation');
            const iccSummaryOfficeEl = document.getElementById('iccSummaryOffice');
            const iccSummaryWorkpointsEl = document.getElementById('iccSummaryWorkpoints');
            const iccSummaryConferenceEl = document.getElementById('iccSummaryConference');
            const iccSummaryHuddleEl = document.getElementById('iccSummaryHuddle');
            const iccSummaryCollabEl = document.getElementById('iccSummaryCollab');
            const iccSummarySeatsEl = document.getElementById('iccSummarySeats');
            
            // For default display, planned values match existing values
            if (iccSummaryWorkstationEl) iccSummaryWorkstationEl.textContent = iccExistingQuantities.cubicalDesk;
            if (iccSummaryOfficeEl) iccSummaryOfficeEl.textContent = iccExistingQuantities.office;
            if (iccSummaryWorkpointsEl) iccSummaryWorkpointsEl.textContent = iccExistingQuantities.cubicalDesk + iccExistingQuantities.office;
            if (iccSummaryConferenceEl) iccSummaryConferenceEl.textContent = iccExistingQuantities.conferenceRoom;
            if (iccSummaryHuddleEl) iccSummaryHuddleEl.textContent = iccExistingQuantities.huddleShelter;
            if (iccSummaryCollabEl) iccSummaryCollabEl.textContent = iccExistingQuantities.conferenceRoom + iccExistingQuantities.huddleShelter;
            if (iccSummarySeatsEl) iccSummarySeatsEl.textContent = (iccExistingQuantities.conferenceRoom * 18) + (iccExistingQuantities.huddleShelter * 6);
            
            const hotelSummaryWorkstationEl = document.getElementById('hotelSummaryWorkstation');
            const hotelSummaryOfficeEl = document.getElementById('hotelSummaryOffice');
            const hotelSummaryWorkpointsEl = document.getElementById('hotelSummaryWorkpoints');
            const hotelSummaryConferenceEl = document.getElementById('hotelSummaryConference');
            const hotelSummaryHuddleEl = document.getElementById('hotelSummaryHuddle');
            const hotelSummaryCollabEl = document.getElementById('hotelSummaryCollab');
            const hotelSummarySeatsEl = document.getElementById('hotelSummarySeats');
            
            // For default display, planned values match existing values
            if (hotelSummaryWorkstationEl) hotelSummaryWorkstationEl.textContent = hotelExistingQuantities.cubicalDesk;
            if (hotelSummaryOfficeEl) hotelSummaryOfficeEl.textContent = hotelExistingQuantities.office;
            if (hotelSummaryWorkpointsEl) hotelSummaryWorkpointsEl.textContent = hotelExistingQuantities.cubicalDesk + hotelExistingQuantities.office;
            if (hotelSummaryConferenceEl) hotelSummaryConferenceEl.textContent = hotelExistingQuantities.conferenceRoom;
            if (hotelSummaryHuddleEl) hotelSummaryHuddleEl.textContent = hotelExistingQuantities.huddleShelter;
            if (hotelSummaryCollabEl) hotelSummaryCollabEl.textContent = hotelExistingQuantities.conferenceRoom + hotelExistingQuantities.huddleShelter;
            if (hotelSummarySeatsEl) hotelSummarySeatsEl.textContent = (hotelExistingQuantities.conferenceRoom * 18) + (hotelExistingQuantities.huddleShelter * 6);
            
            // Update comparison cards with existing and planned data
            updateComparisonCards();
            
            // Update Campus Header (only if campus tab is active)
            const campusRemainingSFEl = document.getElementById('campusRemainingSF');
            const campusDeltaGSFEl = document.getElementById('campusDeltaGSF');
            const campusDeltaWorkstationsEl = document.getElementById('campusDeltaWorkstations');
            const campusHeaderDeskCountEl = document.getElementById('campusHeaderDeskCount');
            const campusHeaderOfficeCountEl = document.getElementById('campusHeaderOfficeCount');
            const campusDeltaOfficesEl = document.getElementById('campusDeltaOffices');
            const campusHeaderConfCountEl = document.getElementById('campusHeaderConfCount');
            const campusHeaderHuddleCountEl = document.getElementById('campusHeaderHuddleCount');
            
            // Always update campus totals regardless of active tab
            {
                if (campusRemainingSFEl) {
                    const campusUsedSF = adminUsedSF + iccUsedSF + hotelUsedSF;
                    const campusTotalAssignable = adminAssignableSF + iccAssignableSF + hotelAssignableSF;
                    const campusRemaining = campusTotalAssignable - campusUsedSF;
                    campusRemainingSFEl.textContent = campusRemaining.toLocaleString();
                }
            
                if (campusDeltaGSFEl) {
                    const campusExistingAssignable = 77514 + 36021 + 5310; // Sum of existing assignable SF from all buildings
                    const campusPlannedAssignable = adminAssignableSF + iccAssignableSF + hotelAssignableSF;
                    const deltaGSF = campusPlannedAssignable - campusExistingAssignable;
                    campusDeltaGSFEl.textContent = (deltaGSF >= 0 ? '+' : '') + deltaGSF.toLocaleString();
                }
                
                if (campusDeltaWorkstationsEl) {
                    const campusExistingWorkpoints = existingQuantities.cubicalDesk + iccExistingQuantities.cubicalDesk + hotelExistingQuantities.cubicalDesk;
                    const campusPlannedWorkpoints = (quantities.cubicalDesk || 0) + (iccQuantities.cubicalDesk || 0) + (hotelQuantities.cubicalDesk || 0);
                    const deltaWorkpoints = campusPlannedWorkpoints - campusExistingWorkpoints;
                    campusDeltaWorkstationsEl.textContent = (deltaWorkpoints >= 0 ? '+' : '') + deltaWorkpoints;
                }
                
                if (campusHeaderDeskCountEl) {
                    const campusWorkpointsCount = (quantities.cubicalDesk || 0) + (iccQuantities.cubicalDesk || 0) + (hotelQuantities.cubicalDesk || 0);
                    campusHeaderDeskCountEl.textContent = campusWorkpointsCount;
                }
                
                if (campusHeaderOfficeCountEl) {
                    const campusOfficeCount = (quantities.office || 0) + (iccQuantities.office || 0) + (hotelQuantities.office || 0);
                    campusHeaderOfficeCountEl.textContent = campusOfficeCount;
                }
                
                if (campusDeltaOfficesEl) {
                    const campusExistingCollaboration = (existingQuantities.conferenceRoom + existingQuantities.huddleShelter) + (iccExistingQuantities.conferenceRoom + iccExistingQuantities.huddleShelter) + (hotelExistingQuantities.conferenceRoom + hotelExistingQuantities.huddleShelter);
                    const campusPlannedCollaboration = ((quantities.conferenceRoom || 0) + (quantities.huddleShelter || 0)) + ((iccQuantities.conferenceRoom || 0) + (iccQuantities.huddleShelter || 0)) + ((hotelQuantities.conferenceRoom || 0) + (hotelQuantities.huddleShelter || 0));
                    const deltaCollaboration = campusPlannedCollaboration - campusExistingCollaboration;
                    campusDeltaOfficesEl.textContent = (deltaCollaboration >= 0 ? '+' : '') + deltaCollaboration;
                }
                
                if (campusHeaderConfCountEl) {
                    const campusConfCount = (quantities.conferenceRoom || 0) + (iccQuantities.conferenceRoom || 0) + (hotelQuantities.conferenceRoom || 0);
                    campusHeaderConfCountEl.textContent = campusConfCount;
                }
                
                if (campusHeaderHuddleCountEl) {
                    const campusHuddleCount = (quantities.huddleShelter || 0) + (iccQuantities.huddleShelter || 0) + (hotelQuantities.huddleShelter || 0);
                    campusHeaderHuddleCountEl.textContent = campusHuddleCount;
                }
            }
            
            // Update Adelphi comparison charts
            if (typeof updateAdephiComparisonCharts === 'function') updateAdephiComparisonCharts();
        }
        
        // Function to update comparison cards with existing and planned data
        function updateComparisonCards() {
            // Calculate existing data from building data structures
            const adminExistingWorkPoints = existingQuantities.cubicalDesk + existingQuantities.office;
            const adminExistingCollaborationPoints = existingQuantities.conferenceRoom + existingQuantities.huddleShelter;
            const adminExistingAssignable = 77514; // This should match the hardcoded value or be calculated
            
            const iccExistingWorkPoints = iccExistingQuantities.cubicalDesk + iccExistingQuantities.office;
            const iccExistingCollaborationPoints = iccExistingQuantities.conferenceRoom + iccExistingQuantities.huddleShelter;
            const iccExistingAssignable = 36021; // This should match the hardcoded value or be calculated
            
            const hotelExistingWorkPoints = hotelExistingQuantities.cubicalDesk + hotelExistingQuantities.office;
            const hotelExistingCollaborationPoints = hotelExistingQuantities.conferenceRoom + hotelExistingQuantities.huddleShelter;
            const hotelExistingAssignable = 5310; // This should match the hardcoded value or be calculated
            
            // Calculate planned data from current building quantities
            const adminPlannedWorkPoints = (quantities.cubicalDesk || 0) + (quantities.office || 0);
            const adminPlannedCollaborationPoints = (quantities.conferenceRoom || 0) + (quantities.huddleShelter || 0);
            const adminPlannedAssignable = floorSpaces.reduce((sum, gsf, index) => {
                return sum + Math.round(gsf * (floorEfficiencies[index] / 100));
            }, 0);
            
            const iccPlannedWorkPoints = (iccQuantities.cubicalDesk || 0) + (iccQuantities.office || 0);
            const iccPlannedCollaborationPoints = (iccQuantities.conferenceRoom || 0) + (iccQuantities.huddleShelter || 0);
            const iccPlannedAssignable = iccFloorSpaces.reduce((sum, gsf, index) => {
                return sum + Math.round(gsf * (iccFloorEfficiencies[index] / 100));
            }, 0);
            
            const hotelPlannedWorkPoints = (hotelQuantities.cubicalDesk || 0) + (hotelQuantities.office || 0);
            const hotelPlannedCollaborationPoints = (hotelQuantities.conferenceRoom || 0) + (hotelQuantities.huddleShelter || 0);
            const hotelPlannedAssignable = hotelFloorSpaces.reduce((sum, gsf, index) => {
                return sum + Math.round(gsf * (hotelFloorEfficiencies[index] / 100));
            }, 0);
            
            // Update Admin Building comparison cards
            const adminExistingAssignableEl = document.getElementById('existingAssignable');
            const adminExistingWorkPointsEl = document.getElementById('existingWorkPoints');
            const adminExistingDeskCountEl = document.getElementById('existingDeskCount');
            const adminExistingOfficeCountEl = document.getElementById('existingOfficeCount');
            const adminExistingCollabPointsEl = document.getElementById('existingCollabPoints');
            const adminExistingConfCountEl = document.getElementById('existingConfCount');
            const adminExistingHuddleCountEl = document.getElementById('existingHuddleCount');
            
            if (adminExistingAssignableEl) adminExistingAssignableEl.textContent = adminExistingAssignable.toLocaleString();
            if (adminExistingWorkPointsEl) adminExistingWorkPointsEl.textContent = `${adminExistingWorkPoints} spaces`;
            if (adminExistingDeskCountEl) adminExistingDeskCountEl.textContent = existingQuantities.cubicalDesk;
            if (adminExistingOfficeCountEl) adminExistingOfficeCountEl.textContent = existingQuantities.office;
            if (adminExistingCollabPointsEl) adminExistingCollabPointsEl.textContent = `${adminExistingCollaborationPoints} spaces`;
            if (adminExistingConfCountEl) adminExistingConfCountEl.textContent = existingQuantities.conferenceRoom;
            if (adminExistingHuddleCountEl) adminExistingHuddleCountEl.textContent = existingQuantities.huddleShelter;
            
            const adminPlannedAssignableEl = document.getElementById('plannedAssignable');
            const adminPlannedWorkPointsEl = document.getElementById('plannedWorkPoints');
            const adminPlannedDeskCountEl = document.getElementById('plannedDeskCount');
            const adminPlannedOfficeCountEl = document.getElementById('plannedOfficeCount');
            const adminPlannedCollabPointsEl = document.getElementById('plannedCollabPoints');
            const adminPlannedConfCountEl = document.getElementById('plannedConfCount');
            const adminPlannedHuddleCountEl = document.getElementById('plannedHuddleCount');
            
            if (adminPlannedAssignableEl) adminPlannedAssignableEl.textContent = adminPlannedAssignable.toLocaleString();
            if (adminPlannedWorkPointsEl) adminPlannedWorkPointsEl.textContent = `${adminPlannedWorkPoints} spaces`;
            if (adminPlannedDeskCountEl) adminPlannedDeskCountEl.textContent = quantities.cubicalDesk || 0;
            if (adminPlannedOfficeCountEl) adminPlannedOfficeCountEl.textContent = quantities.office || 0;
            if (adminPlannedCollabPointsEl) adminPlannedCollabPointsEl.textContent = `${adminPlannedCollaborationPoints} spaces`;
            if (adminPlannedConfCountEl) adminPlannedConfCountEl.textContent = quantities.conferenceRoom || 0;
            if (adminPlannedHuddleCountEl) adminPlannedHuddleCountEl.textContent = quantities.huddleShelter || 0;
            
            // Update ICC Building comparison cards
            const iccExistingAssignableEl = document.getElementById('iccExistingAssignable');
            const iccExistingWorkPointsEl = document.getElementById('iccExistingWorkPoints');
            const iccExistingDeskCountEl = document.getElementById('iccExistingDeskCount');
            const iccExistingOfficeCountEl = document.getElementById('iccExistingOfficeCount');
            const iccExistingCollabPointsEl = document.getElementById('iccExistingCollabPoints');
            const iccExistingConfCountEl = document.getElementById('iccExistingConfCount');
            const iccExistingHuddleCountEl = document.getElementById('iccExistingHuddleCount');
            
            if (iccExistingAssignableEl) iccExistingAssignableEl.textContent = iccExistingAssignable.toLocaleString();
            if (iccExistingWorkPointsEl) iccExistingWorkPointsEl.textContent = `${iccExistingWorkPoints} spaces`;
            if (iccExistingDeskCountEl) iccExistingDeskCountEl.textContent = iccExistingQuantities.cubicalDesk;
            if (iccExistingOfficeCountEl) iccExistingOfficeCountEl.textContent = iccExistingQuantities.office;
            if (iccExistingCollabPointsEl) iccExistingCollabPointsEl.textContent = `${iccExistingCollaborationPoints} spaces`;
            if (iccExistingConfCountEl) iccExistingConfCountEl.textContent = iccExistingQuantities.conferenceRoom;
            if (iccExistingHuddleCountEl) iccExistingHuddleCountEl.textContent = iccExistingQuantities.huddleShelter;
            
            // Update Hotel Building comparison cards
            const hotelExistingAssignableEl = document.getElementById('hotelExistingAssignable');
            const hotelExistingWorkPointsEl = document.getElementById('hotelExistingWorkPoints');
            const hotelExistingDeskCountEl = document.getElementById('hotelExistingDeskCount');
            const hotelExistingOfficeCountEl = document.getElementById('hotelExistingOfficeCount');
            const hotelExistingCollabPointsEl = document.getElementById('hotelExistingCollabPoints');
            const hotelExistingConfCountEl = document.getElementById('hotelExistingConfCount');
            const hotelExistingHuddleCountEl = document.getElementById('hotelExistingHuddleCount');
            
            if (hotelExistingAssignableEl) hotelExistingAssignableEl.textContent = hotelExistingAssignable.toLocaleString();
            if (hotelExistingWorkPointsEl) hotelExistingWorkPointsEl.textContent = `${hotelExistingWorkPoints} spaces`;
            if (hotelExistingDeskCountEl) hotelExistingDeskCountEl.textContent = hotelExistingQuantities.cubicalDesk;
            if (hotelExistingOfficeCountEl) hotelExistingOfficeCountEl.textContent = hotelExistingQuantities.office;
            if (hotelExistingCollabPointsEl) hotelExistingCollabPointsEl.textContent = `${hotelExistingCollaborationPoints} spaces`;
            if (hotelExistingConfCountEl) hotelExistingConfCountEl.textContent = hotelExistingQuantities.conferenceRoom;
            if (hotelExistingHuddleCountEl) hotelExistingHuddleCountEl.textContent = hotelExistingQuantities.huddleShelter;
            
            // Update ICC Building planned comparison cards
            const iccPlannedAssignableEl = document.getElementById('iccPlannedAssignable');
            const iccPlannedWorkPointsEl = document.getElementById('iccPlannedWorkPoints');
            const iccPlannedDeskCountEl = document.getElementById('iccPlannedDeskCount');
            const iccPlannedOfficeCountEl = document.getElementById('iccPlannedOfficeCount');
            const iccPlannedCollabPointsEl = document.getElementById('iccPlannedCollabPoints');
            const iccPlannedConfCountEl = document.getElementById('iccPlannedConfCount');
            const iccPlannedHuddleCountEl = document.getElementById('iccPlannedHuddleCount');
            
            if (iccPlannedAssignableEl) iccPlannedAssignableEl.textContent = iccPlannedAssignable.toLocaleString();
            if (iccPlannedWorkPointsEl) iccPlannedWorkPointsEl.textContent = `${iccPlannedWorkPoints} spaces`;
            if (iccPlannedDeskCountEl) iccPlannedDeskCountEl.textContent = iccQuantities.cubicalDesk || 0;
            if (iccPlannedOfficeCountEl) iccPlannedOfficeCountEl.textContent = iccQuantities.office || 0;
            if (iccPlannedCollabPointsEl) iccPlannedCollabPointsEl.textContent = `${iccPlannedCollaborationPoints} spaces`;
            if (iccPlannedConfCountEl) iccPlannedConfCountEl.textContent = iccQuantities.conferenceRoom || 0;
            if (iccPlannedHuddleCountEl) iccPlannedHuddleCountEl.textContent = iccQuantities.huddleShelter || 0;
            
            // Update Hotel Building planned comparison cards
            const hotelPlannedAssignableEl = document.getElementById('hotelPlannedAssignable');
            const hotelPlannedWorkPointsEl = document.getElementById('hotelPlannedWorkPoints');
            const hotelPlannedDeskCountEl = document.getElementById('hotelPlannedDeskCount');
            const hotelPlannedOfficeCountEl = document.getElementById('hotelPlannedOfficeCount');
            const hotelPlannedCollabPointsEl = document.getElementById('hotelPlannedCollabPoints');
            const hotelPlannedConfCountEl = document.getElementById('hotelPlannedConfCount');
            const hotelPlannedHuddleCountEl = document.getElementById('hotelPlannedHuddleCount');
            
            if (hotelPlannedAssignableEl) hotelPlannedAssignableEl.textContent = hotelPlannedAssignable.toLocaleString();
            if (hotelPlannedWorkPointsEl) hotelPlannedWorkPointsEl.textContent = `${hotelPlannedWorkPoints} spaces`;
            if (hotelPlannedDeskCountEl) hotelPlannedDeskCountEl.textContent = hotelQuantities.cubicalDesk || 0;
            if (hotelPlannedOfficeCountEl) hotelPlannedOfficeCountEl.textContent = hotelQuantities.office || 0;
            if (hotelPlannedCollabPointsEl) hotelPlannedCollabPointsEl.textContent = `${hotelPlannedCollaborationPoints} spaces`;
            if (hotelPlannedConfCountEl) hotelPlannedConfCountEl.textContent = hotelQuantities.conferenceRoom || 0;
            if (hotelPlannedHuddleCountEl) hotelPlannedHuddleCountEl.textContent = hotelQuantities.huddleShelter || 0;
        }

        function toggleFloorAssignment() {
            const wasFloorMode = assignByFloor;
            assignByFloor = document.getElementById('assignByFloorToggle').checked;
            
            if (assignByFloor && !wasFloorMode) {
                // Switching TO floor mode: preserve existing distributions if they exist
                SPACE_TYPES.forEach(type => {
                    // Only distribute equally if floor quantities are all zeros
                    if (floorQuantities[type.id].every(qty => qty === 0)) {
                    const buildingQty = quantities[type.id] || 0;
                    if (buildingQty > 0) {
                        const qtyPerFloor = Math.floor(buildingQty / 4);
                        const remainder = buildingQty % 4;
                        
                        // Distribute equally with remainder to first floors
                        floorQuantities[type.id] = [
                            qtyPerFloor + (remainder > 0 ? 1 : 0),
                            qtyPerFloor + (remainder > 1 ? 1 : 0),
                            qtyPerFloor + (remainder > 2 ? 1 : 0),
                            qtyPerFloor
                        ];
                    } else {
                        floorQuantities[type.id] = [0, 0, 0, 0];
                        }
                    }
                });
            } else if (!assignByFloor && wasFloorMode) {
                // Switching FROM floor mode: sum floor quantities back to building total
                SPACE_TYPES.forEach(type => {
                    const floorTotal = floorQuantities[type.id] ? 
                        floorQuantities[type.id].reduce((a, b) => a + b, 0) : 0;
                    quantities[type.id] = floorTotal;
                });
            }
            
            renderSpaceTypes();
            updateSpaceCalculations();
        }

        function renderSpaceTypes(customQuantities = quantities, customFloorQuantities = floorQuantities, customAssignByFloor = assignByFloor, customShowExisting = showExisting, updateQuantityFunc = 'updateSpaceQuantity', updateFloorQuantityFunc = 'updateFloorQuantity', customSpaceSF = spaceSF, updateSpaceSFFunc = 'updateSpaceSF') {
            // Categorize space types
            const workPointsSpaces = SPACE_TYPES.filter(t => t.category === 'workPoints');
            const collaborationPointsSpaces = SPACE_TYPES.filter(t => t.category === 'collaborationPoints');
            const otherSpaces = SPACE_TYPES.filter(t => t.category === 'otherSpaces');
            
            const renderGrid = (types, gridId) => {
                const grid = document.getElementById(gridId);
                if (!grid) return;
                
                // Use the helper function generateSpaceTypeCard for consistency
                grid.innerHTML = types.map(type => 
                    generateSpaceTypeCard(
                        type, 
                        customQuantities, 
                        customFloorQuantities, 
                        customAssignByFloor, 
                        customShowExisting, 
                        updateQuantityFunc, 
                        updateFloorQuantityFunc, 
                        customSpaceSF, 
                        updateSpaceSFFunc, 
                        '', // buildingPrefix
                        ['Floor 1', 'Floor 2', 'Floor 3', 'Floor 4'], // Admin has 4 floors
                        [true, true, true, true] // All 4 floors are active
                    )
                ).join('');
            };
            
            renderGrid(workPointsSpaces, 'workPointsSpacesGrid');
            renderGrid(collaborationPointsSpaces, 'collaborationPointsSpacesGrid');
            renderGrid(otherSpaces, 'otherSpacesGrid');
        }

        function addCustomSpace() {
            const name = document.getElementById('customName').value;
            const sf = document.getElementById('customSF').value;
            const qty = document.getElementById('customQty').value;
            
            if (name && sf && qty) {
                const newSpace = {
                    id: `custom-${Date.now()}`,
                    name: name,
                    sf: parseInt(sf),
                    quantity: parseInt(qty)
                };
                
                customSpaces.push(newSpace);
                
                // Clear inputs
                document.getElementById('customName').value = '';
                document.getElementById('customSF').value = '';
                document.getElementById('customQty').value = '';
                
                renderCustomSpaces();
                updateSpaceCalculations();
            }
        }

        function removeCustomSpace(id) {
            customSpaces = customSpaces.filter(space => space.id !== id);
            renderCustomSpaces();
            updateSpaceCalculations();
        }

        // ICC Custom Spaces Functions
        function addICCCustomSpace() {
            const name = document.getElementById('iccCustomName').value;
            const sf = document.getElementById('iccCustomSF').value;
            const qty = document.getElementById('iccCustomQty').value;
            
            if (name && sf && qty) {
                const newSpace = {
                    id: `icc-custom-${Date.now()}`,
                    name: name,
                    sf: parseInt(sf),
                    quantity: parseInt(qty)
                };
                
                iccCustomSpaces.push(newSpace);
                
                // Clear inputs
                document.getElementById('iccCustomName').value = '';
                document.getElementById('iccCustomSF').value = '';
                document.getElementById('iccCustomQty').value = '';
                
                updateICCCustomSpacesList();
                updateICCBuildingTotals();
                updateBuildingComparison();
            }
        }

        function removeICCCustomSpace(id) {
            iccCustomSpaces = iccCustomSpaces.filter(space => space.id !== id);
            updateICCCustomSpacesList();
            updateICCBuildingTotals();
            updateBuildingComparison();
        }

        function updateICCCustomSpacesList() {
            const list = document.getElementById('iccCustomSpacesList');
            if (!list) return;
            
            if (iccCustomSpaces.length === 0) {
                list.innerHTML = '';
                return;
            }
            
            list.innerHTML = '<div class="space-types-grid">' + iccCustomSpaces.map(space => `
                <div class="space-type-card" style="position: relative;">
                    <button class="remove-space-button" onclick="removeICCCustomSpace('${space.id}')" style="position: absolute; top: 10px; right: 10px; background: #dc2626; color: white; border: none; border-radius: 50%; width: 24px; height: 24px; cursor: pointer; font-size: 14px; display: flex; align-items: center; justify-content: center;">âœ•</button>
                    <div class="space-type-header">
                        <div class="space-type-name">${space.name}</div>
                        <div class="space-type-color" style="background-color: hsl(280, 65%, 70%);"></div>
                    </div>
                    <div class="space-type-total">
                        <span class="space-total-label">Total SF:</span>
                        <span class="space-total-value" id="icc-custom-total-${space.id}">${(space.sf * space.quantity).toLocaleString()} SF</span>
                    </div>
                </div>
            `).join('') + '</div>';
        }

        // Hotel Custom Spaces Functions
        function addHotelCustomSpace() {
            const name = document.getElementById('hotelCustomName').value;
            const sf = document.getElementById('hotelCustomSF').value;
            const qty = document.getElementById('hotelCustomQty').value;
            
            if (name && sf && qty) {
                const newSpace = {
                    id: `hotel-custom-${Date.now()}`,
                    name: name,
                    sf: parseInt(sf),
                    quantity: parseInt(qty)
                };
                
                hotelCustomSpaces.push(newSpace);
                
                // Clear inputs
                document.getElementById('hotelCustomName').value = '';
                document.getElementById('hotelCustomSF').value = '';
                document.getElementById('hotelCustomQty').value = '';
                
                updateHotelCustomSpacesList();
                updateHotelBuildingTotals();
                updateBuildingComparison();
            }
        }

        function removeHotelCustomSpace(id) {
            hotelCustomSpaces = hotelCustomSpaces.filter(space => space.id !== id);
            updateHotelCustomSpacesList();
            updateHotelBuildingTotals();
            updateBuildingComparison();
        }

        function updateHotelCustomSpacesList() {
            const list = document.getElementById('hotelCustomSpacesList');
            if (!list) return;
            
            if (hotelCustomSpaces.length === 0) {
                list.innerHTML = '';
                return;
            }
            
            list.innerHTML = '<div class="space-types-grid">' + hotelCustomSpaces.map(space => `
                <div class="space-type-card" style="position: relative;">
                    <button class="remove-space-button" onclick="removeHotelCustomSpace('${space.id}')" style="position: absolute; top: 10px; right: 10px; background: #dc2626; color: white; border: none; border-radius: 50%; width: 24px; height: 24px; cursor: pointer; font-size: 14px; display: flex; align-items: center; justify-content: center;">âœ•</button>
                    <div class="space-type-header">
                        <div class="space-type-name">${space.name}</div>
                        <div class="space-type-color" style="background-color: hsl(280, 65%, 70%);"></div>
                    </div>
                    <div class="space-type-total">
                        <span class="space-total-label">Total SF:</span>
                        <span class="space-total-value" id="hotel-custom-total-${space.id}">${(space.sf * space.quantity).toLocaleString()} SF</span>
                    </div>
                </div>
            `).join('') + '</div>';
        }

        function renderCustomSpaces() {
            const list = document.getElementById('customSpacesList');
            if (!list) return;
            
            if (customSpaces.length === 0) {
                list.innerHTML = '';
                return;
            }
            
            list.innerHTML = '<div class="space-types-grid">' + customSpaces.map(space => `
                <div class="space-type-card" style="position: relative;">
                    <button class="remove-space-button" onclick="removeCustomSpace('${space.id}')" style="position: absolute; top: 10px; right: 10px; background: #dc2626; color: white; border: none; border-radius: 50%; width: 24px; height: 24px; cursor: pointer; font-size: 14px; display: flex; align-items: center; justify-content: center;">âœ•</button>
                    <div class="space-type-header">
                        <div class="space-type-name">${space.name}</div>
                        <div class="space-type-color" style="background-color: hsl(280, 65%, 70%);"></div>
                        </div>
                    <div class="space-type-inputs">
                        <div class="space-input-group">
                            <label class="space-input-label">SF per Unit</label>
                            <div class="space-input" style="padding: 8px; background: #f5f5f5; border-radius: 4px;">${space.sf}</div>
                    </div>
                        <div class="space-input-group">
                            <label class="space-input-label">Qty</label>
                            <div class="space-qty-display">${space.quantity}</div>
                </div>
                    </div>
                    <div class="space-type-total">
                        <span class="space-total-label">Total SF:</span>
                        <span class="space-total-value">${(space.quantity * space.sf).toLocaleString()} SF</span>
                    </div>
                </div>
            `).join('') + '</div>';
        }

        function createSpaceCharts() {
            // Category comparison chart
            const ctxCategory = document.getElementById('categoryComparisonChart');
            if (ctxCategory && !categoryChart) {
                console.log('Creating category chart...');
                categoryChart = new Chart(ctxCategory, {
                    type: 'bar',
                    data: {
                        labels: ['Workstations', 'Private Offices', 'Collaboration Spaces', 'Other Spaces'],
                        datasets: [{
                            label: 'Existing',
                            data: [3000, 3750, 2375, 0], // Initial data
                            backgroundColor: 'rgba(220, 38, 38, 0.8)',
                            borderColor: 'rgba(220, 38, 38, 1)',
                            borderWidth: 1
                        }, {
                            label: 'Planned',
                            data: [0, 0, 0, 0], // Initial data
                            backgroundColor: 'rgba(34, 197, 94, 0.8)',
                            borderColor: 'rgba(34, 197, 94, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        aspectRatio: 1.5,
                        plugins: {
                            legend: { 
                                position: 'top',
                                labels: {
                                    boxWidth: 15,
                                    padding: 10
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': ' + context.parsed.y.toLocaleString() + ' SF';
                                    }
                                }
                            }
                        },
                        scales: {
                            y: { 
                                beginAtZero: true, 
                                title: { display: true, text: 'Square Feet' },
                                ticks: {
                                    callback: function(value) {
                                        return value.toLocaleString();
                                    }
                                }
                            },
                            x: { 
                                ticks: { 
                                    maxRotation: 45, 
                                    minRotation: 0
                                }
                            }
                        }
                    }
                });
            }
            
            // Type comparison chart
            const ctxType = document.getElementById('typeComparisonChart');
            if (ctxType && !typeChart) {
                console.log('Creating type chart...');
                typeChart = new Chart(ctxType, {
                    type: 'bar',
                    data: {
                        labels: ['Open Workstation', 'Private Office', 'Phone Room', 'Huddle/Interview Room (2p)', 'Small Meeting Room (6p)', 'Medium Meeting Room (12p)'],
                        datasets: [{
                            label: 'Existing',
                            data: [3000, 3750, 225, 600, 750, 800], // Initial data
                            backgroundColor: 'rgba(220, 38, 38, 0.8)',
                            borderColor: 'rgba(220, 38, 38, 1)',
                            borderWidth: 1
                        }, {
                            label: 'Planned',
                            data: [0, 0, 0, 0, 0, 0], // Initial data
                            backgroundColor: 'rgba(34, 197, 94, 0.8)',
                            borderColor: 'rgba(34, 197, 94, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        aspectRatio: 1.5,
                        plugins: {
                            legend: { 
                                position: 'top',
                                labels: {
                                    boxWidth: 15,
                                    padding: 10
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': ' + context.parsed.y.toLocaleString() + ' spaces';
                                    }
                                }
                            }
                        },
                        scales: {
                            y: { 
                                beginAtZero: true, 
                                title: { display: true, text: 'Number of Spaces' },
                                ticks: {
                                    callback: function(value) {
                                        return value.toLocaleString();
                                    }
                                }
                            },
                            x: { 
                                ticks: { 
                                    maxRotation: 45, 
                                    minRotation: 45,
                                    autoSkip: false
                                }
                            }
                        }
                    }
                });
            }
        }

        function updateSpaceCharts() {
            // Ensure charts are created first
            if (!categoryChart || !typeChart) {
                createSpaceCharts();
            if (!categoryChart || !typeChart) return;
            }
            
            // Existing data from provided values
            const existingData = {
                workPoints: (99 * 60) + (193 * 140),      // 99 cubical/desk * 60 + 193 office * 140 = 32,960
                collaborationPoints: (21 * 480) + (35 * 180), // 21 conference * 480 + 35 huddle * 180 = 16,380
                other: 0
            };
            
            // Calculate planned category summary using floor quantities
            const plannedCategorySummary = {
                workPoints: { count: 0, sf: 0 },
                collaborationPoints: { count: 0, sf: 0 },
                other: { count: 0, sf: 0 }
            };
            
            SPACE_TYPES.forEach(type => {
                // Use floor quantities since assignByFloor is always true
                const qty = floorQuantities[type.id] ? floorQuantities[type.id].reduce((a, b) => a + b, 0) : 0;
                const sf = spaceSF[type.id] || type.defaultSf;
                if (!plannedCategorySummary[type.category]) {
                    plannedCategorySummary[type.category] = { count: 0, sf: 0 };
                }
                plannedCategorySummary[type.category].count += qty;
                plannedCategorySummary[type.category].sf += sf * qty;
            });
            
            // Update category comparison chart
            const categoryLabels = ['Work Points', 'Collaboration Points', 'Other Spaces'];
            const existingCategoryData = [
                existingData.workPoints,
                existingData.collaborationPoints,
                existingData.other
            ];
            const plannedCategoryData = [
                plannedCategorySummary.workPoints.sf,
                plannedCategorySummary.collaborationPoints.sf,
                plannedCategorySummary.other.sf
            ];
            
            // Use category colors
            const categoryColors = [
                'hsl(217, 91%, 60%)', // Work Points - Blue
                'hsl(47, 96%, 53%)',  // Collaboration Points - Yellow
                'hsl(280, 65%, 60%)'  // Other - Purple
            ];
            
            categoryChart.data.labels = categoryLabels;
            categoryChart.data.datasets[0].data = existingCategoryData;
            categoryChart.data.datasets[0].backgroundColor = categoryColors.map(color => color.replace(')', ', 0.8)').replace('hsl(', 'hsla('));
            categoryChart.data.datasets[1].data = plannedCategoryData;
            categoryChart.data.datasets[1].backgroundColor = categoryColors.map(color => color.replace(')', ', 0.8)').replace('hsl(', 'hsla('));
            categoryChart.update();
            
            // Update type comparison chart - showing COUNT of spaces (not SF)
            const existingTypeData = {
                'Cubical/Desk': 99,      // Count of cubical/desks
                'Office': 193,          // Count of offices
                'Conference Room - Reservable': 21,   // Count of conference rooms
                'Huddle/Shelter - Non Reservable': 35 // Count of huddle spaces
            };
            
            const typeLabels = [];
            const existingTypeValues = [];
            const plannedTypeValues = [];
            const existingColors = [];
            const plannedColors = [];
            
            SPACE_TYPES.forEach(type => {
                // Use floor quantities since assignByFloor is always true
                const qty = floorQuantities[type.id] ? floorQuantities[type.id].reduce((a, b) => a + b, 0) : 0;
                
                // Always show all space types - using COUNT not SF
                typeLabels.push(type.name);
                existingTypeValues.push(existingTypeData[type.name] || 0);
                plannedTypeValues.push(qty); // Just the count
                existingColors.push(type.color);
                plannedColors.push(type.color);
            });
            
            typeChart.data.labels = typeLabels;
            typeChart.data.datasets[0].data = existingTypeValues;
            typeChart.data.datasets[0].backgroundColor = existingColors;
            typeChart.data.datasets[1].data = plannedTypeValues;
            typeChart.data.datasets[1].backgroundColor = plannedColors;
            typeChart.update();
        }

        function updateCategorySummary() {
            const tbody = document.getElementById('categorySummaryBody');
            if (!tbody) return;
            
            const categorySummary = {
                workstations: { count: 0, sf: 0 },
                offices: { count: 0, sf: 0 },
                meeting: { count: 0, sf: 0 },
                support: { count: 0, sf: 0 }
            };
            
            SPACE_TYPES.forEach(type => {
                const qty = quantities[type.id] || 0;
                const sf = spaceSF[type.id] || type.defaultSf;
                categorySummary[type.category].count += qty;
                categorySummary[type.category].sf += sf * qty;
            });
            
            const totalSF = Object.values(categorySummary).reduce((sum, cat) => sum + cat.sf, 0);
            
            tbody.innerHTML = Object.entries(categorySummary).map(([key, value]) => `
                <tr>
                    <td class="font-medium">${CATEGORY_NAMES[key]}</td>
                    <td class="text-right">${value.count}</td>
                    <td class="text-right">${value.sf.toLocaleString()}</td>
                    <td class="text-right">${totalSF > 0 ? ((value.sf / totalSF) * 100).toFixed(1) : 0}%</td>
                    <td>
                        <div class="color-swatch" style="background-color: ${CATEGORY_COLORS[key]}"></div>
                    </td>
                </tr>
            `).join('');
        }

        function updateDetailedTable() {
            const tbody = document.getElementById('detailedSpaceBody');
            if (!tbody) return;
            
            let rows = SPACE_TYPES.map(type => {
                const qty = quantities[type.id] || 0;
                const sf = spaceSF[type.id] || type.defaultSf;
                const total = qty * sf;
                
                return `
                    <tr>
                        <td class="font-medium">${type.name}</td>
                        <td>${CATEGORY_NAMES[type.category]}</td>
                        <td class="text-right">${sf}</td>
                        <td class="text-right">${qty}</td>
                        <td class="text-right">${total.toLocaleString()}</td>
                        <td>
                            <div class="color-swatch" style="background-color: ${type.color}"></div>
                        </td>
                    </tr>
                `;
            });
            
            customSpaces.forEach(space => {
                rows.push(`
                    <tr>
                        <td class="font-medium">${space.name}</td>
                        <td>Custom</td>
                        <td class="text-right">${space.sf}</td>
                        <td class="text-right">${space.quantity}</td>
                        <td class="text-right">${(space.sf * space.quantity).toLocaleString()}</td>
                        <td>
                            <div class="color-swatch" style="background-color: #9ca3af"></div>
                        </td>
                    </tr>
                `);
            });
            
            tbody.innerHTML = rows.join('');
        }

        function showCapacityAlert(assignable, used, remaining) {
            document.getElementById('alertAssignableSF').textContent = assignable.toLocaleString();
            document.getElementById('alertUsedSF').textContent = used.toLocaleString();
            document.getElementById('alertOverSF').textContent = Math.abs(remaining).toLocaleString();
            document.getElementById('capacityAlert').style.display = 'flex';
        }

        function closeCapacityAlert() {
            document.getElementById('capacityAlert').style.display = 'none';
        }

        // Best Practice Efficiency Functions
        function applyBestPracticeEfficiency() {
            // Apply best practice values to all Admin Building floors
            const bestPracticeValues = [60, 65, 65, 75]; // Best practice values for floors 1, 2, 3, 4
            
            // Update all floor efficiency sliders and values
            for (let floor = 1; floor <= 4; floor++) {
                const slider = document.getElementById(`floor${floor}EffSlider`);
                const valueSpan = document.getElementById(`floor${floor}EffValue`);
                
                if (slider && valueSpan) {
                    const bestPracticeEfficiency = bestPracticeValues[floor - 1];
                    slider.value = bestPracticeEfficiency;
                    valueSpan.textContent = bestPracticeEfficiency + '%';
                    
                    // Update floor efficiency array
                    floorEfficiencies[floor - 1] = bestPracticeEfficiency;
                    
                    // Update assignable SF display
                    const existingGSF = [37200, 37100, 37100, 30900]; // Floor 1, 2, 3, 4 existing GSF
                    const assignable = Math.round(existingGSF[floor - 1] * (bestPracticeEfficiency / 100));
                    document.getElementById(`floor${floor}Assignable`).textContent = assignable.toLocaleString();
                }
            }
            
            // Update building totals and calculations
            updateBuildingTotals();
            updateSpaceCalculations();
            updateBuildingComparison();
            
            // Show success message
            const button = document.getElementById('bestPracticeEfficiencyBtn');
            const originalText = button.innerHTML;
            button.innerHTML = 'Applied!';
            button.style.background = '#c8e6c9';
            button.style.color = '#2e7d32';
            button.style.borderColor = '#a5d6a7';
            setTimeout(() => {
                button.innerHTML = originalText;
                button.style.background = '#e3f2fd';
                button.style.color = '#1976d2';
                button.style.borderColor = '#bbdefb';
            }, 2000);
        }

        function applyICCBestPracticeEfficiency() {
            // Apply best practice value to ICC Building 3rd floor
            const bestPracticeEfficiency = 80; // Best practice value for ICC 3rd floor
            
            // Update 3rd floor efficiency slider and value
            const slider = document.getElementById('iccFloor3EffSlider');
            const valueSpan = document.getElementById('iccFloor3EffValue');
            
            if (slider && valueSpan) {
                slider.value = bestPracticeEfficiency;
                valueSpan.textContent = bestPracticeEfficiency + '%';
                
                // Update floor efficiency array
                iccFloorEfficiencies[2] = bestPracticeEfficiency; // 3rd floor is index 2
                
                // Update assignable SF display
                const existingGSF = 19900; // 3rd floor GSF
                const assignable = Math.round(existingGSF * (bestPracticeEfficiency / 100));
                document.getElementById('iccFloor3Assignable').textContent = assignable.toLocaleString();
            }
            
            // Update building totals and calculations
            updateICCBuildingTotals();
            updateBuildingComparison();
            
            // Show success message
            const button = document.getElementById('iccBestPracticeEfficiencyBtn');
            const originalText = button.innerHTML;
            button.innerHTML = 'Applied!';
            button.style.background = '#c8e6c9';
            button.style.color = '#2e7d32';
            button.style.borderColor = '#a5d6a7';
            setTimeout(() => {
                button.innerHTML = originalText;
                button.style.background = '#e3f2fd';
                button.style.color = '#1976d2';
                button.style.borderColor = '#bbdefb';
            }, 2000);
        }

        // Reset to Existing Conditions Functions
        function resetToExistingConditions() {
            // Reset Admin Building to existing efficiency values
            const existingValues = [49, 46, 53, 73]; // Existing efficiency values for floors 1, 2, 3, 4
            
            // Update all floor efficiency sliders and values
            for (let floor = 1; floor <= 4; floor++) {
                const slider = document.getElementById(`floor${floor}EffSlider`);
                const valueSpan = document.getElementById(`floor${floor}EffValue`);
                
                if (slider && valueSpan) {
                    const existingEfficiency = existingValues[floor - 1];
                    slider.value = existingEfficiency;
                    valueSpan.textContent = existingEfficiency + '%';
                    
                    // Update floor efficiency array
                    floorEfficiencies[floor - 1] = existingEfficiency;
                    
                    // Update assignable SF display
                    const existingGSF = [37200, 37100, 37100, 30900]; // Floor 1, 2, 3, 4 existing GSF
                    const assignable = Math.round(existingGSF[floor - 1] * (existingEfficiency / 100));
                    document.getElementById(`floor${floor}Assignable`).textContent = assignable.toLocaleString();
                }
            }
            
            // Update building totals and calculations
            updateBuildingTotals();
            updateSpaceCalculations();
            updateBuildingComparison();
            
            // Show success message
            const button = document.getElementById('resetToExistingBtn');
            const originalText = button.innerHTML;
            button.innerHTML = 'Reset!';
            button.style.background = '#c8e6c9';
            button.style.color = '#2e7d32';
            button.style.borderColor = '#a5d6a7';
            setTimeout(() => {
                button.innerHTML = originalText;
                button.style.background = '#fff3e0';
                button.style.color = '#f57c00';
                button.style.borderColor = '#ffcc02';
            }, 2000);
        }

        function resetICCToExistingConditions() {
            // Reset ICC Building to existing efficiency value
            const existingEfficiency = 79; // ICC 3rd floor existing efficiency
            
            // Update 3rd floor efficiency slider and value
            const slider = document.getElementById('iccFloor3EffSlider');
            const valueSpan = document.getElementById('iccFloor3EffValue');
            
            if (slider && valueSpan) {
                slider.value = existingEfficiency;
                valueSpan.textContent = existingEfficiency + '%';
                
                // Update floor efficiency array
                iccFloorEfficiencies[2] = existingEfficiency; // 3rd floor is index 2
                
                // Update assignable SF display
                const existingGSF = 19900; // 3rd floor GSF
                const assignable = Math.round(existingGSF * (existingEfficiency / 100));
                document.getElementById('iccFloor3Assignable').textContent = assignable.toLocaleString();
            }
            
            // Update building totals and calculations
            updateICCBuildingTotals();
            updateBuildingComparison();
            
            // Show success message
            const button = document.getElementById('iccResetToExistingBtn');
            const originalText = button.innerHTML;
            button.innerHTML = 'Reset!';
            button.style.background = '#c8e6c9';
            button.style.color = '#2e7d32';
            button.style.borderColor = '#a5d6a7';
            setTimeout(() => {
                button.innerHTML = originalText;
                button.style.background = '#fff3e0';
                button.style.color = '#f57c00';
                button.style.borderColor = '#ffcc02';
            }, 2000);
        }

        // Reset Space Allocation to Existing Functions
        function resetSpaceAllocationToExisting() {
            // Reset Admin Building space quantities to existing values
            quantities = {
                cubicalDesk: 99, // Existing quantities
                office: 193,
                conferenceRoom: 21,
                huddleShelter: 35,
                otherSpaces: 1 // 1 unit of 28,174 SF for storage, kitchen, and other support spaces
            };
            
            // Reset floor quantities to existing distribution
            floorQuantities = {
                cubicalDesk: [84, 7, 0, 8], // Existing floor distribution
                office: [12, 65, 100, 16],
                conferenceRoom: [7, 5, 5, 4],
                huddleShelter: [20, 6, 7, 2],
                otherSpaces: [0, 0, 0, 0] // Storage, kitchen, and other support spaces are not assigned by floor
            };
            
            // Re-render space types and update calculations
            renderSpaceTypes();
            updateSpaceCalculations();
            updateBuildingComparison();
            
            // Show success message
            const button = document.getElementById('resetSpaceAllocationBtn');
            const originalText = button.innerHTML;
            button.innerHTML = 'Reset!';
            button.style.background = '#c8e6c9';
            button.style.color = '#2e7d32';
            button.style.borderColor = '#a5d6a7';
            setTimeout(() => {
                button.innerHTML = originalText;
                button.style.background = '#fff3e0';
                button.style.color = '#f57c00';
                button.style.borderColor = '#ffcc02';
            }, 2000);
        }

        function resetICCSpaceAllocationToExisting() {
            // Reset ICC Building space quantities to existing values
            iccQuantities = {
                cubicalDesk: 17, // Existing quantities
                office: 49,
                conferenceRoom: 7,
                huddleShelter: 0
            };
            
            // Reset floor quantities to existing distribution
            iccFloorQuantities = {
                cubicalDesk: [9, 0, 8, 0], // Existing floor distribution
                office: [19, 0, 30, 0],
                conferenceRoom: [1, 0, 6, 0],
                huddleShelter: [0, 0, 0, 0]
            };
            
            // Re-render space types and update calculations
            renderICCSpaceTypes();
            updateICCBuildingTotals();
            updateBuildingComparison();
            
            // Show success message
            const button = document.getElementById('resetICCSpaceAllocationBtn');
            const originalText = button.innerHTML;
            button.innerHTML = 'Reset!';
            button.style.background = '#c8e6c9';
            button.style.color = '#2e7d32';
            button.style.borderColor = '#a5d6a7';
            setTimeout(() => {
                button.innerHTML = originalText;
                button.style.background = '#fff3e0';
                button.style.color = '#f57c00';
                button.style.borderColor = '#ffcc02';
            }, 2000);
        }

        function resetHotelSpaceAllocationToExisting() {
            // Reset Hotel Building space quantities to existing values
            hotelQuantities = {
                cubicalDesk: 0, // Existing quantities
                office: 0,
                conferenceRoom: 6,
                huddleShelter: 0
            };
            
            // Reset floor quantities to existing distribution
            hotelFloorQuantities = {
                cubicalDesk: [0, 0, 0, 0], // Existing floor distribution
                office: [0, 0, 0, 0],
                conferenceRoom: [6, 0, 0, 0], // All 6 conference rooms on 1st floor
                huddleShelter: [0, 0, 0, 0]
            };
            
            // Re-render space types and update calculations
            renderHotelSpaceTypes();
            updateHotelBuildingTotals();
            updateBuildingComparison();
            
            // Show success message
            const button = document.getElementById('resetHotelSpaceAllocationBtn');
            const originalText = button.innerHTML;
            button.innerHTML = 'Reset!';
            button.style.background = '#c8e6c9';
            button.style.color = '#2e7d32';
            button.style.borderColor = '#a5d6a7';
            setTimeout(() => {
                button.innerHTML = originalText;
                button.style.background = '#fff3e0';
                button.style.color = '#f57c00';
                button.style.borderColor = '#ffcc02';
            }, 2000);
        }

        // Initialize on page load regardless of which tab is active
        window.addEventListener('load', function() {
            console.log('Page loaded, initializing space planning...');
                initSpacePlanning();
        });
    </script>
    
    <script>
        // Comparison Chart Variables
        let efficiencyChart = null;
        let seatsOfficesChart = null;
        let collabRoomsChart = null;
        let collabSeatsChart = null;
        
        // Function to create Adelphi Campus comparison charts
        function createAdephiComparisonCharts() {
            // Chart colors
            const adminColor = 'rgba(0, 45, 114, 0.8)'; // Navy
            const iccColor = 'rgba(255, 184, 28, 0.8)'; // Gold
            const hotelColor = 'rgba(197, 32, 50, 0.8)'; // Red
            const existingColor = 'rgba(128, 128, 128, 0.6)'; // Gray for existing
            
            // Efficiency chart removed per request
            
            // 2. Seats & Offices Comparison Chart
            const seatsOfficesCtx = document.getElementById('seatsOfficesComparisonChart');
            if (seatsOfficesCtx) {
                seatsOfficesChart = new Chart(seatsOfficesCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Admin Building', 'ICC Building', 'Hotel Building', 'Campus Total'],
                        datasets: [
                            {
                                label: 'Existing Workstations',
                                data: [99, 17, 0, 116],
                                backgroundColor: 'rgba(128, 128, 128, 0.6)',
                                stack: 'existing'
                            },
                            {
                                label: 'Existing Offices',
                                data: [193, 49, 0, 242],
                                backgroundColor: 'rgba(90, 90, 90, 0.6)',
                                stack: 'existing'
                            },
                            {
                                label: 'Planned Workstations',
                                data: [0, 0, 0, 0], // Will be updated by updateAdephiComparisonCharts
                                backgroundColor: [adminColor, iccColor, hotelColor, 'rgba(0, 45, 114, 0.5)'],
                                stack: 'planned'
                            },
                            {
                                label: 'Planned Closed Offices',
                                data: [0, 0, 0, 0], // Will be updated by updateAdephiComparisonCharts
                                backgroundColor: [
                                    'rgba(0, 45, 114, 0.6)', 
                                    'rgba(255, 184, 28, 0.6)', 
                                    'rgba(197, 32, 50, 0.6)', 
                                    'rgba(0, 45, 114, 0.3)'
                                ],
                                stack: 'planned'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: true, position: 'top' },
                            title: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: { display: true, text: 'Number of Spaces' }
                            }
                        }
                    }
                });
            }
            
            // 3. Collaboration Rooms by Category
            const collabRoomsCtx = document.getElementById('collabRoomsComparisonChart');
            if (collabRoomsCtx) {
                collabRoomsChart = new Chart(collabRoomsCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Conference Rooms', 'Huddle Shelters'],
                        datasets: [
                            {
                                label: 'Admin - Existing',
                                data: [21, 35],
                                backgroundColor: 'rgba(128, 128, 128, 0.6)',
                                stack: 'existing'
                            },
                            {
                                label: 'ICC - Existing',
                                data: [7, 0],
                                backgroundColor: 'rgba(128, 128, 128, 0.4)',
                                stack: 'existing'
                            },
                            {
                                label: 'Hotel - Existing',
                                data: [6, 0],
                                backgroundColor: 'rgba(128, 128, 128, 0.2)',
                                stack: 'existing'
                            },
                            {
                                label: 'Admin - Planned',
                                data: [0, 0], // Will be updated by updateAdephiComparisonCharts
                                backgroundColor: adminColor,
                                stack: 'planned'
                            },
                            {
                                label: 'ICC - Planned',
                                data: [0, 0], // Will be updated by updateAdephiComparisonCharts
                                backgroundColor: iccColor,
                                stack: 'planned'
                            },
                            {
                                label: 'Hotel - Planned',
                                data: [0, 0], // Will be updated by updateAdephiComparisonCharts
                                backgroundColor: hotelColor,
                                stack: 'planned'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: true, position: 'top' },
                            title: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: { display: true, text: 'Number of Rooms' }
                            }
                        }
                    }
                });
            }
            
            // 4. Collaboration Seats
            const collabSeatsCtx = document.getElementById('collabSeatsComparisonChart');
            if (collabSeatsCtx) {
                collabSeatsChart = new Chart(collabSeatsCtx, {
                    type: 'bar',
                    data: {
                        labels: ['Admin Building', 'ICC Building', 'Hotel Building', 'Campus Total'],
                        datasets: [
                            {
                                label: 'Existing',
                                data: [588, 126, 108, 822],
                                backgroundColor: existingColor
                            },
                            {
                                label: 'Planned',
                                data: [0, 0, 0, 0], // Will be updated by updateAdephiComparisonCharts
                                backgroundColor: [adminColor, iccColor, hotelColor, 'rgba(100, 100, 100, 0.8)']
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: { display: true, position: 'top' },
                            title: { display: false }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: { display: true, text: 'Number of Seats' }
                            }
                        }
                    }
                });
            }
            
            
        }
        
        // Function to update Adelphi comparison charts with current data
        function updateAdephiComparisonCharts() {
            
            // Calculate Admin totals using correct space types
            const adminWorkstations = quantities.cubicalDesk || 0;
            const adminOffices = quantities.office || 0;
            const adminConferenceRooms = quantities.conferenceRoom || 0;
            const adminHuddleShelters = quantities.huddleShelter || 0;
            
            // Calculate Admin SF using correct space types
            const adminWorkstationsSF = adminWorkstations * (spaceSF.cubicalDesk || 60);
            const adminOfficesSF = adminOffices * (spaceSF.office || 140);
            const adminConferenceRoomsSF = adminConferenceRooms * (spaceSF.conferenceRoom || 480);
            const adminHuddleSheltersSF = adminHuddleShelters * (spaceSF.huddleShelter || 180);
            
            // Calculate Admin seats (18 per conference room + 6 per huddle)
            const adminCollabSeats = (adminConferenceRooms * 18) + (adminHuddleShelters * 6);
            
            // Calculate ICC totals using correct space types
            const iccWorkstations = iccQuantities.cubicalDesk || 0;
            const iccOffices = iccQuantities.office || 0;
            const iccConferenceRooms = iccQuantities.conferenceRoom || 0;
            const iccHuddleShelters = iccQuantities.huddleShelter || 0;
            
            // Calculate ICC SF using correct space types
            const iccWorkstationsSF = iccWorkstations * (iccSpaceSF.cubicalDesk || 60);
            const iccOfficesSF = iccOffices * (iccSpaceSF.office || 150);
            const iccConferenceRoomsSF = iccConferenceRooms * (iccSpaceSF.conferenceRoom || 450);
            const iccHuddleSheltersSF = iccHuddleShelters * (iccSpaceSF.huddleShelter || 50);
            
            // Calculate ICC seats (18 per conference room + 6 per huddle)
            const iccCollabSeats = (iccConferenceRooms * 18) + (iccHuddleShelters * 6);
            
            // Calculate Hotel totals using correct space types
            const hotelWorkstations = hotelQuantities.cubicalDesk || 0;
            const hotelOffices = hotelQuantities.office || 0;
            const hotelConferenceRooms = hotelQuantities.conferenceRoom || 0;
            const hotelHuddleShelters = hotelQuantities.huddleShelter || 0;
            
            // Calculate Hotel SF using correct space types
            const hotelWorkstationsSF = hotelWorkstations * (hotelSpaceSF.cubicalDesk || 60);
            const hotelOfficesSF = hotelOffices * (hotelSpaceSF.office || 150);
            const hotelConferenceRoomsSF = hotelConferenceRooms * (hotelSpaceSF.conferenceRoom || 450);
            const hotelHuddleSheltersSF = hotelHuddleShelters * (hotelSpaceSF.huddleShelter || 50);
            
            // Calculate Hotel seats (18 per conference room + 6 per huddle)
            const hotelCollabSeats = (hotelConferenceRooms * 18) + (hotelHuddleShelters * 6);
            
            // Calculate efficiency
            const adminTotalGSF = floorSpaces.reduce((a, b) => a + b, 0);
            // Use existing GSF for assignable SF calculation
            const adminExistingGSF = [37200, 37100, 37100, 30900]; // Floor 1, 2, 3, 4 existing GSF
            const adminAssignableSF = adminExistingGSF.reduce((sum, gsf, index) => sum + Math.round(gsf * (floorEfficiencies[index] / 100)), 0);
            const adminEfficiency = adminTotalGSF > 0 ? Math.round((adminAssignableSF / adminTotalGSF) * 100) : 0;
            
            const iccTotalGSF = iccFloorSpaces.reduce((a, b) => a + b, 0);
            // Use existing GSF for assignable SF calculation to show proper comparison
            const iccExistingGSF = [0, 0, 19900, 0]; // ICC Floor 3 existing GSF
            const iccAssignableSF = iccExistingGSF.reduce((sum, gsf, index) => sum + Math.round(gsf * (iccFloorEfficiencies[index] / 100)), 0);
            const iccEfficiency = iccTotalGSF > 0 ? Math.round((iccAssignableSF / iccTotalGSF) * 100) : 0;
            
            const hotelTotalGSF = hotelFloorSpaces.reduce((a, b) => a + b, 0);
            // Use existing GSF for assignable SF calculation to show proper comparison
            const hotelExistingGSF = [7500, 0, 0, 0]; // Hotel Floor 1 existing GSF
            const hotelAssignableSF = hotelExistingGSF.reduce((sum, gsf, index) => sum + Math.round(gsf * (hotelFloorEfficiencies[index] / 100)), 0);
            const hotelEfficiency = hotelTotalGSF > 0 ? Math.round((hotelAssignableSF / hotelTotalGSF) * 100) : 0;
            
            // ICC and Hotel collaboration seats already calculated above
            
            // Calculate campus totals
            const campusTotalGSF = adminTotalGSF + iccTotalGSF + hotelTotalGSF;
            const campusAssignableSF = adminAssignableSF + iccAssignableSF + hotelAssignableSF;
            const campusEfficiency = campusTotalGSF > 0 ? Math.round((campusAssignableSF / campusTotalGSF) * 100) : 0;
            const campusWorkstations = adminWorkstations + iccWorkstations + hotelWorkstations;
            const campusOffices = adminOffices + iccOffices + hotelOffices;
            const campusCollabSeats = adminCollabSeats + iccCollabSeats + hotelCollabSeats;
            
            // Update Efficiency Chart
            if (efficiencyChart) {
                efficiencyChart.data.datasets[1].data = [adminEfficiency, iccEfficiency, hotelEfficiency, campusEfficiency];
                efficiencyChart.update();
            }
            
            // Update Seats & Offices Chart
            if (seatsOfficesChart) {
                seatsOfficesChart.data.datasets[2].data = [adminWorkstations, iccWorkstations, hotelWorkstations, campusWorkstations];
                seatsOfficesChart.data.datasets[3].data = [adminOffices, iccOffices, hotelOffices, campusOffices];
                seatsOfficesChart.update();
            }
            
            // Update Collaboration Rooms Chart (stacked by building)
            if (collabRoomsChart) {
                // Dataset 0: Admin - Existing (no update needed, static)
                // Dataset 1: ICC - Existing (no update needed, static)
                // Dataset 2: Hotel - Existing (no update needed, static)
                collabRoomsChart.data.datasets[3].data = [adminConferenceRooms, adminHuddleShelters]; // Admin planned data
                collabRoomsChart.data.datasets[4].data = [iccConferenceRooms, iccHuddleShelters]; // ICC planned data
                collabRoomsChart.data.datasets[5].data = [hotelConferenceRooms, hotelHuddleShelters]; // Hotel planned data
                collabRoomsChart.update();
            }
            
            // Update Collaboration Seats Chart
            if (collabSeatsChart) {
                // Calculate campus total seats
                const campusCollabSeats = adminCollabSeats + iccCollabSeats + hotelCollabSeats;
                
                collabSeatsChart.data.datasets[1].data = [adminCollabSeats, iccCollabSeats, hotelCollabSeats, campusCollabSeats];
                collabSeatsChart.update();
            }
            
            // Calculate ICC SF by category (additional space types)
            const iccSmallOfficeSF = (iccQuantities.smallOffice || 0) * (iccSpaceSF.smallOffice || 150);
            const iccMedOfficeSF = (iccQuantities.medOffice || 0) * (iccSpaceSF.medOffice || 220);
            const iccLargeOfficeSF = (iccQuantities.largeOffice || 0) * (iccSpaceSF.largeOffice || 320);
            const iccPhoneRoomSF = (iccQuantities.phoneRoom || 0) * (iccSpaceSF.phoneRoom || 20);
            const iccHuddleSF = (iccQuantities.huddleShelter || 0) * (iccSpaceSF.huddleShelter || 50);
            const iccSmallMeetingSF = (iccQuantities.smallMeeting || 0) * (iccSpaceSF.smallMeeting || 150);
            const iccMedMeetingSF = (iccQuantities.mediumMeeting || 0) * (iccSpaceSF.mediumMeeting || 450);
            const iccLargeMeetingSF = (iccQuantities.largeMeeting || 0) * (iccSpaceSF.largeMeeting || 1000);
            const iccCollabSF = (iccQuantities.collaboration || 0) * (iccSpaceSF.collaboration || 320);
            
            // Calculate Hotel SF by category (additional space types)
            const hotelSmallOfficeSF = (hotelQuantities.smallOffice || 0) * (hotelSpaceSF.smallOffice || 150);
            const hotelMedOfficeSF = (hotelQuantities.medOffice || 0) * (hotelSpaceSF.medOffice || 220);
            const hotelLargeOfficeSF = (hotelQuantities.largeOffice || 0) * (hotelSpaceSF.largeOffice || 320);
            const hotelPhoneRoomSF = (hotelQuantities.phoneRoom || 0) * (hotelSpaceSF.phoneRoom || 20);
            const hotelHuddleSF = (hotelQuantities.huddleShelter || 0) * (hotelSpaceSF.huddleShelter || 50);
            const hotelSmallMeetingSF = (hotelQuantities.smallMeeting || 0) * (hotelSpaceSF.smallMeeting || 150);
            const hotelMedMeetingSF = (hotelQuantities.mediumMeeting || 0) * (hotelSpaceSF.mediumMeeting || 450);
            const hotelLargeMeetingSF = (hotelQuantities.largeMeeting || 0) * (hotelSpaceSF.largeMeeting || 1000);
            const hotelCollabSF = (hotelQuantities.collaboration || 0) * (hotelSpaceSF.collaboration || 320);
            
            
        }
        
        // Initialize charts when page loads
        window.addEventListener('load', function() {
            console.log('Page loaded, initializing charts...');
            try {
                createSpaceCharts();
                updateSpaceCharts();
                createAdephiComparisonCharts();
                updateAdephiComparisonCharts();
                console.log('Charts initialized successfully');
            } catch (error) {
                console.error('Error initializing charts:', error);
            }
        });
    </script>
</body>
</html>

